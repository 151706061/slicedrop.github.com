/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function m(a){throw a;}var n=void 0,q=!0,r=null,t=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function u(a){return function(){return this[a]}}var w,ca=this;function ea(){}
function fa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ga(a){return a!==n}function ha(a){return"array"==fa(a)}function ja(a){var b=fa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function la(a){return"string"==typeof a}function y(a){return"number"==typeof a}function ma(a){return"function"==fa(a)}function na(a){var b=typeof a;return"object"==b&&a!=r||"function"==b}function oa(a){return a[pa]||(a[pa]=++qa)}var pa="closure_uid_"+(1E9*Math.random()>>>0),qa=0;
function ra(a,b,c){return a.call.apply(a.bind,arguments)}function sa(a,b,c){a||m(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){ua=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ra:sa;return ua.apply(r,arguments)}
function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var wa=Date.now||function(){return+new Date};function D(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ga(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function F(a,b){function c(){}c.prototype=b.prototype;a.s=b.prototype;a.prototype=new c;a.prototype.constructor=a};function xa(a,b,c){this.Da=this.Ca=this.Ba=0;3==arguments.length?(this.Ba=Number(a),this.Ca=Number(b),this.Da=Number(c)):a instanceof xa?(this.Ba=Number(a.x()),this.Ca=Number(a.y()),this.Da=Number(a.b())):(this.Ba=Number(a[0]),this.Ca=Number(a[1]),this.Da=Number(a[2]))}
xa.prototype={h:function(){return new xa(this.Ba,this.Ca,this.Da)},Cb:function(a){return this.Ba*a.x()+this.Ca*a.y()+this.Da*a.b()},Bd:function(a,b){return ya(this,za(Aa(a,this),b))},length:function(){return Math.sqrt(this.Cb(this))},Yb:function(a){return new xa(this.Ca*a.b()-this.Da*a.y(),this.Da*a.x()-this.Ba*a.b(),this.Ba*a.y()-this.Ca*a.x())},x:u("Ba"),y:u("Ca"),b:u("Da")};function Ba(a){var b=a.length();return new xa(a.Ba/b,a.Ca/b,a.Da/b)}
function za(a,b){return new xa(a.Ba*b,a.Ca*b,a.Da*b)}function Aa(a,b){return new xa(a.Ba-b.x(),a.Ca-b.y(),a.Da-b.b())}function ya(a,b){return new xa(a.Ba+b.x(),a.Ca+b.y(),a.Da+b.b())}function Ca(a){return new xa(-a.Ba,-a.Ca,-a.Da)};var H=H||{};H.Qi=q;H.Ea=function(a){eval("X.DEV === undefined")||window.console.time(a)};H.qa=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.yg=0;this.Mi=function(){return this.yg++}};function Ea(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}var Fa=window.pg;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&m(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ga=0,Ha=["ms","moz","webkit","o"],Ia=0;Ia<Ha.length&&!window.requestAnimationFrame;++Ia)window.requestAnimationFrame=window[Ha[Ia]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ha[Ia]+"CancelAnimationFrame"]||window[Ha[Ia]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ga)),d=window.setTimeout(function(){a(b+c)},c);Ga=b+c;return d});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===n&&m(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});D("$",Fa);D("Function.prototype.bind",Function.prototype.bind);
D("window.requestAnimationFrame",window.requestAnimationFrame);D("window.cancelAnimationFrame",window.cancelAnimationFrame);function Ja(a){if(!Ka.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(La,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ma,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Na,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Oa,"&quot;"));return a}var La=/&/g,Ma=/</g,Na=/>/g,Oa=/\"/g,Ka=/[&<>\"]/;var Pa,Qa,Ra,Sa,Ta,Va,Wa;function Xa(){return ca.navigator?ca.navigator.userAgent:r}function Ya(){return ca.navigator}Sa=Ra=Qa=Pa=t;var Za;if(Za=Xa()){var $a=Ya();Pa=0==Za.indexOf("Opera");Qa=!Pa&&-1!=Za.indexOf("MSIE");Ra=!Pa&&-1!=Za.indexOf("WebKit");Sa=!Pa&&!Ra&&"Gecko"==$a.product}var ab=Pa,L=Qa,bb=Sa,db=Ra,eb,fb=Ya();eb=fb&&fb.platform||"";Ta=-1!=eb.indexOf("Mac");Va=-1!=eb.indexOf("Win");Wa=-1!=eb.indexOf("Linux");var gb=!!Ya()&&-1!=(Ya().appVersion||"").indexOf("X11");
function hb(){var a=ca.document;return a?a.documentMode:n}var ib;a:{var jb="",kb;if(ab&&ca.opera)var lb=ca.opera.version,jb="function"==typeof lb?lb():lb;else if(bb?kb=/rv\:([^\);]+)(\)|;)/:L?kb=/MSIE\s+([^\);]+)(\)|;)/:db&&(kb=/WebKit\/(\S+)/),kb)var mb=kb.exec(Xa()),jb=mb?mb[1]:"";if(L){var nb=hb();if(nb>parseFloat(jb)){ib=String(nb);break a}}ib=jb}var ob={};
function pb(a){var b;if(!(b=ob[a])){b=0;for(var c=String(ib).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),j=RegExp("(\\d*)(\\D*)","g");do{var k=l.exec(g)||["","",""],p=j.exec(h)||["","",""];if(0==k[0].length&&0==p[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==p[1].length?0:parseInt(p[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==p[1].length?0:parseInt(p[1],10))?1:0)||((0==k[2].length)<(0==p[2].length)?-1:(0==k[2].length)>(0==p[2].length)?1:0)||(k[2]<p[2]?-1:k[2]>p[2]?1:0)}while(0==b)}b=ob[a]=0<=b}return b}var qb=ca.document,rb=!qb||!L?n:hb()||("CSS1Compat"==qb.compatMode?parseInt(ib,10):5);function sb(){0!=tb&&(this.Hj=Error().stack,oa(this))}var tb=0;function ub(a,b){this.type=a;this.currentTarget=this.target=b}w=ub.prototype;w.ac=t;w.defaultPrevented=t;w.Gd=q;w.stopPropagation=function(){this.ac=q};w.preventDefault=function(){this.defaultPrevented=q;this.Gd=t};var vb=0;function wb(){}w=wb.prototype;w.key=0;w.bc=t;w.od=t;w.ea=function(a,b,c,d,e,f){ma(a)?this.Pf=q:a&&a.handleEvent&&ma(a.handleEvent)?this.Pf=t:m(Error("Invalid listener argument"));this.Db=a;this.hg=b;this.src=c;this.type=d;this.capture=!!e;this.ye=f;this.od=t;this.key=++vb;this.bc=t};w.handleEvent=function(a){return this.Pf?this.Db.call(this.ye||this.src,a):this.Db.handleEvent.call(this.Db,a)};function xb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}var yb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<yb.length;f++)c=yb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Ab=!L||L&&9<=rb,Bb=L&&!pb("9");!db||pb("528");bb&&pb("1.9b")||L&&pb("8")||ab&&pb("9.5")||db&&pb("528");bb&&!pb("8")||L&&pb("9");var Cb=Array.prototype,Db=Cb.indexOf?function(a,b,c){return Cb.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(la(a))return!la(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Eb=Cb.forEach?function(a,b,c){Cb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Fb=Cb.map?function(a,b,c){return Cb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
la(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Gb=Cb.some?function(a,b,c){return Cb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return q;return t};function Hb(a,b){var c=Db(a,b);0<=c&&Cb.splice.call(a,c,1)}function Ib(a,b,c){return 2>=arguments.length?Cb.slice.call(a,b):Cb.slice.call(a,b,c)};function Jb(a){Jb[" "](a);return a}Jb[" "]=ea;function Kb(a,b){a&&this.ea(a,b)}F(Kb,ub);w=Kb.prototype;w.target=r;w.relatedTarget=r;w.offsetX=0;w.offsetY=0;w.clientX=0;w.clientY=0;w.screenX=0;w.screenY=0;w.button=0;w.keyCode=0;w.charCode=0;w.ctrlKey=t;w.altKey=t;w.shiftKey=t;w.metaKey=t;w.hi=t;w.Ma=r;
w.ea=function(a,b){var c=this.type=a.type;ub.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(bb){var e;a:{try{Jb(d.nodeName);e=q;break a}catch(f){}e=t}e||(d=r)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=db||a.offsetX!==n?a.offsetX:a.layerX;this.offsetY=db||a.offsetY!==n?a.offsetY:a.layerY;this.clientX=a.clientX!==n?a.clientX:a.pageX;this.clientY=a.clientY!==n?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.hi=Ta?a.metaKey:a.ctrlKey;this.state=a.state;this.Ma=a;a.defaultPrevented&&this.preventDefault();delete this.ac};w.stopPropagation=function(){Kb.s.stopPropagation.call(this);this.Ma.stopPropagation?this.Ma.stopPropagation():this.Ma.cancelBubble=q};
w.preventDefault=function(){Kb.s.preventDefault.call(this);var a=this.Ma;if(a.preventDefault)a.preventDefault();else if(a.returnValue=t,Bb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};w.dh=u("Ma");var Lb={},Nb={},Ob={},Pb={};function O(a,b,c,d,e){if(ha(b)){for(var f=0;f<b.length;f++)O(a,b[f],c,d,e);return r}a=Qb(a,b,c,t,d,e);b=a.key;Lb[b]=a;return b}
function Qb(a,b,c,d,e,f){b||m(Error("Invalid event type"));e=!!e;var g=Nb;b in g||(g[b]={V:0,pa:0});g=g[b];e in g||(g[e]={V:0,pa:0},g.V++);var g=g[e],h=oa(a),l;g.pa++;if(g[h]){l=g[h];for(var j=0;j<l.length;j++)if(g=l[j],g.Db==c&&g.ye==f){if(g.bc)break;d||(l[j].od=t);return l[j]}}else l=g[h]=[],g.V++;var k=Rb,p=Ab?function(a){return k.call(p.src,p.Db,a)}:function(a){a=k.call(p.src,p.Db,a);if(!a)return a},j=p,g=new wb;g.ea(c,j,a,b,e,f);g.od=d;j.src=a;j.Db=g;l.push(g);Ob[h]||(Ob[h]=[]);Ob[h].push(g);
a.addEventListener?(a==ca||!a.Bf)&&a.addEventListener(b,j,e):a.attachEvent(b in Pb?Pb[b]:Pb[b]="on"+b,j);return g}function Sb(a,b,c,d,e){if(ha(b))for(var f=0;f<b.length;f++)Sb(a,b[f],c,d,e);else a=Qb(a,b,c,q,d,e),Lb[a.key]=a}function Vb(a,b,c,d,e){if(ha(b))for(var f=0;f<b.length;f++)Vb(a,b[f],c,d,e);else{d=!!d;a:{f=Nb;if(b in f&&(f=f[b],d in f&&(f=f[d],a=oa(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].Db==c&&a[f].capture==d&&a[f].ye==e){Wb(a[f].key);break}}}
function Wb(a){var b=Lb[a];if(!b||b.bc)return t;var c=b.src,d=b.type,e=b.hg,f=b.capture;c.removeEventListener?(c==ca||!c.Bf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Pb?Pb[d]:Pb[d]="on"+d,e);c=oa(c);Ob[c]&&(e=Ob[c],Hb(e,b),0==e.length&&delete Ob[c]);b.bc=q;if(b=Nb[d][f][c])b.Xf=q,Xb(d,f,c,b);delete Lb[a];return q}
function Xb(a,b,c,d){if(!d.Dd&&d.Xf){for(var e=0,f=0;e<d.length;e++)d[e].bc?d[e].hg.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Xf=t;0==f&&(delete Nb[a][b][c],Nb[a][b].V--,0==Nb[a][b].V&&(delete Nb[a][b],Nb[a].V--),0==Nb[a].V&&delete Nb[a])}}function Yb(a,b,c,d,e){var f=1;b=oa(b);if(a[b]){var g=--a.pa,h=a[b];h.Dd?h.Dd++:h.Dd=1;try{for(var l=h.length,j=0;j<l;j++){var k=h[j];k&&!k.bc&&(f&=Zb(k,e)!==t)}}finally{a.pa=Math.max(g,a.pa),h.Dd--,Xb(c,d,b,h)}}return Boolean(f)}
function Zb(a,b){a.od&&Wb(a.key);return a.handleEvent(b)}
function Rb(a,b){if(a.bc)return q;var c=a.type,d=Nb;if(!(c in d))return q;var d=d[c],e,f;if(!Ab){var g;if(!(g=b))a:{g=["window","event"];for(var h=ca;e=g.shift();)if(h[e]!=r)h=h[e];else{g=r;break a}g=h}e=g;g=q in d;h=t in d;if(g){if(0>e.keyCode||e.returnValue!=n)return q;a:{var l=t;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(j){l=q}if(l||e.returnValue==n)e.returnValue=q}}l=new Kb;l.ea(e,this);e=q;try{if(g){for(var k=[],p=l.currentTarget;p;p=p.parentNode)k.push(p);f=d[q];f.pa=f.V;for(var s=k.length-
1;!l.ac&&0<=s&&f.pa;s--)l.currentTarget=k[s],e&=Yb(f,k[s],c,q,l);if(h){f=d[t];f.pa=f.V;for(s=0;!l.ac&&s<k.length&&f.pa;s++)l.currentTarget=k[s],e&=Yb(f,k[s],c,t,l)}}else e=Zb(a,l)}finally{k&&(k.length=0)}return e}c=new Kb(b,this);return e=Zb(a,c)}var $b=0;function ac(a){return a+"_"+$b++};function bc(){sb.call(this)}F(bc,sb);w=bc.prototype;w.Bf=q;w.Le=r;w.Pe=ba("Le");w.addEventListener=function(a,b,c,d){O(this,a,b,c,d)};w.removeEventListener=function(a,b,c,d){Vb(this,a,b,c,d)};
w.dispatchEvent=function(a){var b=a.type||a,c=Nb;if(b in c){if(la(a))a=new ub(a,this);else if(a instanceof ub)a.target=a.target||this;else{var d=a;a=new ub(b,this);zb(a,d)}var d=1,e,c=c[b],b=q in c,f;if(b){e=[];for(f=this;f;f=f.Le)e.push(f);f=c[q];f.pa=f.V;for(var g=e.length-1;!a.ac&&0<=g&&f.pa;g--)a.currentTarget=e[g],d&=Yb(f,e[g],a.type,q,a)&&a.Gd!=t}if(t in c)if(f=c[t],f.pa=f.V,b)for(g=0;!a.ac&&g<e.length&&f.pa;g++)a.currentTarget=e[g],d&=Yb(f,e[g],a.type,t,a)&&a.Gd!=t;else for(e=this;!a.ac&&e&&
f.pa;e=e.Le)a.currentTarget=e,d&=Yb(f,e,a.type,t,a)&&a.Gd!=t;a=Boolean(d)}else a=q;return a};function Q(){sb.call(this);this.c="base";this.sa=window["X.counter"].Mi();this.f=t}F(Q,bc);Q.prototype.__defineGetter__("classname",u("c"));Q.prototype.__defineGetter__("id",u("sa"));D("X.base",Q);function cc(a,b){this.Aa=new xa(a);this.ba=new xa(b)}cc.prototype={h:function(){return new cc(this.Aa.h(),this.ba.h())},$b:function(){this.ba=Ca(this.ba)}};function dc(a,b){this.ba=a;this.Uc=b}dc.prototype={h:function(){return new dc(this.ba.h(),this.Uc)},$b:function(){this.ba=Ca(this.ba);this.Uc=-this.Uc}};function ec(a,b){this.hb=a;this.Nd=b;var c=a[0].Aa,d=a[2].Aa,d=Ba(Aa(a[1].Aa,c).Yb(Aa(d,c)));this.za=new dc(d,d.Cb(c))}ec.prototype={h:function(){var a=this.hb.map(function(a){return a.h()});return new ec(a,this.Nd)},$b:function(){this.hb.reverse().map(function(a){a.$b()});this.za.$b()}};
function fc(a,b,c,d,e,f){for(var g=0,h=[],l=0;l<a.hb.length;l++){var j=b.ba.Cb(a.hb[l].Aa)-b.Uc,j=-1E-5>j?2:1E-5<j?1:0,g=g|j;h.push(j)}switch(g){case 0:(0<b.ba.Cb(a.za.ba)?c:d).push(a);break;case 1:e.push(a);break;case 2:f.push(a);break;case 3:c=[];d=[];for(l=0;l<a.hb.length;l++){var k=(l+1)%a.hb.length,j=h[l],p=h[k],g=a.hb[l],k=a.hb[k];2!=j&&c.push(g);1!=j&&d.push(2!=j?g.h():g);3==(j|p)&&(j=(b.Uc-b.ba.Cb(g.Aa))/b.ba.Cb(Aa(k.Aa,g.Aa)),j=new cc(g.Aa.Bd(k.Aa,j),g.ba.Bd(k.ba,j)),c.push(j),d.push(j.h()))}3<=
c.length&&e.push(new ec(c,a.Nd));3<=d.length&&f.push(new ec(d,a.Nd))}};function gc(a){this.ca=this.da=this.za=r;this.A=[];a&&hc(this,a)}gc.prototype={h:function(){var a=new gc,b=this.za&&this.za.h();a.za=b;b=this.da&&this.da.h();a.da=b;b=this.ca&&this.ca.h();a.ca=b;a.Ld(this.A.map(function(a){return a.h()}));return a},D:function(){for(var a=0;a<this.A.length;a++)this.A[a].$b();this.za.$b();this.da&&this.da.D();this.ca&&this.ca.D();a=this.da;this.da=this.ca;this.ca=a},Ld:ba("A")};
function hc(a,b){if(b.length){a.za||(a.za=b[0].za.h());for(var c=[],d=[],e=0;e<b.length;e++)fc(b[e],a.za,a.A,a.A,c,d);c.length&&(a.da||(a.da=new gc),hc(a.da,c));d.length&&(a.ca||(a.ca=new gc),hc(a.ca,d))}}function ic(a){var b=a.A.slice();a.da&&(b=b.concat(ic(a.da)));a.ca&&(b=b.concat(ic(a.ca)));return b}function jc(a,b){a.A=kc(b,a.A);a.da&&jc(a.da,b);a.ca&&jc(a.ca,b)}
function kc(a,b){if(!a.za)return b.slice();for(var c=[],d=[],e=0;e<b.length;e++)fc(b[e],a.za,c,d,c,d);a.da&&(c=kc(a.da,c));d=a.ca?kc(a.ca,d):[];return c.concat(d)};function lc(){this.A=[]}function mc(a){var b=new lc;b.Ld(a);return b}
lc.prototype={h:function(){var a=new lc;a.Ld(this.A.map(function(a){return a.h()}));return a},We:function(a){var b=new gc(this.h().A);a=new gc(a.h().A);jc(b,a);jc(a,b);a.D();jc(a,b);a.D();hc(b,ic(a));return mc(ic(b))},la:function(a){var b=new gc(this.h().A);a=new gc(a.h().A);b.D();jc(b,a);jc(a,b);a.D();jc(a,b);a.D();hc(b,ic(a));b.D();return mc(ic(b))},Ae:function(a){var b=new gc(this.h().A);a=new gc(a.h().A);b.D();jc(a,b);a.D();jc(b,a);jc(a,b);hc(b,ic(a));b.D();return mc(ic(b))},inverse:function(){var a=
this.h();a.A.map(function(a){a.$b()});return a},Ld:ba("A")};function nc(){Q.call(this);this.c="indexer";this.ke=[];this.Dj=[];this.pb={}}F(nc,Q);nc.prototype.add=function(a){a==r&&m(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.pb||(this.pb[b]=this.ke.length,this.ke.push(a));return this.pb[b]};nc.prototype.unique=u("ke");function oc(a){Q.call(this);this.c="file";this.dd=a;this.f=q}F(oc,Q);function pc(){this.Ib=this.o=r}pc.prototype.__defineSetter__("file",function(a){this.o=a==r||ha(a)&&0==a.length?r:ha(a)?1==a.length?new oc(a[0]):Fb(a,function(a){var c=new R;c.o=new oc(a);return c}):new oc(a)});pc.prototype.__defineGetter__("file",function(){return!this.o?"":ha(this.o)?this.o.map(function(a){return a.o.dd}):this.o.dd});pc.prototype.__defineGetter__("filedata",u("Ib"));
pc.prototype.__defineSetter__("filedata",function(a){if(a==r||ha(a)&&0==a.length)this.Ib=r;if(ha(a))if(1==a.length)this.Ib=a[0];else{var b=this.o.length,c;for(c=0;c<b;c++)this.o[c].Ib=a[c]}else this.Ib=a});function qc(a){if("function"==typeof a.bb)return a.bb();if(la(a))return a.split("");if(ja(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return xb(a)};function rc(a,b){this.J={};this.w=[];var c=arguments.length;if(1<c){c%2&&m(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.me(a)}w=rc.prototype;w.V=0;w.Ye=0;w.ud=u("V");w.bb=function(){sc(this);for(var a=[],b=0;b<this.w.length;b++)a.push(this.J[this.w[b]]);return a};function tc(a){for(var b=0;b<a.w.length;b++){var c=a.w[b];if(uc(a.J,c)&&a.J[c]==t)return q}return t}w.clear=function(){this.J={};this.Ye=this.V=this.w.length=0};
w.remove=function(a){return uc(this.J,a)?(delete this.J[a],this.V--,this.Ye++,this.w.length>2*this.V&&sc(this),q):t};function sc(a){if(a.V!=a.w.length){for(var b=0,c=0;b<a.w.length;){var d=a.w[b];uc(a.J,d)&&(a.w[c++]=d);b++}a.w.length=c}if(a.V!=a.w.length){for(var e={},c=b=0;b<a.w.length;)d=a.w[b],uc(e,d)||(a.w[c++]=d,e[d]=1),b++;a.w.length=c}}w.get=function(a,b){return uc(this.J,a)?this.J[a]:b};w.set=function(a,b){uc(this.J,a)||(this.V++,this.w.push(a),this.Ye++);this.J[a]=b};
w.me=function(a){var b;if(a instanceof rc)sc(a),b=a.w.concat(),a=a.bb();else{b=[];var c=0,d;for(d in a)b[c++]=d;a=xb(a)}for(c=0;c<b.length;c++)this.set(b[c],a[c])};w.h=function(){return new rc(this)};w.kg=function(){for(var a=new rc,b=0;b<this.w.length;b++){var c=this.w[b];a.set(this.J[c],c)}return a};function uc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function vc(){Q.call(this);this.c="colortable";this.pb=new rc;Ea(this,new pc)}F(vc,Q);vc.prototype.add=function(a,b,c,d,e,f){(!y(a)||!y(c)||!y(d)||!y(e)||!y(f))&&m(Error("Invalid color table entry."));this.pb.set(a,[b,c,d,e,f]);this.f=q};function wc(a,b,c){this.x=ga(a)?a:0;this.y=ga(b)?b:0;this.b=ga(c)?c:0}wc.prototype.h=function(){return new wc(this.x,this.y,this.b)};function S(a,b,c){this.x=a;this.y=b;this.b=c}F(S,wc);w=S.prototype;w.h=function(){return new S(this.x,this.y,this.b)};w.eb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};w.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};w.D=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};w.normalize=function(){return this.scale(1/this.eb())};w.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
w.la=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};function xc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return c*c+d*d+e*e}function yc(a,b){return new S(a.x+b.x,a.y+b.y,a.b+b.b)}function zc(a,b){return new S(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};H.g=S;w=H.g.prototype;w.h=S.prototype.h;w.eb=S.prototype.eb;w.scale=S.prototype.scale;w.D=S.prototype.D;w.normalize=function(){var a=this.eb();return 0==a?0:this.scale(1/a)};w.add=S.prototype.add;w.la=S.prototype.la;H.g.Cb=function(a,b){return a.x*b.x+a.y*b.y+a.b*b.b};H.g.Yb=zc;H.g.Ab=function(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)};H.g.Bd=function(a,b,c){return new S(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.b+c*(b.b-a.b))};D("X.vector",H.g);D("X.vector.prototype.clone",H.g.prototype.h);
D("X.vector.prototype.magnitude",H.g.prototype.eb);D("X.vector.prototype.scale",H.g.prototype.scale);D("X.vector.prototype.invert",H.g.prototype.D);D("X.vector.prototype.normalize",H.g.prototype.normalize);D("X.vector.prototype.add",H.g.prototype.add);D("X.vector.prototype.subtract",H.g.prototype.la);D("X.vector.dot",H.g.Cb);D("X.vector.cross",H.g.Yb);D("X.vector.distance",H.g.Ab);D("X.vector.lerp",H.g.Bd);function Ac(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Ac.prototype.BYTES_PER_ELEMENT=8;Ac.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Ac.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Ac.BYTES_PER_ELEMENT=8}catch(Bc){}Ac.prototype.BYTES_PER_ELEMENT=Ac.prototype.BYTES_PER_ELEMENT;Ac.prototype.set=Ac.prototype.set;Ac.prototype.toString=Ac.prototype.toString;D("Float64Array",Ac)};function Cc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Cc.prototype.BYTES_PER_ELEMENT=4;Cc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Cc.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Cc.BYTES_PER_ELEMENT=4,Cc.prototype.BYTES_PER_ELEMENT=Cc.prototype.BYTES_PER_ELEMENT,Cc.prototype.set=Cc.prototype.set,Cc.prototype.toString=Cc.prototype.toString,D("Float32Array",Cc));function Dc(a,b,c,d,e,f,g,h,l,j,k,p,s,v,z,A,C){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=l;a[8]=j;a[9]=k;a[10]=p;a[11]=s;a[12]=v;a[13]=z;a[14]=A;a[15]=C;return a}function Ec(a,b,c,d,e){a[b]=c;a[b+4]=d;a[b+8]=e;a[b+12]=0}function Fc(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],f=a[2]*b+a[6]*c+a[10]*d+a[14],g=a[3]*b+a[7]*c+a[11]*d+a[15];a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=e;a[14]=f;a[15]=g;return a}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);
new Float64Array(16);H.d={};H.d.Tf=function(a,b,c,d){c=c.la(b);c.normalize();d=H.g.Yb(c,d);d.normalize();var e=H.g.Yb(d,c);e.normalize();c.D();Ec(a,0,d.x,d.y,d.b);Ec(a,1,e.x,e.y,e.b);Ec(a,2,c.x,c.y,c.b);Fc(a,-b.x,-b.y,-b.b);return a};H.d.Na=function(a,b,c,d){var e=1/(b*a[3]+c*a[7]+d*a[11]+a[15]);return new H.g((b*a[0]+c*a[4]+d*a[8]+a[12])*e,(b*a[1]+c*a[5]+d*a[9]+a[13])*e,(b*a[2]+c*a[6]+d*a[10]+a[14])*e)};H.d.Oc=function(){var a=new Float32Array(16);a[0]=a[5]=a[10]=a[15]=1;return a};
H.d.h=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
H.d.kg=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=d;b[9]=f;b[11]=a[14];b[12]=e;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
H.d.Sg=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],l=a[7],j=a[8],k=a[9],p=a[10],s=a[11],v=a[12],z=a[13],A=a[14];a=a[15];return(b*g-c*f)*(p*a-s*A)-(b*h-d*f)*(k*a-s*z)+(b*l-e*f)*(k*A-p*z)+(c*h-d*g)*(j*a-s*v)-(c*l-e*g)*(j*A-p*v)+(d*l-e*h)*(j*z-k*v)};
H.d.D=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],l=a[6],j=a[7],k=a[8],p=a[9],s=a[10],v=a[11],z=a[12],A=a[13],C=a[14],E=a[15],x=c*h-d*g,B=c*l-e*g,G=c*j-f*g,I=d*l-e*h,N=d*j-f*h,J=e*j-f*l,K=k*A-p*z,P=k*C-s*z,V=k*E-v*z,T=p*C-s*A,ia=p*E-v*A,ka=s*E-v*C,M=x*ka-B*ia+G*T+I*V-N*P+J*K;if(0==M)return t;M=1/M;b[0]=(h*ka-l*ia+j*T)*M;b[1]=(-d*ka+e*ia-f*T)*M;b[2]=(A*J-C*N+E*I)*M;b[3]=(-p*J+s*N-v*I)*M;b[4]=(-g*ka+l*V-j*P)*M;b[5]=(c*ka-e*V+f*P)*M;b[6]=(-z*J+C*G-E*B)*M;b[7]=(k*J-s*G+v*B)*M;b[8]=(g*
ia-h*V+j*K)*M;b[9]=(-c*ia+d*V-f*K)*M;b[10]=(z*N-A*G+E*x)*M;b[11]=(-k*N+p*G-v*x)*M;b[12]=(-g*T+h*P-l*K)*M;b[13]=(c*T-d*P+e*K)*M;b[14]=(-z*I+A*B-C*x)*M;b[15]=(k*I-p*B+s*x)*M;return q};H.d.Ce=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return Dc(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0)};H.d.yh=function(a,b,c,d,e,f,g){return Dc(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};
H.d.zh=function(a,b,c,d,e,f,g){return Dc(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)};
H.d.multiply=function(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],l=a[5],j=a[6],k=a[7],p=a[8],s=a[9],v=a[10],z=a[11],A=a[12],C=a[13],E=a[14];a=a[15];var x=b[0],B=b[1],G=b[2],I=b[3],N=b[4],J=b[5],K=b[6],P=b[7],V=b[8],T=b[9],ia=b[10],ka=b[11],M=b[12],Tb=b[13],Ub=b[14];b=b[15];c[0]=d*x+h*B+p*G+A*I;c[1]=e*x+l*B+s*G+C*I;c[2]=f*x+j*B+v*G+E*I;c[3]=g*x+k*B+z*G+a*I;c[4]=d*N+h*J+p*K+A*P;c[5]=e*N+l*J+s*K+C*P;c[6]=f*N+j*J+v*K+E*P;c[7]=g*N+k*J+z*K+a*P;c[8]=d*V+h*T+p*ia+A*ka;c[9]=e*V+l*T+s*ia+C*ka;c[10]=f*V+
j*T+v*ia+E*ka;c[11]=g*V+k*T+z*ia+a*ka;c[12]=d*M+h*Tb+p*Ub+A*b;c[13]=e*M+l*Tb+s*Ub+C*b;c[14]=f*M+j*Tb+v*Ub+E*b;c[15]=g*M+k*Tb+z*Ub+a*b;return c};H.d.translate=Fc;H.d.scale=function(a,b,c,d){return Dc(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])};
H.d.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],l=a[3],j=a[4],k=a[5],p=a[6],s=a[7],v=a[8],z=a[9],A=a[10],C=a[11],E=Math.cos(b),x=Math.sin(b),B=1-E;b=c*c*B+E;var G=c*d*B+e*x,I=c*e*B-d*x,N=c*d*B-e*x,J=d*d*B+E,K=d*e*B+c*x,P=c*e*B+d*x;c=d*e*B-c*x;e=e*e*B+E;return Dc(a,f*b+j*G+v*I,g*b+k*G+z*I,h*b+p*G+A*I,l*b+s*G+C*I,f*N+j*J+v*K,g*N+k*J+z*K,h*N+p*J+A*K,l*N+s*J+C*K,f*P+j*c+v*e,g*P+k*c+z*e,h*P+p*c+A*e,l*P+s*c+C*e,a[12],a[13],a[14],a[15])};
H.d.Hd=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],l=a[10],j=a[11],k=Math.cos(b),p=Math.sin(b);a[4]=c*k+g*p;a[5]=d*k+h*p;a[6]=e*k+l*p;a[7]=f*k+j*p;a[8]=c*-p+g*k;a[9]=d*-p+h*k;a[10]=e*-p+l*k;a[11]=f*-p+j*k;return a};H.d.Id=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],l=a[10],j=a[11],k=Math.cos(b),p=Math.sin(b);a[0]=c*k+g*-p;a[1]=d*k+h*-p;a[2]=e*k+l*-p;a[3]=f*k+j*-p;a[8]=c*p+g*k;a[9]=d*p+h*k;a[10]=e*p+l*k;a[11]=f*p+j*k;return a};
H.d.Jd=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],l=a[6],j=a[7],k=Math.cos(b),p=Math.sin(b);a[0]=c*k+g*p;a[1]=d*k+h*p;a[2]=e*k+l*p;a[3]=f*k+j*p;a[4]=c*-p+g*k;a[5]=d*-p+h*k;a[6]=e*-p+l*k;a[7]=f*-p+j*k;return a};D("X.matrix.identity",H.d.Oc);D("X.matrix.clone",H.d.h);D("X.matrix.transpose",H.d.kg);D("X.matrix.determinant",H.d.Sg);D("X.matrix.invert",H.d.D);D("X.matrix.multiply",H.d.multiply);D("X.matrix.multiplyByVector",H.d.Na);D("X.matrix.makePerspective",H.d.Ce);
D("X.matrix.makeFrustum",H.d.yh);D("X.matrix.makeOrtho",H.d.zh);D("X.matrix.makeLookAt",H.d.Tf);D("X.matrix.translate",H.d.translate);D("X.matrix.scale",H.d.scale);D("X.matrix.rotate",H.d.rotate);D("X.matrix.rotateX",H.d.Hd);D("X.matrix.rotateY",H.d.Id);D("X.matrix.rotateZ",H.d.Jd);function Gc(){Q.call(this);this.c="transform";this.ia=H.d.Oc()}F(Gc,Q);Gc.prototype.__defineGetter__("matrix",u("ia"));Gc.prototype.__defineSetter__("matrix",function(a){(a==r||!(a instanceof Float32Array))&&m(Error("Invalid matrix."));this.ia=a;this.n()});w=Gc.prototype;w.Hd=function(a){(!y(a)||-360>a||360<a)&&m(Error("Invalid angle."));H.d.Hd(this.ia,a*Math.PI/180);this.n()};w.Id=function(a){(!y(a)||-360>a||360<a)&&m(Error("Invalid angle."));H.d.Id(this.ia,a*Math.PI/180);this.n()};
w.Jd=function(a){(!y(a)||-360>a||360<a)&&m(Error("Invalid angle."));H.d.Jd(this.ia,a*Math.PI/180);this.n()};w.Ji=function(a){y(a)||m(Error("Invalid distance."));H.d.translate(this.ia,a,0,0);this.n()};w.Ki=function(a){y(a)||m(Error("Invalid distance."));H.d.translate(this.ia,0,a,0);this.n()};w.Li=function(a){y(a)||m(Error("Invalid distance."));H.d.translate(this.ia,0,0,a);this.n()};function Hc(a,b,c){a.ia[b+4*c]*=-1;a.n()}w.Zg=function(){Hc(this,0,0)};w.$g=function(){Hc(this,1,1)};
w.ah=function(){Hc(this,2,2)};w.n=function(){this.f=q};D("X.transform",Gc);D("X.transform.prototype.rotateX",Gc.prototype.Hd);D("X.transform.prototype.rotateY",Gc.prototype.Id);D("X.transform.prototype.rotateZ",Gc.prototype.Jd);D("X.transform.prototype.translateX",Gc.prototype.Ji);D("X.transform.prototype.translateY",Gc.prototype.Ki);D("X.transform.prototype.translateZ",Gc.prototype.Li);D("X.transform.prototype.flipX",Gc.prototype.Zg);D("X.transform.prototype.flipY",Gc.prototype.$g);
D("X.transform.prototype.flipZ",Gc.prototype.ah);D("X.transform.prototype.modified",Gc.prototype.n);function Ic(){Q.call(this);this.c="texture";this.va=this.jb=this.o=r;this.wb=this.xb=0;Ea(this,new pc)}F(Ic,Q);D("X.texture",Ic);function U(a,b){Q.call(this);this.c="triplets";this.Ob=Infinity;this.Lb=-Infinity;this.Pb=Infinity;this.Mb=-Infinity;this.Qb=Infinity;this.Nb=-Infinity;this.Vc=[0,0,0];this.ef=q;this.B=0;this.L=new Float32Array(a);b!=r&&(this.L=b.L.subarray(0,b.L.length),this.B=this.L.length,this.Ob=b.Ob,this.Lb=b.Lb,this.Pb=b.Pb,this.Mb=b.Mb,this.Qb=b.Qb,this.Nb=b.Nb,this.Vc=b.Vc.slice(),this.ef=t)}F(U,Q);w=U.prototype;
w.add=function(a,b,c){this.Ob=Math.min(this.Ob,a);this.Lb=Math.max(this.Lb,a);this.Pb=Math.min(this.Pb,b);this.Mb=Math.max(this.Mb,b);this.Qb=Math.min(this.Qb,c);this.Nb=Math.max(this.Nb,c);this.Vc=[(this.Ob+this.Lb)/2,(this.Pb+this.Mb)/2,(this.Qb+this.Nb)/2];this.ef=t;this.f=q;this.L[this.B++]=a;this.L[this.B++]=b;this.L[this.B++]=c;return this.B/3};w.fb=function(){if(this.B!=this.L.length){var a=new Float32Array(this.B);a.set(this.L.subarray(0,this.B));this.L=a}};
w.get=function(a){a*=3;return[this.L[a],this.L[a+1],this.L[a+2]]};w.remove=function(){m(Error("Not implemented."))};w.clear=function(){this.L=new Float32Array(this.L.length);this.f=q};U.prototype.__defineGetter__("count",function(){this.fb();return this.L.length/3});U.prototype.__defineGetter__("length",function(){this.fb();return this.L.length});D("X.triplets",U);D("X.triplets.prototype.add",U.prototype.add);D("X.triplets.prototype.resize",U.prototype.fb);D("X.triplets.prototype.get",U.prototype.get);
D("X.triplets.prototype.remove",U.prototype.remove);D("X.triplets.prototype.clear",U.prototype.clear);function Jc(){this.ja=Kc;this.Wb=new Gc;this.Gb=[1,1,1];this.Vb=this.z=this.W=this.j=this.i=r;this.kc=[];this.Ja=q;this.jc=this.Ec=1;this.fc=r;this.xc=t;this.Z=1;this.K=0}var Kc="TRIANGLES";Jc.prototype.__defineSetter__("type",function(a){return this.ja=a});Jc.prototype.__defineGetter__("type",u("ja"));Jc.prototype.__defineGetter__("texture",function(){this.z||(this.z=new Ic);return this.z});Jc.prototype.__defineGetter__("transform",u("Wb"));Jc.prototype.__defineGetter__("points",u("i"));
Jc.prototype.__defineSetter__("points",ba("i"));Jc.prototype.__defineGetter__("normals",u("j"));Jc.prototype.__defineSetter__("normals",ba("j"));Jc.prototype.__defineGetter__("colors",u("W"));Jc.prototype.__defineSetter__("colors",ba("W"));Jc.prototype.__defineGetter__("color",u("Gb"));Jc.prototype.__defineSetter__("color",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid color."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Gb=a;this.f=q});
Jc.prototype.__defineGetter__("opacity",u("Z"));Jc.prototype.__defineSetter__("opacity",function(a){(!y(a)||1<a||0>a)&&m(Error("Invalid opacity."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.Z=a;this.f=q});Jc.prototype.__defineGetter__("caption",u("fc"));Jc.prototype.__defineSetter__("caption",function(a){this.fc=a;this.f=q});Jc.prototype.__defineGetter__("visible",u("Ja"));
Jc.prototype.__defineSetter__("visible",function(a){for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.Ja=a;this.f=q});Jc.prototype.__defineGetter__("pointsize",u("Ec"));Jc.prototype.__defineSetter__("pointsize",function(a){y(a)||m(Error("Invalid point size."));this.Ec=a;this.f=q});Jc.prototype.__defineGetter__("magicmode",u("xc"));Jc.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&m(Error("Invalid magic mode setting."));this.xc=a;this.f=q});
Jc.prototype.__defineGetter__("linewidth",u("jc"));Jc.prototype.__defineSetter__("linewidth",function(a){y(a)||m(Error("Invalid line width."));this.jc=a;this.f=q});function Lc(){this.Ia=Infinity;this.P=this.Fa=-Infinity;this.S=Infinity;this.sb=[0,0,0];this.qb=[1,1,1]}Lc.prototype.__defineGetter__("lowerThreshold",u("P"));Lc.prototype.__defineSetter__("lowerThreshold",ba("P"));Lc.prototype.__defineGetter__("upperThreshold",u("S"));Lc.prototype.__defineSetter__("upperThreshold",ba("S"));Lc.prototype.__defineGetter__("min",u("Ia"));Lc.prototype.__defineGetter__("max",u("Fa"));Lc.prototype.__defineGetter__("minColor",u("sb"));
Lc.prototype.__defineSetter__("minColor",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid min. color."));this.sb=a});Lc.prototype.__defineGetter__("maxColor",u("qb"));Lc.prototype.__defineSetter__("maxColor",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid max. color."));this.qb=a});function Mc(){Q.call(this);this.c="scalars";this.sc=this.v=r;this.qf=q;this.Td=0;Ea(this,new pc);Ea(this,new Lc);this.sb=[0,1,0];this.qb=[1,0,0]}F(Mc,Q);Mc.prototype.__defineGetter__("array",u("v"));Mc.prototype.__defineSetter__("array",function(a){this.sc=this.v=a;this.f=q});Mc.prototype.__defineGetter__("interpolation",u("Td"));Mc.prototype.__defineSetter__("interpolation",ba("Td"));D("X.scalars",Mc);function W(a){Q.call(this);this.c="object";this.e=[];this.u=this.$=r;Ea(this,new Jc);a!=r&&this.Xb(a)}F(W,Q);
W.prototype.Xb=function(a){this.ja=a.ja;this.Wb=new Gc;this.Wb.ia=new Float32Array(a.Wb.ia);this.Gb=a.Gb.slice();a.i&&(this.i=new U(a.i.length,a.i));a.j&&(this.j=new U(a.j.length,a.j));a.W&&(this.W=new U(a.W.length,a.W));this.z=a.z;this.Vb=a.Vb;a.o&&(this.o=new oc((new String(a.o.dd)).toString()));this.Z=a.Z;this.e.length=0;var b=a.e;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.e.push(new H[b[d].c](b[d]));this.Ja=a.Ja;this.Ec=a.Ec;this.jc=a.jc;a.fc&&(this.fc=(new String(a.fc)).toString());this.xc=
a.xc;this.kc=a.kc.slice();this.f=q};W.prototype.__defineGetter__("colortable",function(){this.$||(this.$=new vc);return this.$});W.prototype.__defineGetter__("scalars",function(){this.u||(this.u=new Mc);return this.u});W.prototype.__defineGetter__("children",u("e"));W.prototype.n=function(){var a=new Nc;a.Y=this;this.dispatchEvent(a)};
function Oc(a,b){(a==r||b==r||!(a instanceof W)||!(b instanceof W))&&m(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.Z?-1:1==b.Z?1:a.K!=r&&b.K!=r&&a.K>b.K?-1:1}D("X.object",W);D("X.object.prototype.modified",W.prototype.n);function Pc(){}function Qc(a){for(var b=a.i.count,c=[],d=0,d=0;d<b;d+=3){var e=a.i.get(d),f=a.i.get(d+1),g=a.i.get(d+2),h=a.j.get(d),l=a.j.get(d+1),j=a.j.get(d+2),k=a.Gb;a.W&&0<a.W.length&&(k=a.W.get(d));var p=[];p.push(new cc(e,h));p.push(new cc(f,l));p.push(new cc(g,j));c.push(new ec(p,k))}return mc(c)}
function Rc(a,b){(b==r||!(b instanceof lc))&&m(Error("Invalid CSG object."));var c=new nc,d=[];Fb(b.A,function(a){var b=[],g=a.Nd,b=Fb(a.hb,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.xg=Fb(c.unique(),function(a){return[a.Aa.x(),a.Aa.y(),a.Aa.b()]});a.wg=Fb(c.unique(),function(a){return[a.ba.x(),a.ba.y(),a.ba.b()]});a.vg=Fb(c.unique(),function(a){return!a.color?r:[a.color[0],a.color[1],a.color[2]]});a.i=new U(9*d.length);a.j=new U(9*d.length);
a.W=new U(9*d.length);Fb(d,function(a){var b=a[0],c=a[1];a=a[2];var d=this.xg,l=this.wg,j=this.vg;this.i.add(d[b][0],d[b][1],d[b][2]);this.i.add(d[c][0],d[c][1],d[c][2]);this.i.add(d[a][0],d[a][1],d[a][2]);this.j.add(l[b][0],l[b][1],l[b][2]);this.j.add(l[c][0],l[c][1],l[c][2]);this.j.add(l[a][0],l[a][1],l[a][2]);j[b]&&this.W.add(j[b][0],j[b][1],j[b][2]);j[c]&&this.W.add(j[c][0],j[c][1],j[c][2]);j[a]&&this.W.add(j[a][0],j[a][1],j[a][2])}.bind(a));0==a.W.B&&(a.W=r);a.ja=Kc}
Pc.prototype.We=function(a){(a==r||!(a instanceof lc)&&!(a instanceof W))&&m(Error("Invalid object."));var b=a;a instanceof W&&(b=Qc(b));a=new W;Ea(a,new Pc);Rc(a,Qc(this).We(b));return a};Pc.prototype.la=function(a){(a==r||!(a instanceof lc)&&!(a instanceof W))&&m(Error("Invalid object."));var b=a;a instanceof W&&(b=Qc(b));a=new W;Ea(a,new Pc);Rc(a,Qc(this).la(b));return a};
Pc.prototype.Ae=function(a){(a==r||!(a instanceof lc)&&!(a instanceof W))&&m(Error("Invalid object."));var b=a;a instanceof W&&(b=Qc(b));a=new W;Ea(a,new Pc);Rc(a,Qc(this).Ae(b));return a};Pc.prototype.inverse=function(){var a=new W;Ea(a,new Pc);Rc(a,Qc(this).inverse());return a};D("X.constructable",Pc);D("X.constructable.prototype.intersect",Pc.prototype.Ae);D("X.constructable.prototype.inverse",Pc.prototype.inverse);D("X.constructable.prototype.subtract",Pc.prototype.la);
D("X.constructable.prototype.union",Pc.prototype.We);function Sc(a){ub.call(this,a);this.c="event"}F(Sc,ub);var Tc=ac("pan"),Uc=ac("rotate"),Vc=ac("zoom"),Wc=ac("scroll");ac("render");var Xc=ac("resetview"),Yc=ac("windowlevel"),Zc=ac("modified"),$c=ac("progress"),ad=ac("hover"),bd=ac("hover_end");function cd(){Sc.call(this,Yc);this.Zd=this.le=0}F(cd,Sc);function dd(){Sc.call(this,Tc);this.K=new H.g(0,0,0)}F(dd,Sc);function ed(){Sc.call(this,Uc);this.K=new H.g(0,0,0)}F(ed,Sc);function fd(){Sc.call(this,Vc);this.Ha=this.Qa=t}F(fd,Sc);
function gd(){Sc.call(this,Wc);this.I=t}F(gd,Sc);function hd(){Sc.call(this,ad);this.nd=this.md=0}F(hd,Sc);function id(){Sc.call(this,bd)}F(id,Sc);function jd(){Sc.call(this,Xc)}F(jd,Sc);function Nc(){Sc.call(this,Zc);this.q=this.Y=r}F(Nc,Sc);function kd(){Sc.call(this,$c);this.sf=0}F(kd,Sc);function ld(){Q.call(this);this.c="parser";this.X=r;this.B=0;this.Ag=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.$c=q;this.Fj=-Infinity;this.Ej=Infinity}F(ld,Q);ld.prototype.parse=function(){m(Error("The function parse() should be overloaded."))};function md(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function nd(a,b,c){b===n&&(b=0);c===n&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function Y(a,b,c){c!=r||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.X.slice(a.B,a.B+=c*d));if(a.Ag!=a.$c){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function od(a,b,c){H.Ea(a.c+".reslice");var d=b.aa,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],l=b.m!=r,j=h*d,k=Array(g),p=Array(g),s=0,v=r;b.$&&(v=b.$.pb);for(var z=0,A=0,C=0,E=0,x=4*j,z=0;z<g;z++){k[z]=Array(h);p[z]=Array(h);for(var B=f.subarray(z*j,(z+1)*j),G=new Uint8Array(x),A=E=0;A<h;A++){k[z][A]=new c.data.constructor(d);p[z][A]=new c.data.constructor(d);for(C=0;C<d;C++){var s=B[E],I=0,N=0,J=0,K=0;v?(K=v.get(Math.floor(s)),K||(I=v.bb(),K=I[I.length-1]),I=255*K[1],N=255*K[2],J=255*K[3],K=255*K[4]):
(I=N=J=255*(s/e),K=255);var P=4*E;G[P]=I;G[++P]=N;G[++P]=J;G[++P]=K;k[z][A][C]=255*(s/e);p[z][A][C]=s;E++}}s=new Ic;s.va=G;s.xb=d;s.wb=h;B=b.Za.e[z];B.z=s;l&&(B.m=b.m.Za.e[z].z)}b.ee&&(d!=h?l?b.$?(pd(g,d,h,p,b.$,b.R,b.m.R,q),pd(g,h,d,p,b.$,b.Q,b.m.Q,t)):(qd(g,d,h,k,b.R,b.m.R,q),qd(g,h,d,k,b.Q,b.m.Q,t)):b.$?(pd(g,d,h,p,b.$,b.R,r,q),pd(g,h,d,p,b.$,b.Q,r,t)):(qd(g,d,h,k,b.R,r,q),qd(g,h,d,k,b.Q,r,t)):l?b.$?rd(g,d,h,k,b.$,b.Q,b.m.Q,b.R,b.m.R):sd(g,d,h,k,b.Q,b.m.Q,b.R,b.m.R):b.$?rd(g,d,h,p,b.$,b.Q,r,b.R,
r):sd(g,d,h,k,b.Q,r,b.R,r));H.qa(a.c+".reslice");return p}function qd(a,b,c,d,e,f,g){for(var h=4*a*b,l=0,l=0;l<c;l++){for(var j=new Uint8Array(h),k=0,p=0,k=0;k<a;k++)for(var s=0,v=d[k],s=0;s<b;s++){var z,A=z=g?v[l][s]:v[s][l],C=z,E=4*p;j[E]=z;j[++E]=A;j[++E]=C;j[++E]=255;p++}k=new Ic;k.va=j;k.xb=b;k.wb=a;j=e.e[l];j.z=k;f&&(j.m=f.e[l].z)}}
function pd(a,b,c,d,e,f,g,h){e=e.pb;for(var l=4*a*b,j=0,j=0;j<c;j++){for(var k=new Uint8Array(l),p=0,s=0,p=0;p<a;p++)for(var v=d[p],z=0,z=0;z<b;z++){var A=e.get(Math.floor(h?v[j][z]:v[z][j]));A||(A=e.bb(),A=A[A.length-1]);var C=255*A[2],E=255*A[3],x=255*A[4],B=4*s;k[B]=255*A[1];k[++B]=C;k[++B]=E;k[++B]=x;s++}p=new Ic;p.va=k;p.xb=b;p.wb=a;k=f.e[j];k.z=p;g&&(k.m=g.e[j].z)}}
function sd(a,b,c,d,e,f,g,h){for(var l=4*a*b,j=0,j=0;j<c;j++){for(var k=new Uint8Array(l),p=new Uint8Array(l),s=0,v=0,v=0;v<a;v++)for(var z=d[v],A=0,A=0;A<b;A++){var C=z[A][j],E=C,x=C,B=4*s;k[B]=C;k[++B]=E;k[++B]=x;k[++B]=255;x=E=C=B=z[j][A];B=4*s;p[B]=C;p[++B]=E;p[++B]=x;p[++B]=255;s++}s=new Ic;s.va=k;s.xb=b;s.wb=a;k=e.e[j];k.z=s;f&&(k.m=f.e[j].z);k=new Ic;k.va=p;k.xb=b;k.wb=a;p=g.e[j];p.z=k;h&&(p.m=h.e[j].z)}}
function rd(a,b,c,d,e,f,g,h,l){e=e.pb;for(var j=4*a*b,k=0,k=0;k<c;k++){for(var p=new Uint8Array(j),s=new Uint8Array(j),v=0,z=0,z=0;z<a;z++)for(var A=d[z],C=0,C=0;C<b;C++){var E=e.get(Math.floor(A[C][k]));if(!E)var x=e.bb(),E=x[x.length-1];var B=255*E[2],G=255*E[3],I=255*E[4],x=4*v;p[x]=255*E[1];p[++x]=B;p[++x]=G;p[++x]=I;x=e.get(Math.floor(A[k][C]));x||(x=e.bb(),x=x[x.length-1]);E=255*x[1];B=255*x[2];G=255*x[3];I=255*x[4];x=4*v;s[x]=E;s[++x]=B;s[++x]=G;s[++x]=I;v++}v=new Ic;v.va=p;v.xb=b;v.wb=a;p=
f.e[k];p.z=v;g&&(p.m=g.e[k].z);p=new Ic;p.va=s;p.xb=b;p.wb=a;s=h.e[k];s.z=p;l&&(s.m=l.e[k].z)}};function td(){ld.call(this);this.c="parserLBL"}F(td,ld);
td.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");var d=b.kc,e=d.length;0==e&&m(Error("No _pointIndices defined on the X.object."));this.X=c;var f=[],g=Y(this,"uchar",c.byteLength),h=g.length,l=t,j=0;for(c=1;c<h;c++)10==g[c-1]?(j=c,l=q):l&&32==g[c]&&(f.push(parseInt(nd(g,j,c),10)),l=t);g=b.u.v?b.u.v:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)l=d[c],l>e&&m(Error("Could not find scalar for vertex.")),l=g[l],f[h++]=l,f[h++]=l,f[h++]=l;b.u.v=
g;b.u.sc=f;b.u.f=q;H.qa(this.c+".parse");d=new Nc;d.Y=b;d.q=a;this.dispatchEvent(d)};D("X.parserLBL",td);D("X.parserLBL.prototype.parse",td.prototype.parse);function ud(a,b){this.x=ga(a)?a:0;this.y=ga(b)?b:0}w=ud.prototype;w.h=function(){return new ud(this.x,this.y)};function vd(a,b){return new ud(a.x-b.x,a.y-b.y)}w.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};w.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};w.translate=function(a,b){a instanceof ud?(this.x+=a.x,this.y+=a.y):(this.x+=a,y(b)&&(this.y+=b));return this};w.scale=function(a,b){var c=y(b)?b:a;this.x*=a;this.y*=c;return this};function wd(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}w=wd.prototype;w.h=function(){return new wd(this.top,this.right,this.bottom,this.left)};w.contains=function(a){return!this||!a?t:a instanceof wd?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};
w.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};w.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};w.translate=function(a,b){a instanceof ud?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,y(b)&&(this.top+=b,this.bottom+=b));return this};
w.scale=function(a,b){var c=y(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};function xd(a,b){this.width=a;this.height=b}xd.prototype.h=function(){return new xd(this.width,this.height)};xd.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};xd.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};xd.prototype.scale=function(a,b){var c=y(b)?b:a;this.width*=a;this.height*=c;return this};function yd(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}w=yd.prototype;w.h=function(){return new yd(this.left,this.top,this.width,this.height)};w.Of=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,q}return t};
w.contains=function(a){return a instanceof yd?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};w.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
w.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};w.translate=function(a,b){a instanceof ud?(this.left+=a.x,this.top+=a.y):(this.left+=a,y(b)&&(this.top+=b));return this};w.scale=function(a,b){var c=y(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};var zd;function Ad(a,b){var c;c=a.className;c=la(c)&&c.match(/\S+/g)||[];for(var d=Ib(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Db(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};var Bd=!L||L&&9<=rb;!bb&&!L||L&&L&&9<=rb||bb&&pb("1.9.1");L&&pb("9");function Cd(a){return a?new Dd(Ed(a)):zd||(zd=new Dd)}function Fd(a){return la(a)?document.getElementById(a):a}var Gd={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Hd(a,b,c){return Id(document,arguments)}
function Id(a,b){var c=b[0],d=b[1];if(!Bd&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Ja(d.name),'"');if(d.type){c.push(' type="',Ja(d.type),'"');var e={};zb(e,d);delete e.type;d=e}c.push(">");c=c.join("")}var f=a.createElement(c);if(d)if(la(d))f.className=d;else if(ha(d))Ad.apply(r,[f].concat(d));else{var c=function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in Gd?f.setAttribute(Gd[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?
f.setAttribute(b,a):f[b]=a},g;for(g in d)c.call(n,d[g],g)}if(2<b.length){g=function(b){b&&f.appendChild(la(b)?a.createTextNode(b):b)};for(d=2;d<b.length;d++)if(e=b[d],ja(e)&&!(na(e)&&0<e.nodeType)){var c=Eb,h;a:{if((h=e)&&"number"==typeof h.length){if(na(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(ma(h)){h="function"==typeof h.item;break a}}h=t}if(h)if(h=e.length,0<h){for(var l=Array(h),j=0;j<h;j++)l[j]=e[j];e=l}else e=[];c(e,g)}else g(e)}return f}
function Jd(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function Kd(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Ld(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Ed(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function Dd(a){this.N=a||ca.document||document}w=Dd.prototype;w.vd=Cd;
w.l=function(a){return la(a)?this.N.getElementById(a):a};w.pg=Dd.prototype.l;w.lc=function(a,b,c){return Id(this.N,arguments)};w.createElement=function(a){return this.N.createElement(a)};w.createTextNode=function(a){return this.N.createTextNode(String(a))};function Md(a){return"CSS1Compat"==a.N.compatMode}function Nd(a){var b=a.N;a=!db&&"CSS1Compat"==b.compatMode?b.documentElement:b.body;b=b.parentWindow||b.defaultView;return new ud(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}
w.appendChild=function(a,b){a.appendChild(b)};w.contains=Ld;function Od(a,b){var c=Ed(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,r))?c[b]||c.getPropertyValue(b)||"":""}function Pd(a,b){return Od(a,b)||(a.currentStyle?a.currentStyle[b]:r)||a.style&&a.style[b]}function Qd(a){a=a?Ed(a):document;return L&&!(L&&9<=rb)&&!Md(Cd(a))?a.body:a.documentElement}
function Rd(a){var b=a.getBoundingClientRect();L&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function Sd(a){if(L&&!(L&&8<=rb))return a.offsetParent;var b=Ed(a),c=Pd(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Pd(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return r}
function Td(a){for(var b=new wd(0,Infinity,Infinity,0),c=Cd(a),d=c.N.body,e=c.N.documentElement,f=!db&&"CSS1Compat"==c.N.compatMode?c.N.documentElement:c.N.body;a=Sd(a);)if((!L||0!=a.clientWidth)&&(!db||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=Pd(a,"overflow")){var g=Ud(a),h;h=a;if(bb&&!pb("1.9")){var l=parseFloat(Od(h,"borderLeftWidth"));if(Vd(h))var j=h.offsetWidth-h.clientWidth-l-parseFloat(Od(h,"borderRightWidth")),l=l+j;h=new ud(l,parseFloat(Od(h,"borderTopWidth")))}else h=new ud(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(c.N.parentWindow||c.N.defaultView||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new xd(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&
b.bottom>b.top&&b.right>b.left?b:r}
function Ud(a){var b,c=Ed(a),d=Pd(a,"position"),e=bb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new ud(0,0),g=Qd(c);if(a==g)return f;if(a.getBoundingClientRect)b=Rd(a),a=Nd(Cd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(db&&"fixed"==Pd(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(ab||db&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=Sd(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!ab||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function Wd(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Xd(a){if("none"!=Pd(a,"display"))return Yd(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Yd(a);b.display=c;b.position=e;b.visibility=d;return a}function Yd(a){var b=a.offsetWidth,c=a.offsetHeight,d=db&&!b&&!c;return(!ga(b)||d)&&a.getBoundingClientRect?(a=Rd(a),new xd(a.right-a.left,a.bottom-a.top)):new xd(b,c)}function Zd(a,b){a.style.display=b?"":"none"}function Vd(a){return"rtl"==Pd(a,"direction")}
function $d(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}function ae(a,b){var c=a.currentStyle?a.currentStyle[b]:r;return c?$d(a,c):0}var be={thin:2,medium:4,thick:6};function ce(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:r))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:r;return c in be?be[c]:$d(a,c)}
var de=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function ee(a,b){sb.call(this);this.r=a;var c=na(this.r)&&1==this.r.nodeType?this.r:this.r?this.r.body:r;this.wh=!!c&&Vd(c);this.Lj=O(this.r,bb?"DOMMouseScroll":"mousewheel",this,b)}F(ee,bc);
ee.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.Ma;if("mousewheel"==a.type){c=1;if(L||db&&(Va||pb("532.0")))c=40;d=fe(-a.wheelDelta,c);ga(a.wheelDeltaX)?(b=fe(-a.wheelDeltaX,c),c=fe(-a.wheelDeltaY,c)):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ga(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;y(this.Uf)&&(b=Math.min(Math.max(b,-this.Uf),this.Uf));y(this.Vf)&&(c=Math.min(Math.max(c,-this.Vf),this.Vf));this.wh&&(b=-b);b=new ge(d,a,b,c);this.dispatchEvent(b)};
function fe(a,b){return db&&(Ta||Wa)&&0!=a%b?a:a/b}function ge(a,b,c,d){b&&this.ea(b,n);this.type="mousewheel";this.detail=a;this.Ij=c;this.nc=d}F(ge,Kb);L||db&&pb("525");function he(a){(a==r||!(a instanceof Element))&&m(Error("Could not add interactor to the given element."));Q.call(this);this.c="interactor";this.ra=a;this.ae=this.jf=this.hf=this.kf=this.gf=this.lf=r;this.$d=q;this.yb=this.rb=this.Xa=t;this.cd=[0,0];this.Vd=new H.g(0,0,0);this.wc=new H.g(0,0,0);this.Qf=0;this.rf=this.Zc=r;this.F={MOUSEWHEEL_ENABLED:q,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:t,TOUCH_ENABLED:q,TOUCH_BOUNCING_ENABLED:t}}F(he,Q);
he.prototype.__defineGetter__("config",u("F"));he.prototype.__defineGetter__("leftButtonDown",u("Xa"));he.prototype.__defineGetter__("middleButtonDown",u("rb"));he.prototype.__defineGetter__("rightButtonDown",u("yb"));
he.prototype.ea=function(){this.F.MOUSEWHEEL_ENABLED?(this.ae=new ee(this.ra),this.lf=O(this.ae,"mousewheel",this.Qc.bind(this))):(Wb(this.lf),this.ae=r);this.F.MOUSECLICKS_ENABLED?(this.gf=O(this.ra,"mousedown",this.Jh.bind(this)),this.kf=O(this.ra,"mouseup",this.Oh.bind(this))):(Wb(this.gf),Wb(this.kf));this.ra.oncontextmenu=this.F.CONTEXTMENU_ENABLED?r:function(){return t};window.onkeydown=this.F.KEYBOARD_ENABLED?this.$f.bind(this):r;this.F.TOUCH_ENABLED?(this.F.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},t),this.Eg=O(this.ra,"touchstart",this.bi.bind(this)),this.Dg=O(this.ra,"touchmove",this.$h.bind(this)),this.Cg=O(this.ra,"touchend",this.Wh.bind(this))):(Wb(this.Eg),Wb(this.Dg),Wb(this.Cg));Wb(this.hf);Wb(this.jf);this.hf=O(this.ra,"mousemove",this.Lh.bind(this));this.jf=O(this.ra,"mouseout",this.Mh.bind(this))};
he.prototype.Jh=function(a){0==a.button?this.Xa=q:1==a.button?this.rb=q:2==a.button&&(this.yb=q);eval("this.onMouseDown("+this.Xa+","+this.rb+","+this.yb+")");ie(this);a.preventDefault()};he.prototype.Ih=aa();he.prototype.Oh=function(a){0==a.button?this.Xa=t:1==a.button?this.rb=t:2==a.button&&(this.yb=t);eval("this.onMouseUp("+this.Xa+","+this.rb+","+this.yb+")");ie(this);a.preventDefault()};he.prototype.__defineGetter__("mousePosition",u("cd"));w=he.prototype;w.Nh=aa();
w.Mh=function(a){this.$d=t;this.F.KEYBOARD_ENABLED&&(window.onkeydown=r);this.yb=this.rb=this.Xa=t;ie(this);this.Vd=new H.g(0,0,0);a.preventDefault()};w.Kh=aa();w.bi=function(a){a.preventDefault();a.ea(a.Ma.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.wc=new H.g(a.clientX,a.clientY,0);this.rf=setTimeout(this.Yh.bind(this,a),500)};w.ai=aa();
w.Yh=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new fd;a.Qa=q;a.Ha=this instanceof je;this.dispatchEvent(a);this.jd=q};w.Xh=aa();function ke(a){clearTimeout(a.rf);if(a.jd){var b=new fd;b.Qa=t;b.Ha=a instanceof je;a.dispatchEvent(b)}a.jd=t}w.Wh=function(a){a.preventDefault();eval("this.onTouchEnd()");ke(this)};w.Vh=aa();
w.$h=function(a){a.preventDefault();this.jd||ke(this);this.touchmoveEvent=a=a.Ma;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new H.g(c[0],c[1],0);var b=c[0]>3*this.ra.clientWidth/4,d=c[0]<this.ra.clientWidth/4,e=c[1]<this.ra.clientHeight/4,c=c[1]>3*this.ra.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.wc.la(a);this.wc=a.h();if(this.jd)a=new dd,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.K=e,this.dispatchEvent(a);
else if(this instanceof le&&(b||d))a=new gd,a.I=0>e.y,this.dispatchEvent(a);else if(this instanceof je||c)e.scale(3),a=new ed,a.K=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new H.g(a[0],a[1],0),b=new H.g(b[0],b[1],0),e=xc(a,b),b=e-this.Qf,this.Qf=e,this.wc.la(a),this.wc=a.h(),10<Math.abs(b)&&(a=new fd,a.Qa=0<b,a.Ha=this instanceof je,this.dispatchEvent(a)))};w.Zh=aa();
w.Lh=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.$d=q;this.F.KEYBOARD_ENABLED&&window.onkeydown==r&&(window.onkeydown=this.$f.bind(this));a.preventDefault();var b=a.shiftKey;this.cd=[a.offsetX,a.offsetY];var c=new H.g(this.cd[0],this.cd[1],0);a=this.Vd.la(c);this.Vd=c.h();this.F.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.rb||this.Xa||this.yb)&&ie(this),this.Zc=setTimeout(function(){ie(this);var a=new hd;a.md=c.x;a.nd=c.y;this.dispatchEvent(a);
this.Zc=r}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.eb()&&(this.Xa&&!b?(b=new ed,a.scale(3),b.K=a,this.dispatchEvent(b)):this.rb||this.Xa&&b?(b=new dd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.K=a,this.dispatchEvent(b)):this.yb&&(b=new fd,b.Qa=0<a.y,b.Ha=t,this.dispatchEvent(b)))};function ie(a){a.Zc&&clearTimeout(a.Zc);a.dispatchEvent(new id)}w.Ph=aa();
w.Qc=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");ie(this);a.preventDefault()};w.Gh=aa();
w.$f=function(a){if(this.$d){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");ie(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new jd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new dd:b?a=new fd:(a=new ed,this instanceof le&&(a=new gd)),a&&(c=new H.g(0,0,0),37==f?(c.x=5,a.I=t,b&&(a.I=q,a.Qa=q,a.Ha=t)):39==f?(c.x=-5,a.I=q,b&&(a.Qa=t,a.Ha=t)):38==f?(c.y=5,a.I=q,b&&(a.Qa=q,a.Ha=q)):40==f&&(c.y=-5,a.I=t,b&&(a.Qa=
t,a.Ha=q)),a.K=c,this.dispatchEvent(a)))}};D("X.interactor",he);D("X.interactor.prototype.init",he.prototype.ea);D("X.interactor.prototype.onMouseDown",he.prototype.Ih);D("X.interactor.prototype.onMouseUp",he.prototype.Nh);D("X.interactor.prototype.onMouseMove",he.prototype.Kh);D("X.interactor.prototype.onMouseWheel",he.prototype.Ph);D("X.interactor.prototype.onKey",he.prototype.Gh);D("X.interactor.prototype.onTouchStart",he.prototype.ai);D("X.interactor.prototype.onTouchMove",he.prototype.Zh);
D("X.interactor.prototype.onTouchEnd",he.prototype.Vh);D("X.interactor.prototype.onTouchHover",he.prototype.Xh);function le(a){he.call(this,a);this.c="interactor2D"}F(le,he);le.prototype.Qc=function(a){le.s.Qc.call(this,a);var b=new gd;a.nc==r&&(a.nc=0);b.I=0>a.nc;this.dispatchEvent(b)};function me(a){W.call(this);this.c="slice";this.k=[0,0,0];this.hc=[0,0,1];this.I=[0,1,0];this.G=this.M=10;this.Vb=[0,1,0,0,1,1,1,1,1,0,0,0];this.m=this.ab=r;this.Pa=q;this.ec=[1,1,1];a!=r&&this.Xb(a)}F(me,W);me.prototype.Xb=function(a){this.k=a.k.slice();this.hc=a.hc.slice();this.I=a.I.slice();this.M=a.M;this.G=a.G;this.ab=a.ab;this.m=a.m;this.Pa=a.Pa;this.ec=a.ec;this.zg=a.zg;me.s.Xb.call(this,a)};
me.prototype.mc=function(){var a=new S(this.hc[0],this.hc[1],this.hc[2]),b=new S(this.I[0],this.I[1],this.I[2]),c=zc(b,a),d=new S(this.k[0],this.k[1],this.k[2]),e=new S(1,1,1);1==a.x?(e=new S(this.k[0],this.G/2,this.M/2),this.Vb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new S(this.M/2,this.k[1],this.G/2),this.Vb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new S(this.M/2,this.G/2,this.k[2]));var f=yc(c.h().D(),b.h().D()),f=new S(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=yc(c.h().D(),b),g=new S(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=yc(c,b.h().D()),h=new S(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var l=h,b=yc(c,b),b=new S(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.i=new U(18);this.j=new U(18);this.i.add(f.x,f.y,f.b);this.i.add(g.x,g.y,g.b);this.i.add(h.x,h.y,h.b);this.i.add(l.x,l.y,l.b);this.i.add(b.x,b.y,b.b);this.i.add(d.x,d.y,d.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.Pa&&(a=new W,a.i=new U(24),a.j=
new U(24),a.i.add(f.x,f.y,f.b),a.i.add(g.x,g.y,g.b),a.i.add(g.x,g.y,g.b),a.i.add(b.x,b.y,b.b),a.i.add(b.x,b.y,b.b),a.i.add(h.x,h.y,h.b),a.i.add(h.x,h.y,h.b),a.i.add(f.x,f.y,f.b),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.Gb=[this.ec[0],this.ec[1],this.ec[2]],a.ja="LINES",a.jc=2,this.e.push(a))};D("X.slice",me);function R(a){W.call(this);this.c="volume";this.k=[0,0,0];this.aa=[10,10,10];this.H=[1,1,1];this.jb=[];this.vc=this.mb=this.uc=this.lb=this.tc=this.kb=0;this.Q=new W;this.R=new W;this.Za=new W;this.ld=this.Ka=t;this.zb=0;this.m=r;this.Pa=q;this.U=Infinity;this.T=-Infinity;this.ee=q;Ea(this,new pc);Ea(this,new Lc);a!=r&&this.Xb(a)}F(R,W);
R.prototype.Xb=function(a){window.console.log(a);this.k=a.k.slice();this.aa=a.aa.slice();this.H=a.H.slice();this.kb=a.kb;this.tc=a.tc;this.lb=a.lb;this.uc=a.uc;this.mb=a.mb;this.vc=a.vc;this.Q=new W(a.Q);this.R=new W(a.R);this.Za=new W(a.Za);this.Ka=a.Ka;this.ld=a.ld;this.zb=a.zb;this.m=a.m;this.Pa=a.Pa;R.s.Xb.call(this,a)};
R.prototype.mc=function(){this.e.length=0;this.Q.e.length=0;this.R.e.length=0;this.Za.e.length=0;this.e.push(this.Q);this.e.push(this.R);this.e.push(this.Za);for(var a=0,a=0;3>a;a++){for(var b=(this.aa[a]-1)/2,c=b,d=0,d=0;d<this.aa[a];d++){var e=-b*this.H[a]+d*this.H[a],f=[[this.k[0]+e,this.k[1],this.k[2]],[this.k[0],this.k[1]+e,this.k[2]],[this.k[0],this.k[1],this.k[2]+e]],e=this.e[a].e,g=0,h=0,l=[1,1,1],j=this.Pa;0==a?(g=this.aa[2]*this.H[2]-this.H[2],h=this.aa[1]*this.H[1]-this.H[1],l=[1,1,0]):
1==a?(g=this.aa[0]*this.H[0]-this.H[0],h=this.aa[2]*this.H[2]-this.H[2],l=[1,0,0]):2==a&&(g=this.aa[0]*this.H[0]-this.H[0],h=this.aa[1]*this.H[1]-this.H[1],l=[0,1,0]);this.ab!=r&&(j=t);var k=new me,p=k,f=f[a],s=[[1,0,0],[0,1,0],[0,0,1]][a],v=[[0,1,0],[0,0,-1],[0,1,0]][a];(f==r||!ha(f)||3!=f.length)&&m(Error("Invalid center."));(s==r||!ha(s)||3!=s.length)&&m(Error("Invalid front direction."));(v==r||!ha(v)||3!=v.length)&&m(Error("Invalid up direction."));y(g)||m(Error("Invalid width."));y(h)||m(Error("Invalid height."));
var z=t;j!=r&&(z=j);j=[1,1,1];l!=r&&(j=l);p.k=f;p.hc=s;p.I=v;p.M=g;p.G=h;p.Pa=z;p.ec=j;p.mc();k.ab=this;k.visible=d==Math.floor(c);e.push(k)}0==a?this.tc=this.kb=c:1==a?this.uc=this.lb=c:2==a&&(this.vc=this.mb=c)}this.f=q};
R.prototype.n=function(a){a="undefined"!==typeof a?a:q;if(0<this.e.length)if(this.Ka!=this.ld&&(this.Ka?(this.e[0].e[parseInt(this.kb,10)].visible=t,this.e[1].e[parseInt(this.lb,10)].visible=t,this.e[2].e[parseInt(this.mb,10)].visible=t):this.e[this.zb].visible=t,this.f=q,this.ld=this.Ka),this.Ka)ne(this,this.zb);else for(var b=0,b=0;3>b;b++){var c=this.e[b],d=0,e=0;0==b?(d=this.kb,e=this.tc,this.tc=this.kb):1==b?(d=this.lb,e=this.uc,this.uc=this.lb):2==b&&(d=this.mb,e=this.vc,this.vc=this.mb);c.e[parseInt(e,
10)].visible=t;c=c.e[parseInt(d,10)];c.visible=q;c.Z=1}a&&R.s.n.call(this)};R.prototype.__defineGetter__("dimensions",u("aa"));R.prototype.__defineGetter__("volumeRendering",u("Ka"));R.prototype.__defineSetter__("volumeRendering",function(a){this.Ka=a;this.n(t)});R.prototype.__defineSetter__("visible",ba("Ja"));R.prototype.__defineGetter__("center",u("k"));R.prototype.__defineSetter__("center",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid center."));this.k=a});
R.prototype.__defineGetter__("image",u("jb"));R.prototype.__defineGetter__("labelmap",function(){this.m||(this.m=new oe(this));return this.m});R.prototype.__defineGetter__("indexX",u("kb"));R.prototype.__defineSetter__("indexX",function(a){y(a)&&(0<=a&&a<this.Q.e.length)&&(this.kb=a,this.n(t))});R.prototype.__defineGetter__("indexY",u("lb"));R.prototype.__defineSetter__("indexY",function(a){y(a)&&(0<=a&&a<this.R.e.length)&&(this.lb=a,this.n(t))});R.prototype.__defineGetter__("indexZ",u("mb"));
R.prototype.__defineSetter__("indexZ",function(a){y(a)&&(0<=a&&a<this.Za.e.length)&&(this.mb=a,this.n(t))});R.prototype.__defineGetter__("windowLow",u("U"));R.prototype.__defineSetter__("windowLow",ba("U"));R.prototype.__defineGetter__("windowHigh",u("T"));R.prototype.__defineSetter__("windowHigh",ba("T"));R.prototype.__defineGetter__("borders",u("Pa"));R.prototype.__defineSetter__("borders",ba("Pa"));R.prototype.__defineGetter__("reslicing",u("ee"));R.prototype.__defineSetter__("reslicing",ba("ee"));
function ne(a,b){if(a.Ka&&(a.f||b!=a.zb)){var c=a.e[a.zb];c.visible=t;var c=a.e[b],d=c.e.length,e;for(e=0;e<d;e++)c.e[e].Ja=q;a.zb=b;a.f=t}}D("X.volume",R);D("X.volume.prototype.modified",R.prototype.n);function pe(){ld.call(this);this.c="parserSTL"}F(pe,ld);
pe.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");this.X=c;var d=b.i,e=b.j;if("solid"==nd(Y(this,"uchar",5))){b.i=d=new U(c.byteLength);b.j=e=new U(c.byteLength);var f=d,d=e,e=Y(this,"uchar",c.byteLength-5);c=e.length;var g=t,h=t,l=0,j;for(j=0;j<c;j++)if(10==e[j]){if(g||h){var k=nd(e,l,j).split(" "),h=parseFloat(k[0]),p=parseFloat(k[1]),k=parseFloat(k[2]);g?(d.add(h,p,k),d.add(h,p,k),d.add(h,p,k)):f.add(h,p,k);h=g=t}}else 32==e[j-1]&&(102==e[j]?(l=j+=13,g=q):118==e[j]&&(l=j+=7,h=q))}else{this.B=
80;f=Y(this,"uint");b.i=d=new U(9*f);b.j=e=new U(9*f);for(c=c=0;c<f;c++)g=Y(this,"float",12),l=g[0],j=g[1],h=g[2],e.add(l,j,h),e.add(l,j,h),e.add(l,j,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.B+=2}H.qa(this.c+".parse");f=new Nc;f.Y=b;f.q=a;this.dispatchEvent(f)};D("X.parserSTL",pe);D("X.parserSTL.prototype.parse",pe.prototype.parse);function qe(){ld.call(this);this.c="parserDCM"}F(qe,ld);qe.prototype.parse=function(a,b,c){c=this.Sc(c,b);if(c.Cd==c.Sa){var d=c.Se.length,e,f=0;for(e=0;e<d;e++){var g=c.Se[e];g!==n&&(g*=c.Wa,c.data.set(c.Mc.subarray(g,g+c.Wa),f*c.Wa),f++)}b.aa=[c.xa[0],c.xa[1],c.xa[2]];Infinity==c.ka[2]&&(c.ka[2]=1);b.H=[c.ka[0],c.ka[1],c.ka[2]];e=md(c.data);d=e[0];e=e[1];c.min=b.Ia=b.U=d;c.max=b.Fa=b.T=e;-Infinity==b.P&&(b.P=d);Infinity==b.S&&(b.S=e);b.mc();b.jb=od(this,b,c)}c=new Nc;c.Y=b;c.q=a;this.dispatchEvent(c)};
qe.prototype.Sc=function(a,b){this.X=a;var c=0;if(b.dc!=r){g=b.dc;h=Y(this,"ushort",this.X.byteLength-2*g.Wa);l=0;for(j=2;0<j;)if(d=h[l++],32==d)if(f=h[l++],19==f){l++;d=h[l++];for(f=0;f<d/2;f++)k=h[l++],p=k&255,k=(k&65280)>>8,c+=String.fromCharCode(p),c+=String.fromCharCode(k),c=parseInt(c,10);j--}else if(4161==f){l++;for(var d=h[l++],e="",f=0;f<d/2;f++)k=h[l++],p=k&255,k=(k&65280)>>8,e+=String.fromCharCode(p),e+=String.fromCharCode(k);g.ka=[g.ka[0],g.ka[1],Math.min(Math.abs(g.Sf-e),g.ka[2])];g.Sf=
e;j--}g.xa[2]++}else{var g={rows:0,cols:0,ka:r,ne:0,Jg:0,Sa:1,Eh:1,Sf:r,Cd:0,Wa:0,Mc:r,Me:0,Se:[],data:r,min:Infinity,max:-Infinity};g.Sa=b.o.length;g.Sa==r&&(g.Sa=1);for(var h=Y(this,"ushort",this.X.byteLength),l=66,d=r,f=r,d=r,j=7;0<j;)if(d=h[l++],40==d)switch(f=h[l++],l++,d=h[l++],f){case 16:g.rows=h[l++];j--;break;case 17:g.cols=h[l++];j--;break;case 256:g.ne=h[l++];j--;break;case 257:g.Jg=h[l++];j--;break;case 2:g.Eh=h[l++];j--;break;case 48:e="";for(f=f=0;f<d/2;f++)var k=h[l++],p=k&255,k=(k&
65280)>>8,e=e+String.fromCharCode(p),e=e+String.fromCharCode(k);e=e.split("\\");g.ka=[+e[0],+e[1],Infinity];j--}else if(32==d&&(f=h[l++],19==f)){l++;d=h[l++];for(f=0;f<d/2;f++)k=h[l++],p=k&255,k=(k&65280)>>8,c+=String.fromCharCode(p),c+=String.fromCharCode(k),c=parseInt(c,10);j--}b.dc=g;g.xa=[g.cols,g.rows,1];g.Wa=g.rows*g.cols;switch(g.ne){case 8:g.Mc=new Uint8Array(g.cols*g.rows*g.Sa);g.data=new Uint8Array(g.cols*g.rows*g.Sa);break;case 16:g.Mc=new Uint16Array(g.cols*g.rows*g.Sa);g.data=new Uint16Array(g.cols*
g.rows*g.Sa);break;case 32:g.Mc=new Uint32Array(g.cols*g.rows*g.Sa),g.data=new Uint32Array(g.cols*g.rows*g.Sa)}}this.B=this.X.byteLength-2*g.Wa;h=r;switch(g.ne){case 8:h=Y(this,"uchar",g.Wa);break;case 16:h=Y(this,"ushort",g.Wa);break;case 32:h=Y(this,"uint",g.Wa)}g.Se[c]=g.Me;g.Mc.set(h,g.Me*g.Wa);g.Me++;++g.Cd;return g};D("X.parserDCM",qe);D("X.parserDCM.prototype.parse",qe.prototype.parse);function re(){ld.call(this);this.c="parserVTK"}F(re,ld);
re.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");var d=b.i,e=b.j,f=new Uint8Array(c),g="";b.i=d=new U(c.byteLength);b.j=e=new U(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=nd(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.Hc=this.Ic=r;this.Jb=[];this.ta=Kc;this.ce=this.ub=this.ib=this.vb=t;c=0;for(h=g%8;h--;)ue(this,f[c]),c++;for(h=0.125*g^0;h--;)ue(this,f[c]),c++,ue(this,f[c]),c++,ue(this,f[c]),c++,ue(this,f[c]),c++,ue(this,f[c]),c++,ue(this,f[c]),c++,ue(this,f[c]),c++,
ue(this,f[c]),c++;c=this.Ic;var f=this.Hc,g=f.length,l=h=this.Jb.length;do{var j=this.Jb[h-l],k=j.length,p;for(p=0;p<k&&!("LINES"==this.ta&&p+1>=k);p++){var s=parseInt(j[p],10),v=c.get(s);d.add(v[0],v[1],v[2]);var z=s,A=v;"LINES"==this.ta?(z=parseInt(j[p+1],10),A=c.get(z),d.add(A[0],A[1],A[2])):"TRIANGLE_STRIPS"==this.ta&&(0==p||p==k-1)&&d.add(v[0],v[1],v[2]);s<g?(A=f.get(s),e.add(A[0],A[1],A[2]),"LINES"==this.ta?(z=f.get(z),e.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.ta&&(0==p||p==k-1)&&e.add(A[0],
A[1],A[2])):(z=new S(v[0],v[1],v[2]),z.normalize(),e.add(z.x,z.y,z.b),"LINES"==this.ta?(z=new S(A[0],A[1],A[2]),z.normalize(),e.add(z.x,z.y,z.b)):"TRIANGLE_STRIPS"==this.ta&&(0==p||p==k-1)&&e.add(z.x,z.y,z.b))}l--}while(0<l);b.ja=this.ta;H.qa(this.c+".parse");d=new Nc;d.Y=b;d.q=a;this.dispatchEvent(d)};
function ue(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.vb=q;a.ib=t;a.ub=t;c=parseInt(c[1],10);a.Ic=new U(3*c);a.Hc=new U(3*c);return;case "VERTICES":a.ib=q;a.vb=t;a.ub=t;c=parseInt(c[1],10);3<=c?a.ta=Kc:1==c?a.ta="POINTS":m(Error("This VTK file is not supported!"));a.Jb=[];return;case "TRIANGLE_STRIPS":a.ib=q;a.vb=t;a.ub=t;a.ta="TRIANGLE_STRIPS";a.Jb=[];return;case "LINES":a.ib=q;a.vb=t;a.ub=t;a.ta="LINES";a.Jb=[];return;case "POLYGONS":a.ib=q;
a.vb=t;a.ub=t;a.ta="POLYGONS";a.Jb=[];return;case "POINT_DATA":a.ub=q;a.vb=t;a.ib=t;return}if(a.vb)if(1==d||isNaN(parseFloat(e)))a.vb=t;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Ic.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Ic.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Ic.add(d,e,c))}else a.ib?1==d||isNaN(parseFloat(e))?a.ib=t:(c=c.slice(1),a.Jb.push(c)):a.ub&&("NORMALS"==e?a.ce=q:1==d||isNaN(parseFloat(e))?
(a.ub=t,a.ce=t):a.ce&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Hc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Hc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Hc.add(d,e,c))))}D("X.parserVTK",re);D("X.parserVTK.prototype.parse",re.prototype.parse);function ve(){ld.call(this);this.c="parserFSM";this.$c=t}F(ve,ld);
ve.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");this.X=c;var d=b.i,e=b.j;b.kc=[];var f=b.kc;c=0;var g;do g=Y(this,"uchar"),c++;while(200>c&&10!=g);Y(this,"uchar");e=Y(this,"uint");c=Y(this,"uint");var h=Y(this,"float",3*e);g=Y(this,"uint",3*c);var l=new Uint32Array(e),j=new Float32Array(9*c);b.i=d=new U(9*c);b.j=e=new U(9*c);var k;for(k=0;k<c;k++){var p=3*k,s=g[p],v=g[p+1],z=g[p+2];f.push(s);f.push(v);f.push(z);l[s]+=1;l[v]+=1;l[z]+=1;var p=3*s,A=3*v,C=3*z,E=h[p],x=h[p+1],B=h[p+2],v=h[A],
z=h[A+1],s=h[A+2],G=h[C],I=h[C+1],N=h[C+2];d.add(E,x,B);d.add(v,z,s);d.add(G,I,N);E=new S(E,x,B);G=new S(G,I,N);v=(new S(v,z,s)).h().la(E);z=G.h().la(E);v=zc(v,z).normalize();j[p]+=v.x;j[p+1]+=v.y;j[p+2]+=v.b;j[A]+=v.x;j[A+1]+=v.y;j[A+2]+=v.b;j[C]+=v.x;j[C+1]+=v.y;j[C+2]+=v.b}for(k=0;k<c;k++)p=3*k,s=g[p],v=g[p+1],z=g[p+2],p=3*s,A=3*v,C=3*z,f=new S(j[A],j[A+1],j[A+2]),h=new S(j[C],j[C+1],j[C+2]),p=(new S(j[p],j[p+1],j[p+2])).scale(1/l[s]).normalize(),f=f.scale(1/l[v]).normalize(),h=h.scale(1/l[z]).normalize(),
e.add(p.x,p.y,p.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.ja=Kc;H.qa(this.c+".parse");c=new Nc;c.Y=b;c.q=a;this.dispatchEvent(c)};D("X.parserFSM",ve);D("X.parserFSM.prototype.parse",ve.prototype.parse);var we={re:function(a,b,c){return we.update(a,0,b,c)},update:function(a,b,c,d){var e=we.rg,f="number"===typeof c?c:c=0;d="number"===typeof d?d:a.length;b^=4294967295;for(f=d&7;f--;++c)b=b>>>8^e[(b^a[c])&255];for(f=d>>3;f--;c+=8)b=b>>>8^e[(b^a[c])&255],b=b>>>8^e[(b^a[c+1])&255],b=b>>>8^e[(b^a[c+2])&255],b=b>>>8^e[(b^a[c+3])&255],b=b>>>8^e[(b^a[c+4])&255],b=b>>>8^e[(b^a[c+5])&255],b=b>>>8^e[(b^a[c+6])&255],b=b>>>8^e[(b^a[c+7])&255];return(b^4294967295)>>>0}};
we.rg=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function xe(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,l,j,k,p,s;for(p=0;p<b;++p)a[p]>c&&(c=a[p]),a[p]<d&&(d=a[p]);e=1<<c;f=new Uint32Array(e);g=1;h=0;for(l=2;g<=c;){for(p=0;p<b;++p)if(a[p]===g){j=0;k=h;for(s=0;s<g;++s)j=j<<1|k&1,k>>=1;for(s=j;s<e;s+=l)f[s]=g<<16|p;++h}++g;h<<=1;l<<=1}return[f,c,d]};function ye(a,b){this.oe=[];this.pe=32768;this.La=this.Kc=this.fa=this.Ve=0;this.input=new Uint8Array(a);this.uf=t;this.qe=ze;this.fb=t;if(b||!(b={}))b.index&&(this.fa=b.index),b.bufferSize&&(this.pe=b.bufferSize),b.bufferType&&(this.qe=b.bufferType),b.resize&&(this.fb=b.resize);switch(this.qe){case Ae:this.O=32768;this.ya=new Uint8Array(32768+this.pe+258);break;case ze:this.O=0;this.ya=new Uint8Array(this.pe);this.Zb=this.Wg;this.xf=this.Mg;this.xe=this.Qg;break;default:m(Error("invalid inflate mode"))}}
var Ae=0,ze=1;
ye.prototype.Nc=function(){for(;!this.uf;){var a=Be(this,3);a&1&&(this.uf=q);a>>>=1;switch(a){case 0:var a=this.input,b=this.fa,c=this.ya,d=this.O,e=n,f=n,g=n,h=c.length,e=n;this.La=this.Kc=0;e=a[b++];e===n&&m(Error("invalid uncompressed block header: LEN (first byte)"));f=e;e=a[b++];e===n&&m(Error("invalid uncompressed block header: LEN (second byte)"));f|=e<<8;e=a[b++];e===n&&m(Error("invalid uncompressed block header: NLEN (first byte)"));g=e;e=a[b++];e===n&&m(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
e<<8;f===~g&&m(Error("invalid uncompressed block header: length verify"));b+f>a.length&&m(Error("input buffer is broken"));switch(this.qe){case Ae:for(;d+f>c.length;)e=h-d,f-=e,c.set(a.subarray(b,b+e),d),d+=e,b+=e,this.O=d,c=this.Zb(),d=this.O;break;case ze:for(;d+f>c.length;)c=this.Zb({Ef:2});break;default:m(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),d);d+=f;this.fa=b+=f;this.O=d;this.ya=c;break;case 1:this.xe(Ce,De);break;case 2:Ee(this);break;default:m(Error("unknown BTYPE: "+a))}}return this.xf()};
var Fe=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ge=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),He=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),Ie=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),Je=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ke=new Uint8Array(288),
Le,Me;Le=0;for(Me=Ke.length;Le<Me;++Le)Ke[Le]=143>=Le?8:255>=Le?9:279>=Le?7:8;var Ce=xe(Ke),Ne=new Uint8Array(30),Oe,Pe;Oe=0;for(Pe=Ne.length;Oe<Pe;++Oe)Ne[Oe]=5;var De=xe(Ne);function Be(a,b){for(var c=a.Kc,d=a.La,e=a.input,f=a.fa,g;d<b;)g=e[f++],g===n&&m(Error("input buffer is broken")),c|=g<<d,d+=8;g=c&(1<<b)-1;a.Kc=c>>>b;a.La=d-b;a.fa=f;return g}
function Qe(a,b){for(var c=a.Kc,d=a.La,e=a.input,f=a.fa,g=b[0],h=b[1],l;d<h;)l=e[f++],l===n&&m(Error("input buffer is broken")),c|=l<<d,d+=8;e=g[c&(1<<h)-1];g=e>>>16;a.Kc=c>>g;a.La=d-g;a.fa=f;return e&65535}
function Ee(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=Qe(this,b),d){case 16:for(d=3+Be(this,2);d--;)c[f++]=e;break;case 17:for(d=3+Be(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+Be(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=Be(a,5)+257,d=Be(a,5)+1,e=Be(a,4)+4,f=new Uint8Array(Fe.length),g;for(g=0;g<e;++g)f[Fe[g]]=Be(a,3);e=xe(f);f=new Uint8Array(c);g=new Uint8Array(d);a.xe(xe(b.call(a,c,e,f)),xe(b.call(a,d,e,g)))}w=ye.prototype;
w.xe=function(a,b){var c=this.ya,d=this.O;this.Af=a;for(var e=c.length-258,f,g,h;256!==(f=Qe(this,a));)if(256>f)d>=e&&(this.O=d,c=this.Zb(),d=this.O),c[d++]=f;else{f-=257;h=Ge[f];0<He[f]&&(h+=Be(this,He[f]));f=Qe(this,b);g=Ie[f];0<Je[f]&&(g+=Be(this,Je[f]));d>=e&&(this.O=d,c=this.Zb(),d=this.O);for(;h--;)c[d]=c[d++-g]}for(;8<=this.La;)this.La-=8,this.fa--;this.O=d};
w.Qg=function(a,b){var c=this.ya,d=this.O;this.Af=a;for(var e=c.length,f,g,h;256!==(f=Qe(this,a));)if(256>f)d>=e&&(c=this.Zb(),e=c.length),c[d++]=f;else{f-=257;h=Ge[f];0<He[f]&&(h+=Be(this,He[f]));f=Qe(this,b);g=Ie[f];0<Je[f]&&(g+=Be(this,Je[f]));d+h>e&&(c=this.Zb(),e=c.length);for(;h--;)c[d]=c[d++-g]}for(;8<=this.La;)this.La-=8,this.fa--;this.O=d};
w.Zb=function(){var a=new Uint8Array(this.O-32768),b=this.O-32768,c=this.ya;a.set(c.subarray(32768,a.length));this.oe.push(a);this.Ve+=a.length;c.set(c.subarray(b,b+32768));this.O=32768;return c};w.Wg=function(a){var b=this.input.length/this.fa+1|0,c=this.input,d=this.ya;a&&("number"===typeof a.Ef&&(b=a.Ef),"number"===typeof a.Fg&&(b+=a.Fg));2>b?(a=(c.length-this.fa)/this.Af[2],a=258*(a/2)|0,a=a<d.length?d.length+a:d.length<<1):a=d.length*b;a=new Uint8Array(a);a.set(d);return this.ya=a};
w.xf=function(){var a=0,b=this.ya,c=this.oe,d,e=new Uint8Array(this.Ve+(this.O-32768)),f,g,h,l;if(0===c.length)return this.ya.subarray(32768,this.O);f=0;for(g=c.length;f<g;++f){d=c[f];h=0;for(l=d.length;h<l;++h)e[a++]=d[h]}f=32768;for(g=this.O;f<g;++f)e[a++]=b[f];this.oe=[];return this.buffer=e};w.Mg=function(){var a,b=this.O;this.fb?(a=new Uint8Array(b),a.set(this.ya.subarray(0,b))):a=this.ya.subarray(0,b);return this.buffer=a};new Uint8Array(256);var Re;for(Re=0;256>Re;++Re)for(var Se=Re,Te=7,Se=Se>>>1;Se;Se>>>=1)--Te;var Ue=[],Ve;for(Ve=0;288>Ve;Ve++)switch(q){case 143>=Ve:Ue.push([Ve+48,8]);break;case 255>=Ve:Ue.push([Ve-144+400,9]);break;case 279>=Ve:Ue.push([Ve-256+0,7]);break;case 287>=Ve:Ue.push([Ve-280+192,8]);break;default:m("invalid literal: "+Ve)}
function We(){var a=Xe;switch(q){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:m("invalid length: "+a)}}var Ye=[],Xe,Ze;
for(Xe=3;258>=Xe;Xe++)Ze=We(),Ye[Xe]=Ze[2]<<24|Ze[1]<<16|Ze[0];new Uint32Array(Ye);function $e(){};function af(a){this.input=a;this.fa=0;this.member=[]}
af.prototype.Nc=function(){for(var a=this.input.length;this.fa<a;){var b=new $e,c=n,d=n,e=n,f=c=e=n,g=n,c=c=n,h=this.input,d=this.fa;b.Kf=h[d++];b.Lf=h[d++];(31!==b.Kf||139!==b.Lf)&&m(Error("invalid file signature:",b.Kf,b.Lf));b.wf=h[d++];switch(b.wf){case 8:break;default:m(Error("unknown compression method: "+b.wf))}b.td=h[d++];c=h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24;b.Nj=new Date(1E3*c);b.Qj=h[d++];b.Oj=h[d++];0<(b.td&4)&&(b.Ni=h[d++]|h[d++]<<8,d+=b.Ni);if(0<(b.td&8)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.td&16)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.td&2)&&(b.Ng=we.re(h,0,d)&65535,b.Ng!==(h[d++]|h[d++]<<8)&&m(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-d-4-4<512*c&&(e=c);d=new ye(h,{index:d,bufferSize:e});b.data=e=d.Nc();d=d.fa;b.Gj=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;we.re(e)!==c&&m(Error("invalid CRC-32 checksum: 0x"+we.re(e).toString(16)+
" / 0x"+c.toString(16)));b.Kj=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;(e.length&4294967295)!==c&&m(Error("invalid input size: "+(e.length&4294967295)+" / "+c));this.member.push(b);this.fa=d}a=this.member;b=e=d=0;for(h=a.length;b<h;++b)e+=a[b].data.length;e=new Uint8Array(e);for(b=0;b<h;++b)e.set(a[b].data,d),d+=a[b].data.length;return e};function bf(){ld.call(this);this.c="parserMGZ";this.$c=t}F(bf,ld);bf.prototype.parse=function(a,b,c,d){H.Ea(this.c+".parse");d&&(c=(new af(new Uint8Array(c))).Nc(),c=c.buffer);d=this.Sc(c);b.aa=[d.Ee,d.Fe,d.Ge];b.H=d.lg;c=d.min;var e=d.max;b.Ia=b.U=c;b.Fa=b.T=e;-Infinity==b.P&&(b.P=c);Infinity==b.S&&(b.S=e);b.mc();H.qa(this.c+".parse");b.jb=od(this,b,d);d=new Nc;d.Y=b;d.q=a;this.dispatchEvent(d)};
bf.prototype.Sc=function(a){this.X=a;a={version:0,ug:0,sg:0,bh:0,tg:0,Ee:0,Fe:0,Ge:0,Dh:0,type:0,Ug:0,ig:0,Si:r,qg:r,lg:r,data:r,min:Infinity,max:-Infinity};a.version=Y(this,"uint");a.Ee=Y(this,"uint");a.Fe=Y(this,"uint");a.Ge=Y(this,"uint");a.Dh=Y(this,"uint");a.type=Y(this,"uint");a.Ug=Y(this,"uint");a.ig=Y(this,"ushort");if(0<a.ig){a.lg=Y(this,"float",3);var b=[];b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));a.qg=b}this.B=284;b=a.Ee*a.Fe*
a.Ge;switch(a.type){case 0:a.data=Y(this,"uchar",b);break;case 1:a.data=Y(this,"uint",b);break;case 3:a.data=Y(this,"float",b);break;case 4:a.data=Y(this,"ushort",b);break;default:m(Error("Unsupported MGH/MGZ data type: "+a.type))}b=md(a.data);a.min=b[0];a.max=b[1];this.B+16<this.X.byteLength&&(a.ug=Y(this,"float"),a.bh=Y(this,"float"),a.sg=Y(this,"float"),a.tg=Y(this,"float"));return a};D("X.parserMGZ",bf);D("X.parserMGZ.prototype.parse",bf.prototype.parse);function cf(){ld.call(this);this.c="parserCRV";this.$c=t}F(cf,ld);
cf.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");var d=b.kc;0==d.length&&m(Error("No _pointIndices defined on the X.object."));this.X=c;this.B=3;var e=Y(this,"uint");Y(this,"uint");Y(this,"uint");var f=0,g=0,h=0,l=0,j=0,k=0,p=0,s=0,v=0,z=0,A=0;c=Array(2);var C=Array(2),E=Y(this,"float",e),x;for(x=0;x<e;x++){var B=E[x];0==x&&(c[0]=C[0]=B);0<=B?(f++,l+=B):(g++,h+=B);v+=B;A++;C[0]=Math.max(B,C[0]);c[0]=Math.min(B,c[0]);E[x]=B}0!=f&&(j=l/f);0!=g&&(k=h/g);0!=A&&(z=v/A);for(A=v=h=l=0;A<e;A++)B=
E[A],x=0,0<=B?(x=Math.pow(B-j,2),l+=x):(x=Math.pow(B-k,2),h+=x),x=Math.pow(B-z,2),v+=x;1<f&&(p=Math.sqrt(l/(f-1)));1<g&&(s=Math.sqrt(h/(g-1)));c[1]=k-2.5*s;C[1]=j+2.5*p;e=d.length;f=new Float32Array(3*e);for(A=0;A<e;A++)g=E[d[A]],h=3*A,f[h]=g,f[h+1]=g,f[h+2]=g;b.u.Ia=c[1];b.u.Fa=C[1];-Infinity==b.u.P&&(b.u.P=c[1]);Infinity==b.u.S&&(b.u.S=C[1]);b.u.v=E;b.u.sc=f;b.u.f=q;H.qa(this.c+".parse");d=new Nc;d.Y=b;d.q=a;this.dispatchEvent(d)};D("X.parserCRV",cf);D("X.parserCRV.prototype.parse",cf.prototype.parse);function df(){ld.call(this);this.c="parserTRK"}F(df,ld);
df.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");var d=b.i,e=b.j,f=b.W;this.X=c;Y(this,"uchar",6);Y(this,"ushort",3);var g=Y(this,"float",3);Y(this,"float",3);var h=Y(this,"ushort");Y(this,"uchar",200);Y(this,"ushort");Y(this,"uchar",200);Y(this,"float",16);Y(this,"uchar",444);Y(this,"uchar",4);Y(this,"uchar",4);Y(this,"float",6);Y(this,"uchar",2);Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");var l=Y(this,"uint");Y(this,"uint");var j=Y(this,
"uint"),k=[],p=[];c=Infinity;var s=-Infinity,v=r,z=r,A=r,C=r,e=d=r,E=Y(this,"uint",(this.X.byteLength-1E3)/4);this.B=j;for(var x=Y(this,"float",(this.X.byteLength-1E3)/4),B=0,j=f=0;j<l;j++){for(var G=E[B],I=new U(3*G),N=0,J=0;J<G;J++){var K=x[B+3*J+J*h+1],P=x[B+3*J+J*h+2],V=x[B+3*J+J*h+3],K=K/g[0],P=P/g[1],V=V/g[2];I.add(K,P,V);if(0<J)var T=I.get(J-1),N=N+Math.sqrt(Math.pow(K-T[0],2)+Math.pow(P-T[1],2)+Math.pow(V-T[2],2));J<G-1&&(f+=6)}B+=3*G+G*h+1;J=I.Ob;G=I.Lb;K=I.Pb;P=I.Mb;V=I.Qb;T=I.Nb;if(!v||
J<v)v=J;if(!z||G>z)z=G;if(!A||K<A)A=K;if(!C||P>C)C=P;if(!d||V<d)d=V;if(!e||T>e)e=T;k.push(I);p.push(N)}g=(v+z)/2;A=(A+C)/2;h=(d+e)/2;C=new Float32Array(f);b.i=d=new U(f);b.j=e=new U(f);b.W=f=new U(f);for(j=v=0;j<l;j++){z=k[j];E=z.count;N=p[j];c=Math.min(c,N);s=Math.max(s,N);for(J=0;J<E-1;J++){B=z.get(J);x=z.get(J+1);d.add(B[0],B[1],B[2]);d.add(x[0],x[1],x[2]);var I=B[0]-g,G=B[1]-A,K=B[2]-h,P=Math.sqrt(I*I+G*G+K*K),V=x[0]-g,T=x[1]-A,ia=x[2]-h,ka=Math.sqrt(V*V+T*T+ia*ia);e.add(I/P,G/P,K/P);e.add(V/
ka,T/ka,ia/ka);x=[Math.abs(x[0]-B[0]),Math.abs(x[1]-B[1]),Math.abs(x[2]-B[2])];B=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]);x[0]/=B;x[1]/=B;x[2]/=B;f.add(x[0],x[1],x[2]);f.add(x[0],x[1],x[2]);C[v++]=N;C[v++]=N;C[v++]=N;C[v++]=N;C[v++]=N;C[v++]=N}}b.ja="LINES";l=new Mc;l.Ia=c;l.Fa=s;l.P=c;l.S=s;l.sc=C;l.qf=t;l.f=q;b.u=l;H.qa(this.c+".parse");c=new Nc;c.Y=b;c.q=a;this.dispatchEvent(c)};D("X.parserTRK",df);D("X.parserTRK.prototype.parse",df.prototype.parse);function ef(){ld.call(this);this.c="parserIMAGE"}F(ef,ld);ef.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||m(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;Sb(f,"load",this.gi.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};ef.prototype.gi=function(a,b,c){b.jb=a;b.va=r;a=new Nc;a.Y=c;a.q=b;this.dispatchEvent(a)};D("X.parserIMAGE",ef);D("X.parserIMAGE.prototype.parse",ef.prototype.parse);function ff(){ld.call(this);this.c="parserLUT"}F(ff,ld);
ff.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");this.X=c;c=Y(this,"uchar",c.byteLength);var d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=nd(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}H.qa(this.c+".parse");c=new Nc;c.Y=b;c.q=a;this.dispatchEvent(c)};
D("X.parserLUT",ff);D("X.parserLUT.prototype.parse",ff.prototype.parse);function gf(){ld.call(this);this.c="parserNRRD"}F(gf,ld);
gf.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");this.X=c;c=Y(this,"uchar",c.byteLength);var d=c.length,e=r,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=nd(c,0,g-2);f=g+1;break}var h,l,j,k,d=e.split(/\r?\n/),e=0;for(g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.vh=q;else if(!h.match(/^#/)&&(k=h.match(/(.*):(.*)/)))l=k[1].trim(),h=k[2].trim(),(j=this.Yg[l])?j.call(this,h):this[l]=h;this.vh||m(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
m(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Ga&&(this.Ga=[new S(1,0,0),new S(0,1,0),new S(0,0,1)],this.Te)){d=[];for(k=0;2>=k;k++)d.push(!isNaN(this.Te[k])?this.Ga[k].scale(this.Te[k]):n)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new af(new Uint8Array(f))).Nc();f=f.buffer;c={data:r,min:Infinity,max:-Infinity};c.data=new this.Fb(f);k=md(c.data);f=c.min=k[0];k=c.max=k[1];b.aa=[this.Qe[0],this.Qe[1],this.Qe[2]];d=(new S(this.Ga[0][0],this.Ga[0][1],this.Ga[0][2])).eb();
e=(new S(this.Ga[1][0],this.Ga[1][1],this.Ga[1][2])).eb();g=(new S(this.Ga[2][0],this.Ga[2][1],this.Ga[2][2])).eb();b.H=[d,e,g];b.Ia=b.U=f;b.Fa=b.T=k;-Infinity==b.P&&(b.P=f);Infinity==b.S&&(b.S=k);b.mc();H.qa(this.c+".parse");b.jb=od(this,b,c);c=new Nc;c.Y=b;c.q=a;this.dispatchEvent(c)};
gf.prototype.Yg={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Fb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Fb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Fb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Fb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Fb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Fb=Uint32Array;break;case "float":this.Fb=Float32Array;break;default:m(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.Jj=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.xa=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.Qe=e},"space directions":function(a){var b,
c;a=a.match(/\(.*?\)/g);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.Ga=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];c=0;for(d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.Te=e}};D("X.parserNRRD",gf);D("X.parserNRRD.prototype.parse",gf.prototype.parse);function hf(){ld.call(this);this.c="parserNII"}F(hf,ld);
hf.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,q);348!=e&&(d=(new af(new Uint8Array(d))).Nc(),d=d.buffer);c=this.Sc(d);b.aa=[c.xa[1],c.xa[2],c.xa[3]];b.H=[c.ka[1],c.ka[2],c.ka[3]];d=c.min;e=c.max;b.Ia=b.U=d;b.Fa=b.T=e;-Infinity==b.P&&(b.P=d);Infinity==b.S&&(b.S=e);b.mc();H.qa(this.c+".parse");b.jb=od(this,b,c);c=new Nc;c.Y=b;c.q=a;this.dispatchEvent(c)};
hf.prototype.Sc=function(a){this.X=a;a={zi:0,Og:r,Pg:r,Xg:0,wi:0,qi:0,Tg:r,xa:r,rh:0,sh:0,th:0,ph:0,we:0,Ig:0,Di:0,ka:r,mg:0,vi:0,ui:0,Ci:0,Ai:r,Oi:r,Kg:0,Lg:0,Bi:0,Ii:0,eh:0,fh:0,Rg:r,Hg:r,ji:0,xi:0,ni:0,oi:0,pi:0,ki:0,li:0,mi:0,Ei:r,Fi:r,Gi:r,qh:r,xh:r,data:r,min:Infinity,max:-Infinity};a.zi=Y(this,"uint");a.Og=Y(this,"uchar",10);a.Pg=Y(this,"uchar",18);a.Xg=Y(this,"uint");a.wi=Y(this,"ushort");a.qi=Y(this,"uchar");a.Tg=Y(this,"uchar");a.xa=Y(this,"ushort",8);a.rh=Y(this,"float");a.sh=Y(this,"float");
a.th=Y(this,"float");a.ph=Y(this,"ushort");a.we=Y(this,"ushort");a.Ig=Y(this,"ushort");a.Di=Y(this,"ushort");a.ka=Y(this,"float",8);a.mg=Y(this,"float");a.vi=Y(this,"float");a.ui=Y(this,"float");a.Ci=Y(this,"ushort");a.Ai=Y(this,"uchar");a.Oi=Y(this,"uchar");a.Kg=Y(this,"float");a.Lg=Y(this,"float");a.Bi=Y(this,"float");a.Ii=Y(this,"float");a.eh=Y(this,"uint",1);a.fh=Y(this,"uint",1);a.Rg=Y(this,"uchar",80);a.Hg=Y(this,"uchar",24);a.ji=Y(this,"ushort");a.xi=Y(this,"ushort");a.ni=Y(this,"float");a.oi=
Y(this,"float");a.pi=Y(this,"float");a.ki=Y(this,"float");a.li=Y(this,"float");a.mi=Y(this,"float");a.Ei=Y(this,"float",4);a.Fi=Y(this,"float",4);a.Gi=Y(this,"float",4);a.qh=Y(this,"uchar",16);a.xh=Y(this,"uchar",4);this.B=parseInt(a.mg,10);var b=a.xa[1]*a.xa[2]*a.xa[3];switch(a.we){case 2:a.data=Y(this,"uchar",b);break;case 4:a.data=Y(this,"sshort",b);break;case 8:a.data=Y(this,"sint",b);break;case 16:a.data=Y(this,"float",b);break;case 256:a.data=Y(this,"schar",b);break;case 512:a.data=Y(this,"ushort",
b);break;case 768:a.data=Y(this,"uint",b);break;default:m(Error("Unsupported NII data type: "+a.we))}b=md(a.data);a.min=b[0];a.max=b[1];return a};D("X.parserNII",hf);D("X.parserNII.prototype.parse",hf.prototype.parse);function jf(){ld.call(this);this.c="parserOBJ"}F(jf,ld);
jf.prototype.parse=function(a,b,c){H.Ea(this.c+".parse");this.X=c;c=c.byteLength;var d=Y(this,"uchar",c),e=[];b.i=new U(c);b.j=new U(c);var f=b.i,g=b.j,h=0,l;for(l=0;l<c;++l)if(10==d[l]){var j=nd(d,h,l).replace(/\s{2,}/g," ").split(" ");if("v"==j[0])e.push([parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3])]);else if("f"==j[0]){var k=e[parseInt(j[1],10)-1],h=e[parseInt(j[2],10)-1],j=e[parseInt(j[3],10)-1];f.add(k[0],k[1],k[2]);f.add(h[0],h[1],h[2]);f.add(j[0],j[1],j[2]);k=new S(k[0],k[1],k[2]);j=
new S(j[0],j[1],j[2]);h=zc((new S(h[0],h[1],h[2])).la(k),j.la(k));h.normalize();g.add(h.x,h.y,h.b);g.add(h.x,h.y,h.b);g.add(h.x,h.y,h.b)}h=l+1}H.qa(this.c+".parse");c=new Nc;c.Y=b;c.q=a;this.dispatchEvent(c)};D("X.parserOBJ",jf);D("X.parserOBJ.prototype.parse",jf.prototype.parse);function kf(){Q.call(this);this.c="loader";this.ic=new rc;this.Fc=0}F(kf,Q);function lf(a,b){a.Fc+=b/a.ic.ud()/3;a.Fc=Math.min(1,a.Fc);var c=new kd;c.sf=a.Fc;a.dispatchEvent(c)}function mf(a){a=a.o.dd;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in nf||m(Error("The "+b+" file format is not supported."));return[a,b,nf[b][0],nf[b][1],nf[b][2]]}
kf.prototype.load=function(a,b){(!a||!b)&&m(Error("No container or object to load."));if(!uc(this.ic.J,a.sa)||this.ic.get(a.sa)){this.ic.set(a.sa,t);var c=mf(a)[0];if(a.Ib!=r)this.parse(r,a,b);else{var d=new XMLHttpRequest;O(d,"abort",this.Df.bind(this,d,a,b));O(d,"error",this.Df.bind(this,d,a,b));O(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,q);d.responseType="arraybuffer";d.send(r)}}};
kf.prototype.parse=function(a,b,c){lf(this,1);setTimeout(function(){var d=mf(b),e=d[3],d=new d[2];Sb(d,Zc,this.complete.bind(this));var f=b.Ib;f==r&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};kf.prototype.complete=function(a){lf(this,1);setTimeout(function(){var b=a.q,c=a.Y;b.o.f=t;b.f=q;c.n();this.ic.set(b.sa,q)}.bind(this),100)};kf.prototype.Df=function(a,b,c){m(Error("Loading failed: ",b,c))};
var nf={OBJ:[jf,r],STL:[pe,r],VTK:[re,r],TRK:[df,r],FSM:[ve,r],INFLATED:[ve,r],SMOOTHWM:[ve,r],SPHERE:[ve,r],PIAL:[ve,r],ORIG:[ve,r],NRRD:[gf,r],NII:[hf,r],GZ:[hf,r],DCM:[qe,r],DICOM:[qe,r],"":[qe,r],CRV:[cf,r],LABEL:[td,r],MGH:[bf,t],MGZ:[bf,q],TXT:[ff,r],LUT:[ff,r],PNG:[ef,"png"],JPG:[ef,"jpeg"],JPEG:[ef,"jpeg"],GIF:[ef,"gif"]};function of(a,b){(!y(a)||!y(b))&&m(Error("A camera needs valid width and height values."));Q.call(this);this.c="camera";this.ua=new H.g(0,0,100);this.gc=new H.g(0,0,0);this.I=new H.g(0,1,0);this.p=this.Ed(this.ua,this.gc)}F(of,Q);of.prototype.observe=function(a){(a==r||!(a instanceof he))&&m(Error("Could not observe the interactor."));O(a,Uc,this.Th.bind(this));O(a,Tc,this.Qh.bind(this));O(a,Vc,this.ei.bind(this))};
of.prototype.Th=function(a){a instanceof ed||m(Error("Received no valid rotate event."));this.rotate(a.K)};of.prototype.ei=function(a){a instanceof fd||m(Error("Received no valid zoom event."));a.Qa?this.ng(a.Ha):this.og(a.Ha)};of.prototype.Qh=function(a){a instanceof dd||m(Error("Received no valid pan event."));this.eg(a.K)};of.prototype.__defineGetter__("view",u("p"));of.prototype.__defineSetter__("view",function(a){(a==r||!(a instanceof Float32Array))&&m(Error("Invalid view matrix."));this.p=a});
of.prototype.__defineGetter__("position",function(){return[this.ua.x,this.ua.y,this.ua.b]});of.prototype.__defineSetter__("position",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid position."));this.ua=new H.g(a[0],a[1],a[2]);this.reset()});of.prototype.__defineGetter__("focus",function(){return[this.gc.x,this.gc.y,this.gc.b]});of.prototype.__defineSetter__("focus",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid focus"));this.gc=new H.g(a[0],a[1],a[2]);this.reset()});
of.prototype.__defineGetter__("up",function(){return[this.I.x,this.I.y,this.I.b]});of.prototype.__defineSetter__("up",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid up vector."));this.I=new H.g(a[0],a[1],a[2]);this.reset()});w=of.prototype;w.reset=function(){this.p=this.Ed(this.ua,this.gc)};w.rotate=function(a){ha(a)&&2==a.length?a=new H.g(a[0],a[1],0):a instanceof H.g||m(Error("Invalid distance vector for rotate operation."));return a};
w.eg=function(a){ha(a)&&2==a.length?a=new H.g(a[0],a[1],0):a instanceof H.g||m(Error("Invalid distance vector for pan operation."));this.p[12]-=a.x;this.p[13]+=a.y};w.ng=function(a){var b=20;a!=r&&!a&&(b=1);this.p[14]+=b};w.og=function(a){var b=30;a!=r&&!a&&(b=1);this.p[14]-=b};w.Ed=function(a,b){(!(a instanceof H.g)||!(b instanceof H.g))&&m(Error("3D vectors required for calculating the view."));return H.d.Oc()};D("X.camera",of);D("X.camera.prototype.pan",of.prototype.eg);
D("X.camera.prototype.rotate",of.prototype.rotate);D("X.camera.prototype.zoomIn",of.prototype.ng);D("X.camera.prototype.zoomOut",of.prototype.og);function pf(a){function b(a,b,d){b=2*b*Math.PI;b=ya(za(l,Math.cos(b)),za(j,Math.sin(b)));a=ya(ya(c,za(e,a)),za(b,f));d=ya(za(b,1-Math.abs(d)),za(g,d));return new cc(a,d)}this.A=[];a=a||{};var c=new xa(a.start||[0,-1,0]),d=new xa(a.end||[0,1,0]),e=Aa(d,c),f=a.Ta||1;a=a.Re||16;for(var g=Ba(e),h=0.5<Math.abs(g.y()),l=Ba((new xa(h,!h,0)).Yb(g)),j=Ba(l.Yb(g)),h=new cc(c,Ca(g)),d=new cc(d,Ba(g)),k=[],p=0;p<a;p++){var s=p/a,v=(p+1)/a;k.push(new ec([h,b(0,s,-1),b(0,v,-1)]));k.push(new ec([b(0,v,0),b(0,s,
0),b(1,s,0),b(1,v,0)]));k.push(new ec([d,b(1,v,1),b(1,s,1)]))}return mc(k)}F(pf,lc);function qf(){W.call(this);this.c="cylinder";this.je=[-10,-10,-10];this.Rd=[10,10,10];this.Rb=10;this.Ub=32;Ea(this,new Pc)}F(qf,W);qf.prototype.__defineGetter__("start",u("je"));qf.prototype.__defineSetter__("start",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid start"));this.je=a});qf.prototype.__defineGetter__("end",u("Rd"));qf.prototype.__defineSetter__("end",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid end"));this.Rd=a});qf.prototype.__defineGetter__("radius",u("Rb"));
qf.prototype.__defineSetter__("radius",function(a){y(a)||m(Error("Invalid radius."));this.Rb=a});qf.prototype.n=function(){Rc(this,new pf({start:this.je,end:this.Rd,Ta:this.Rb,Re:this.Ub}));qf.s.n.call(this)};D("X.cylinder",qf);D("X.cylinder.prototype.modified",qf.prototype.n);function rf(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var e=new xa(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new cc(ya(c,za(e,d)),e))}this.A=[];a=a||{};var c=new xa(a.se||[0,0,0]),d=a.Ta||1,e=a.Re||16;a=a.Hi||8;for(var f=[],g=[],h=0;h<e;h++)for(var l=0;l<a;l++)g=[],b(h/e,l/a),0<l&&b((h+1)/e,l/a),l<a-1&&b((h+1)/e,(l+1)/a),b(h/e,(l+1)/a),f.push(new ec(g));return mc(f)}F(rf,lc);function sf(){W.call(this);this.c="sphere";this.k=[0,0,0];this.Rb=5;this.Ub=32;this.Bg=16;Ea(this,new Pc)}F(sf,W);sf.prototype.__defineGetter__("center",u("k"));sf.prototype.__defineSetter__("center",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid center"));this.k=a});sf.prototype.__defineGetter__("radius",u("Rb"));sf.prototype.__defineSetter__("radius",function(a){y(a)||m(Error("Invalid radius."));this.Rb=a});
sf.prototype.n=function(){Rc(this,new rf({se:this.k,Ta:this.Rb,Re:this.Ub,Hi:this.Bg}));sf.s.n.call(this)};D("X.sphere",sf);D("X.sphere.prototype.modified",sf.prototype.n);function oe(a){R.call(this);this.c="labelmap";this.ab=a}F(oe,R);oe.prototype.n=function(){var a=new Nc;a.Y=this;this.dispatchEvent(a);this.ab.n()};D("X.labelmap",oe);function tf(a){this.A=[];a=a||{};var b=new xa(a.se||[0,0,0]),c=!a.Ta?[1,1,1]:a.Ta.length?a.Ta:[a.Ta,a.Ta,a.Ta];return mc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new ec(a[0].map(function(e){e=new xa(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new cc(e,new xa(a[1]))}))}))}F(tf,lc);function uf(){W.call(this);this.c="cube";this.k=[0,0,0];this.Yd=this.Xd=this.Wd=20;this.Vb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Ea(this,new Pc)}F(uf,W);uf.prototype.__defineGetter__("center",u("k"));uf.prototype.__defineSetter__("center",function(a){(a==r||!ha(a)||3!=a.length)&&m(Error("Invalid center"));this.k=a});uf.prototype.__defineGetter__("lengthX",u("Wd"));
uf.prototype.__defineSetter__("lengthX",function(a){y(a)||m(Error("Invalid lengthX."));this.Wd=a});uf.prototype.__defineGetter__("lengthY",u("Xd"));uf.prototype.__defineSetter__("lengthY",function(a){y(a)||m(Error("Invalid lengthY."));this.Xd=a});uf.prototype.__defineGetter__("lengthZ",u("Yd"));uf.prototype.__defineSetter__("lengthZ",function(a){y(a)||m(Error("Invalid lengthZ."));this.Yd=a});uf.prototype.n=function(){Rc(this,new tf({se:this.k,Ta:[this.Wd/2,this.Xd/2,this.Yd/2]}));uf.s.n.call(this)};
D("X.cube",uf);D("X.cube.prototype.modified",uf.prototype.n);function je(a){he.call(this,a);this.c="interactor3D";this.Cj=t}F(je,he);je.prototype.Qc=function(a){je.s.Qc.call(this,a);var b=new fd;a.nc==r&&(a.nc=0);b.Qa=0>a.nc;b.Ha=q;this.dispatchEvent(b)};function vf(a){Q.call(this);this.c="array";this.v=[];this.af=a}F(vf,Q);vf.prototype.add=function(a){this.v.push(a);return q};vf.prototype.clear=function(){this.v.length=0};function wf(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);wf(a,b,d);for(wf(a,d,c);b<d;++b)if(0<a.af(a.v[b],a.v[d])){var e=a.v[b];a.v[b]=a.v[d];for(var f=a,g=d,h=c;g+1<h&&0>f.af(f.v[g+1],e);){var l=f,j=g+1,k=l.v[g];l.v[g]=l.v[j];l.v[j]=k;++g}f.v[g]=e}}}vf.prototype.sort=function(){wf(this,0,this.v.length)};function xf(a,b){of.call(this,a,b);this.c="camera2D"}F(xf,of);xf.prototype.rotate=function(a){a=xf.s.rotate.call(this,a);var b=new cd;0<a.x?b.le--:0>a.x&&b.le++;0<a.y?b.Zd++:0>a.y&&b.Zd--;this.dispatchEvent(b)};function yf(a,b){of.call(this,a,b);this.c="camera3D";this.cf=45;this.nf=H.d.Ce(H.d.Oc(),this.cf,a/b,1,1E4)}F(yf,of);yf.prototype.rotate=function(a){a=yf.s.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new H.g(this.p[1],this.p[5],this.p[9]),d=new H.g(this.p[0],this.p[4],this.p[8]);c.normalize();d.normalize();H.d.rotate(this.p,b,c.x,c.y,c.b);H.d.rotate(this.p,a,d.x,d.y,d.b)};yf.prototype.Ed=function(a,b){var c=yf.s.Ed.call(this,a,b);H.d.Tf(c,a,b,this.I);return c};
D("X.camera3D",yf);function zf(a){sb.call(this);this.cb=a;this.w=[]}F(zf,sb);var Af=[];function Bf(a,b,c,d,e){ha(c)||(Af[0]=c,c=Af);for(var f=0;f<c.length;f++){var g=O(b,c[f],d||a,e||t,a.cb||a);a.w.push(g)}}zf.prototype.Ne=function(){Eb(this.w,Wb);this.w.length=0};zf.prototype.handleEvent=function(){m(Error("EventHandler.handleEvent not implemented"))};function Cf(){}Cf.Ff=function(){return Cf.Nf?Cf.Nf:Cf.Nf=new Cf};Cf.prototype.Ch=0;Cf.Ff();function Df(a){sb.call(this);this.Bb=a||Cd();this.si=Ef}F(Df,bc);Df.prototype.nh=Cf.Ff();var Ef=r;w=Df.prototype;w.Mf=r;w.pc=t;w.r=r;w.si=r;w.Rc=r;w.Lc=r;w.te=r;w.l=u("r");w.Pe=function(a){this.Rc&&this.Rc!=a&&m(Error("Method not supported"));Df.s.Pe.call(this,a)};w.vd=u("Bb");w.lc=function(){this.r=this.Bb.createElement("div")};w.cc=function(a){this.Eb(a)};
w.Eb=function(a,b){this.pc&&m(Error("Component already rendered"));this.r||this.lc();a?a.insertBefore(this.r,b||r):this.Bb.N.body.appendChild(this.r);(!this.Rc||this.Rc.pc)&&this.rd()};w.rd=function(){function a(a){!a.pc&&a.l()&&a.rd()}this.pc=q;this.Lc&&Eb(this.Lc,a,n)};w.sd=function(){function a(a){a.pc&&a.sd()}this.Lc&&Eb(this.Lc,a,n);this.gh&&this.gh.Ne();this.pc=t};
w.removeChild=function(a,b){if(a){var c=la(a)?a:a.Mf||(a.Mf=":"+(a.nh.Ch++).toString(36)),d;this.te&&c?(d=this.te,d=(c in d?d[c]:n)||r):d=r;a=d;c&&a&&(d=this.te,c in d&&delete d[c],Hb(this.Lc,a),b&&(a.sd(),a.r&&Jd(a.r)),c=a,c==r&&m(Error("Unable to set parent component")),c.Rc=r,Df.s.Pe.call(c,r))}a||m(Error("Child is not in parent component"));return a};function Ff(){sb.call(this)}F(Ff,bc);w=Ff.prototype;w.Xe=0;w.Pc=0;w.De=100;w.Cf=0;w.Ue=1;w.uh=t;w.Bh=t;w.Md=function(a){a=Gf(this,a);this.Xe!=a&&(this.Xe=a+this.Cf>this.De?this.De-this.Cf:a<this.Pc?this.Pc:a,!this.uh&&!this.Bh&&this.dispatchEvent("change"))};w.yd=function(){return Gf(this,this.Xe)};w.xd=function(){return Gf(this,this.Pc)};w.wd=function(){return Gf(this,this.De)};function Gf(a,b){return a.Ue==r?b:a.Pc+Math.round((b-a.Pc)/a.Ue)*a.Ue};function Hf(a){Df.call(this,a);this.Tc=new Ff;O(this.Tc,"change",this.hh,t,this)}F(Hf,Df);var If={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=Hf.prototype;w.lc=function(){this.Ua=this.vd().lc("div","progress-bar-thumb");var a=If[this.dg];this.r=this.vd().lc("div",a,this.Ua);Kf(this);a=this.xd();this.l().setAttribute("aria-valuemin",a);a=this.wd();this.l().setAttribute("aria-valuemax",a)};
w.rd=function(){Hf.s.rd.call(this);L&&7>ib&&O(this.l(),"resize",this.Pd,t,this);this.Pd();var a=this.l();a.setAttribute("role","progressbar");a.setAttribute("aria-live","polite")};w.sd=function(){Hf.s.sd.call(this);L&&7>ib&&Vb(this.l(),"resize",this.Pd,t,this)};w.yd=function(){return this.Tc.yd()};w.Md=function(a){this.Tc.Md(a);this.l()&&Kf(this)};function Kf(a){var b=a.yd();a.l().setAttribute("aria-valuenow",b)}w.xd=function(){return this.Tc.xd()};w.wd=function(){return this.Tc.wd()};w.dg="horizontal";
w.hh=function(){this.Pd();this.dispatchEvent("change")};w.Pd=function(){if(this.Ua){var a=this.xd(),b=this.wd(),a=(this.yd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.dg?L&&7>ib?(this.Ua.style.top=0,this.Ua.style.height="100%",b=this.Ua.offsetHeight,a=Math.round(a*b),this.Ua.style.top=b-a+"px",this.Ua.style.height=a+"px"):(this.Ua.style.top=100-b+"%",this.Ua.style.height=b+"%"):this.Ua.style.width=b+"%"}};function Lf(a,b){a==r&&m(Error("No valid parent element."));b==r&&m(Error("Invalid initial value."));Hf.call(this);this.c="progressbar";this.ma=a;this.mf="";this.Xc=this.$a=r;this.Hb=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
d+="  overflow: hidden;\n";d+="  width: 0%;\n";d+="  height: 100%;\n";d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.Hb=[c,d,e];this.Md(b);this.ze()}F(Lf,Hf);
Lf.prototype.ze=function(){if("static"==this.ma.style.position||""==this.ma.style.position)this.mf=this.ma.style.position,this.ma.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Hd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.Hb[0])),d=document.createTextNode(String(this.Hb[1])),e=document.createTextNode(String(this.Hb[2]));a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.$a=b;this.cc(this.ma);a=this.l();a.style.position=
"absolute";a.style.top=(this.ma.clientHeight-5)/2+"px";a.style.left=(this.ma.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Mf(a){var b=a.l().style.top,c=a.l().style.left;Jd(a.l());var d=new Lf(a.ma,100),e=d.l();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=n?e.firstElementChild:Kd(e.firstChild)).classList.add("progress-bar-thumb-done");a.Xc=d}
Lf.prototype.Ad=function(){this.$a&&Jd(this.$a);this.l()&&Jd(this.l());this.Xc&&Jd(this.Xc.l());this.Xc=this.$a=r;this.ma.style.position=this.mf};function Nf(a,b,c){ma(a)?c&&(a=ua(a,c)):a&&"function"==typeof a.handleEvent?a=ua(a.handleEvent,a):m(Error("Invalid listener argument"));return 2147483647<b?-1:ca.setTimeout(a,b||0)};function Of(){Q.call(this);this.c="renderer";this.q=window.document.body;this.M=this.q.clientWidth;this.G=this.q.clientHeight;this.Kb=this.t=this.ga=r;this.Ya=new vf(Oc);this.Ra=[];this.C=r;this.de=this.ad=this.bd=t;this.a=this.na=r;this.F={PROGRESSBAR_ENABLED:q,INTERMEDIATE_RENDERING:t};this.Ze=-1;window.console.log("XTK release 9 -- 2013-02-11 11:21:47 -- http://www.goXTK.com -- @goXTK")}F(Of,Q);w=Of.prototype;w.Rh=function(a){this.na&&this.na.Md(100*a.sf)};
w.Hh=function(a){a!=r&&a instanceof Nc&&a.Y&&this.Va(a.Y)};w.Je=function(a){(a==r||!(a instanceof hd))&&m(Error("Invalid hover event."))};w.Sh=function(){var a=Fd(this.q);this.M=a.clientWidth;this.G=a.clientHeight;a=Fd(this.ga);a.width=this.M;a.height=this.G;"renderer3D"==this.c&&(this.a.viewport(0,0,this.M,this.G),this.t.nf=H.d.Ce(H.d.Oc(),this.t.cf,this.ga.width/this.ga.height,1,1E4));this.qc()};w.Ke=function(a){(a==r||!(a instanceof gd))&&m(Error("Invalid scroll event."))};
Of.prototype.__defineGetter__("config",u("F"));Of.prototype.__defineGetter__("interactor",u("Kb"));Of.prototype.__defineGetter__("camera",u("t"));Of.prototype.__defineGetter__("loadingCompleted",u("ad"));Of.prototype.__defineGetter__("container",u("q"));Of.prototype.__defineSetter__("container",function(a){a==r&&m(Error("An ID to a valid container (<div>..) is required."));var b=a;la(b)&&(b=Fd(a));na(b)&&1==b.nodeType||m(Error("Could not find the given container."));this.q=b});w=Of.prototype;
w.qc=function(){this.t.reset()};
w.ea=function(a){var b=Hd("canvas");this.q.appendChild(b);this.M=this.q.clientWidth;this.G=this.q.clientHeight;b.width=this.M;b.height=this.G;try{var c=b.getContext(a);c||m(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.q.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
m(Error(e))}this.C=new kf;O(this.C,$c,this.Rh.bind(this));this.ga=b;this.a=c;b=new je(this.ga);"2d"==a&&(b=new le(this.ga));b.ea();O(b,Xc,this.qc.bind(this));O(b,ad,this.Je.bind(this));O(b,Wc,this.Ke.bind(this));this.Kb=b;b=new yf(this.M,this.G);"2d"==a&&(b=new xf(this.M,this.G));b.observe(this.Kb);this.t=b;O(window,"resize",this.Sh,t,this)};w.add=function(a){(a instanceof uf||a instanceof sf||a instanceof qf)&&a.n();this.Ra.push(a);this.Va(a)};
w.Va=function(a){(!this.ga||!this.a)&&m(Error("The renderer was not initialized properly."));a==r&&(window.console.log(a),m(Error("Illegal object.")));var b;b=oa(a);var c=Ob[b];if(c){var d=ga(Zc),e=ga(n);d&&e?(c=Nb[Zc],b=!!c&&!!c[n]&&b in c[n]):b=!d&&!e?q:Gb(c,function(a){return d&&a.type==Zc||e&&a.capture==n})}else b=t;b||O(a,Zc,this.Hh.bind(this))};w.get=function(a){a==r&&m(Error("Invalid object id."));for(var b=this.Ya.v,c=b.length,d=0,d=0;d<c;d++)if(b[d].sa==a)return b[d];return r};
w.cc=function(){(!this.ga||!this.a)&&m(Error("The renderer was not initialized properly."));if(this.pf==r){if(tc(this.C.ic)){if(this.F.PROGRESSBAR_ENABLED&&!this.na&&(this.na=new Lf(this.q,3)),this.de=this.ad=t,this.pf=Nf(function(){this.pf=r;this.cc()}.bind(this),100),!this.F.INTERMEDIATE_RENDERING)return}else if(!this.ad&&!this.de&&(this.de=q,eval("this.onShowtime()"),this.ad=q),this.na){this.F.PROGRESSBAR_ENABLED&&(this.na&&!this.$e)&&(Mf(this.na),this.$e=Nf(function(){this.$e=r;this.na&&(this.na.Ad(),
this.na=r);this.cc()}.bind(this),700));return}this.Ze=window.requestAnimationFrame(this.cc.bind(this),this.ga);eval("this.onRender()");this.Eb(t,q)}};w.cg=aa();w.ag=aa();w.Eb=aa();
w.pd=function(){window.cancelAnimationFrame(this.Ze);this.C&&(delete this.C,this.C=r);this.na&&(this.na.Ad(),delete this.na,this.na=r);this.Ya.clear();delete this.Ya;this.Ra.length=0;delete this.Ra;delete this.C;this.C=r;delete this.t;this.t=r;delete this.Kb;this.Kb=r;delete this.a;this.a=r;Jd(this.ga);delete this.ga;this.ga=r};function Pf(){Q.call(this);this.c="shaders";this.kd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.kd=a+="}\n";this.Yc="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform float volumeLowerThreshold;\n";a+=
"uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";
a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";
a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="       if (labelmapOpacity < 1.0) {\n";
a+="         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="       } else {\n";a+="         textureSum = texture2;\n";a+="       }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold) {\n";a+="       discard;\n";
a+="     };\n";a+="   };\n";a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";
a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.Yc=a+="}\n"}
F(Pf,Q);
var Qf={pj:"vertexPosition",oj:"vertexNormal",nj:"vertexColor",rj:"vertexTexturePos",qj:"vertexScalar"},Rf={sj:"view",Xi:"perspective",Pi:"center",Wi:"objectTransform",jj:"useObjectColor",Ui:"objectColor",lj:"useScalars",fj:"scalarsReplaceMode",cj:"scalarsMin",$i:"scalarsMax",dj:"scalarsMinColor",aj:"scalarsMaxColor",ej:"scalarsMinThreshold",bj:"scalarsMaxThreshold",Zi:"scalarsInterpolation",Yi:"pointSize",Vi:"objectOpacity",Ti:"normal",kj:"usePicking",mj:"useTexture",ij:"useLabelMapTexture",Ri:"labelmapOpacity",
gj:"textureSampler",hj:"textureSampler2",tj:"volumeLowerThreshold",zj:"volumeUpperThreshold",wj:"volumeScalarMin",uj:"volumeScalarMax",xj:"volumeScalarMinColor",vj:"volumeScalarMaxColor",Bj:"volumeWindowLow",Aj:"volumeWindowHigh",yj:"volumeTexture"};function Sf(a,b,c){a==r&&m(Error("Invalid GL Buffer."));b==r&&m(Error("Invalid number of items."));c==r&&m(Error("Invalid item size."));Q.call(this);this.c="buffer";this.ha=a;this.nb=b;this.ob=c}F(Sf,Q);function Tf(a,b,c,d,e,f,g,h){var l,j;if(l=c.offsetParent){var k="HTML"==l.tagName||"BODY"==l.tagName;if(!k||"static"!=Pd(l,"position"))j=Ud(l),k||(k=(k=Vd(l))&&bb?-l.scrollLeft:k&&(!L||!pb("8"))&&"visible"!=Pd(l,"overflowX")?l.scrollWidth-l.clientWidth-l.scrollLeft:l.scrollLeft,j=vd(j,new ud(k,l.scrollTop)))}l=j||new ud;j=Ud(a);k=Xd(a);j=new yd(j.x,j.y,k.width,k.height);(k=Td(a))&&j.Of(new yd(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=Cd(a),p=Cd(c);if(k.N!=p.N){var s=k.N.body,p=p.N.parentWindow||
p.N.defaultView,v=new ud(0,0),z=Ed(s)?Ed(s).parentWindow||Ed(s).defaultView:window,A=s;do{var C;if(z==p)C=Ud(A);else{C=A;var E=new ud;if(1==C.nodeType){if(C.getBoundingClientRect){var x=Rd(C);E.x=x.left;E.y=x.top}else{var x=Nd(Cd(C)),B=Ud(C);E.x=B.x-x.x;E.y=B.y-x.y}bb&&!pb(12)&&(x=n,x=n,L?x="-ms-transform":db?x="-webkit-transform":ab?x="-o-transform":bb&&(x="-moz-transform"),B=n,x&&(B=Pd(C,x)),B||(B=Pd(C,"transform")),B?(C=B.match(de),x=!C?new ud(0,0):new ud(parseFloat(C[1]),parseFloat(C[2]))):x=
new ud(0,0),E=new ud(E.x+x.x,E.y+x.y))}else x=ma(C.dh),B=C,C.targetTouches?B=C.targetTouches[0]:x&&C.Ma.targetTouches&&(B=C.Ma.targetTouches[0]),E.x=B.clientX,E.y=B.clientY;C=E}v.x+=C.x;v.y+=C.y}while(z&&z!=p&&(A=z.frameElement)&&(z=z.parent));s=vd(v,Ud(s));L&&!Md(k)&&(s=vd(s,Nd(k)));j.left+=s.x;j.top+=s.y}a=(b&4&&Vd(a)?b^2:b)&-5;b=new ud(a&2?j.left+j.width:j.left,a&1?j.top+j.height:j.top);b=vd(b,l);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var G;if(g&&(G=Td(c)))G.top-=l.y,G.right-=l.x,G.bottom-=
l.y,G.left-=l.x;return Uf(b,c,d,f,G,g,h)}
function Uf(a,b,c,d,e,f,g){a=a.h();var h=0,l=(c&4&&Vd(b)?c^2:c)&-5;c=Xd(b);g=g?g.h():c.h();if(d||0!=l)l&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),l&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&(h.x+g.width>e.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y<=e.top&&(h.y+g.height<e.bottom&&f&32)&&(g.height=Math.max(g.height-(e.top-h.y),0),h.y=0,d|=8);h.y>=e.top&&(h.y+g.height>e.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=bb&&(Ta||gb)&&pb("1.9");f instanceof
ud?(a=f.x,f=f.y):(a=f,f=n);b.style.left=Wd(a,e);b.style.top=Wd(f,e);if(!(c==g||(!c||!g?0:c.width==g.width&&c.height==g.height)))a=Md(Cd(Ed(b))),L&&(!a||!pb("8"))?(c=b.style,a?(L?(a=ae(b,"paddingLeft"),e=ae(b,"paddingRight"),f=ae(b,"paddingTop"),d=ae(b,"paddingBottom"),a=new wd(f,e,d,a)):(a=Od(b,"paddingLeft"),e=Od(b,"paddingRight"),f=Od(b,"paddingTop"),d=Od(b,"paddingBottom"),a=new wd(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),L?(e=ce(b,"borderLeft"),f=ce(b,"borderRight"),d=ce(b,"borderTop"),
b=ce(b,"borderBottom"),b=new wd(d,f,b,e)):(e=Od(b,"borderLeftWidth"),f=Od(b,"borderRightWidth"),d=Od(b,"borderTopWidth"),b=Od(b,"borderBottomWidth"),b=new wd(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,bb?b.MozBoxSizing="border-box":db?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",
b.height=Math.max(g.height,0)+"px");return h};function Vf(){}Vf.prototype.Oa=aa();function Wf(a,b,c){this.element=a;this.zf=b;this.fi=c}F(Wf,Vf);Wf.prototype.Oa=function(a,b,c){Tf(this.element,this.zf,a,b,n,c,this.fi)};function Xf(a,b){sb.call(this);this.cb=new zf(this);this.Oe(a||r);b&&(this.rc=b)}F(Xf,bc);w=Xf.prototype;w.r=r;w.Gg=q;w.tf=r;w.oa=t;w.yi=t;w.Be=-1;w.Rf=-1;w.mh=t;w.Vg=q;w.rc="toggle_display";w.l=u("r");w.Oe=function(a){this.oa&&m(Error("Can not change this state of the popup while showing."));this.r=a};
function Yf(a,b){a.Od&&a.Od.stop();a.zd&&a.zd.stop();if(b){if(!a.oa&&a.He()){a.r||m(Error("Caller must call setElement before trying to show the popup"));a.Oa();var c=Ed(a.r);a.mh&&Bf(a.cb,c,"keydown",a.Fh,q);if(a.Gg)if(Bf(a.cb,c,"mousedown",a.Zf,q),L){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}Bf(a.cb,c,"mousedown",a.Zf,q);Bf(a.cb,c,"deactivate",a.Yf)}else Bf(a.cb,c,"blur",a.Yf);"toggle_display"==
a.rc?(a.r.style.visibility="visible",Zd(a.r,q)):"move_offscreen"==a.rc&&a.Oa();a.oa=q;a.Od?(Sb(a.Od,"end",a.bg,t,a),a.Od.play()):a.bg()}}else Zf(a)}w.Oa=ea;function Zf(a,b){if(!a.oa||!a.dispatchEvent({type:"beforehide",target:b}))return t;a.cb&&a.cb.Ne();a.oa=t;a.Rf=wa();a.zd?(Sb(a.zd,"end",va(a.yf,b),t,a),a.zd.play()):a.yf(b);return q}w.yf=function(a){"toggle_display"==this.rc?this.yi?Nf(this.Jf,0,this):this.Jf():"move_offscreen"==this.rc&&(this.r.style.top="-10000px");this.Ie(a)};
w.Jf=function(){this.r.style.visibility="hidden";Zd(this.r,t)};w.He=function(){return this.dispatchEvent("beforeshow")};w.bg=function(){this.Be=wa();this.Rf=-1;this.dispatchEvent("show")};w.Ie=function(a){this.dispatchEvent({type:"hide",target:a})};w.Zf=function(a){a=a.target;!Ld(this.r,a)&&((!this.tf||Ld(this.tf,a))&&!(150>wa()-this.Be))&&Zf(this,a)};w.Fh=function(a){27==a.keyCode&&Zf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
w.Yf=function(a){if(this.Vg){var b=Ed(this.r);if(L||ab){if(a=b.activeElement,!a||Ld(this.r,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>wa()-this.Be||Zf(this)}};function $f(a,b){this.ue=a instanceof ud?a:new ud(a,b)}F($f,Vf);$f.prototype.Oa=function(a,b,c,d){Tf(Qd(a),0,a,b,this.ue,c,r,d)};function ag(a,b){this.ii=4;this.Fd=b||n;Xf.call(this,a)}F(ag,Xf);ag.prototype.Oa=function(){if(this.Fd){var a=!this.oa&&"move_offscreen"!=this.rc,b=this.l();a&&(b.style.visibility="hidden",Zd(b,q));this.Fd.Oa(b,this.ii,this.Mj);a&&Zd(b,t)}};function bg(a){this.J=new rc;a&&this.me(a)}function cg(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+oa(a):b.substr(0,1)+a}w=bg.prototype;w.ud=function(){return this.J.ud()};w.add=function(a){this.J.set(cg(a),a)};w.me=function(a){a=qc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};w.Ne=function(a){a=qc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};w.remove=function(a){return this.J.remove(cg(a))};w.clear=function(){this.J.clear()};
w.contains=function(a){a=cg(a);return uc(this.J.J,a)};w.Of=function(a){var b=new bg;a=qc(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};w.bb=function(){return this.J.bb()};w.h=function(){return new bg(this)};function dg(a,b,c){this.Bb=c||(a?Cd(Fd(a)):Cd());ag.call(this,this.Bb.lc("div",{style:"position:absolute;display:none;"}));this.ve=new ud(1,1);this.qd=new bg;a&&eg(this,a);if(b!=r)if(a=this.l(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Ed(a).createTextNode(String(b)))}}F(dg,ag);var fg=[];w=dg.prototype;w.wa=r;w.className="goog-tooltip";
w.jg=500;w.lh=0;w.vd=u("Bb");function eg(a,b){b=Fd(b);a.qd.add(b);O(b,"mouseover",a.kh,t,a);O(b,"mouseout",a.Gf,t,a);O(b,"mousemove",a.jh,t,a);O(b,"focus",a.ih,t,a);O(b,"blur",a.Gf,t,a)}w.Oe=function(a){var b=this.l();b&&Jd(b);dg.s.Oe.call(this,a);a&&(b=this.Bb.N.body,b.insertBefore(a,b.lastChild))};
w.He=function(){if(!Xf.prototype.He.call(this))return t;if(this.anchor)for(var a,b=0;a=fg[b];b++)Ld(a.l(),this.anchor)||Yf(a,t);0<=Db(fg,this)||fg.push(this);a=this.l();a.className=this.className;gg(this);O(a,"mouseover",this.If,t,this);O(a,"mouseout",this.Hf,t,this);hg(this);return q};
w.Ie=function(){Hb(fg,this);for(var a=this.l(),b,c=0;b=fg[c];c++)b.anchor&&Ld(a,b.anchor)&&Yf(b,t);this.fg&&ig(this.fg);Vb(a,"mouseover",this.If,t,this);Vb(a,"mouseout",this.Hf,t,this);this.anchor=n;if(0==(this.gb?this.oa?4:1:this.oc?3:this.oa?2:0))this.Kd=t;Xf.prototype.Ie.call(this)};w.Wf=function(a,b){this.anchor==a&&this.qd.contains(this.anchor)&&(this.Kd||!this.Pj?(Yf(this,t),this.oa||(this.anchor=a,this.Fd=b||jg(this,0)||n,this.oa&&this.Oa(),Yf(this,q))):this.anchor=n);this.gb=n};
w.Ah=function(a){this.oc=n;a==this.anchor&&(this.wa==r||this.wa!=this.l()&&!this.qd.contains(this.wa))&&(!this.vf||!this.vf.wa)&&Yf(this,t)};function kg(a,b){var c=Nd(a.Bb);a.ve.x=b.clientX+c.x;a.ve.y=b.clientY+c.y}w.kh=function(a){var b=lg(this,a.target);this.wa=b;gg(this);b!=this.anchor&&(this.anchor=b,this.gb||(this.gb=Nf(ua(this.Wf,this,b,n),this.jg)),mg(this),kg(this,a))};function lg(a,b){try{for(;b&&!a.qd.contains(b);)b=b.parentNode;return b}catch(c){return r}}
w.jh=function(a){kg(this,a);this.Kd=q};w.ih=function(a){this.wa=a=lg(this,a.target);this.Kd=q;if(this.anchor!=a){this.anchor=a;var b=jg(this,1);gg(this);this.gb||(this.gb=Nf(ua(this.Wf,this,a,b),this.jg));mg(this)}};function jg(a,b){if(0==b){var c=a.ve.h();return new ng(c)}return new og(a.wa)}function mg(a){if(a.anchor)for(var b,c=0;b=fg[c];c++)Ld(b.l(),a.anchor)&&(b.vf=a,a.fg=b)}
w.Gf=function(a){var b=lg(this,a.target),c=lg(this,a.relatedTarget);b!=c&&(b==this.wa&&(this.wa=r),hg(this),this.Kd=t,this.oa&&(!a.relatedTarget||!Ld(this.l(),a.relatedTarget))?ig(this):this.anchor=n)};w.If=function(){var a=this.l();this.wa!=a&&(gg(this),this.wa=a)};w.Hf=function(a){var b=this.l();if(this.wa==b&&(!a.relatedTarget||!Ld(b,a.relatedTarget)))this.wa=r,ig(this)};function hg(a){a.gb&&(ca.clearTimeout(a.gb),a.gb=n)}
function ig(a){if(2==(a.gb?a.oa?4:1:a.oc?3:a.oa?2:0))a.oc=Nf(ua(a.Ah,a,a.anchor),a.lh)}function gg(a){a.oc&&(ca.clearTimeout(a.oc),a.oc=n)}function ng(a,b){$f.call(this,a,b)}F(ng,$f);ng.prototype.Oa=function(a,b,c){b=Qd(a);b=Td(b);c=c?new wd(c.top+10,c.right,c.bottom,c.left+10):new wd(10,0,0,10);Uf(this.ue,a,4,c,b,9)&496&&Uf(this.ue,a,4,c,b,5)};function og(a){Wf.call(this,a,3)}F(og,Wf);
og.prototype.Oa=function(a,b,c){var d=new ud(10,0);Tf(this.element,this.zf,a,b,d,c,9)&496&&Tf(this.element,2,a,1,d,c,5)};function qg(a,b,c,d){a==r&&m(Error("No valid parent element."));(!y(b)||!y(c))&&m(Error("Invalid coordinates."));(d==r||!(d instanceof he))&&m(Error("Invalid interactor."));dg.call(this);this.c="caption";this.ma=a;this.md=b;this.nd=c;this.Kb=d;this.$a=r;this.Hb=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.Hb=[a];Sb(d,bd,this.Ad.bind(this));this.ze()}F(qg,dg);
qg.prototype.ze=function(){if("static"==this.ma.style.position||""==this.ma.style.position)this.ma.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Hd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.Hb[0]));a.appendChild(b);b.appendChild(c);this.$a=b;this.Fd=new $f(this.md,this.nd)||n;this.oa&&this.Oa();Yf(this,q);eg(this,this.ma);this.l().classList.add("x-tooltip")};
qg.prototype.Ad=function(){Yf(this,t);this.$a&&Jd(this.$a);this.l()&&Jd(this.l());this.$a=r};function rg(){Of.call(this);this.c="renderer3D";this.Ac=this.Dc=this.zc=this.Cc=this.yc=this.Bc=this.fe=this.ge=r;this.k=[0,0,0];this.of=r;this.Qd=new rc;this.Gc=new rc;this.Jc=new rc;this.be=new rc;this.Wc=new rc;this.fd=new rc;this.gd=new rc;this.hd=new rc;this.F={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:t,INTERMEDIATE_RENDERING:t}}F(rg,Of);rg.prototype.__defineGetter__("config",u("F"));w=rg.prototype;
w.ri=function(){this.Ac=this.Dc=this.zc=this.Cc=this.yc=this.Bc=r;this.k=[0,0,0]};w.Je=function(a){rg.s.Je.call(this,a);var b=a.md;a=a.nd;var c=this.gg(b,a);if(c=this.get(c))if(c=c.fc)(new qg(this.q,this.q.offsetLeft+b+10,this.q.offsetTop+a+10,this.Kb)).l().innerHTML=c};
w.ea=function(){rg.s.ea.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.M,this.G),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.F.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.M,this.G,0,this.a.RGB,this.a.UNSIGNED_BYTE,r);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.M,this.G);this.a.bindRenderbuffer(this.a.RENDERBUFFER,r);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.of=a}}catch(d){m(Error("Exception while accessing GL Context!\n"+d))}a=new Pf;(this.ga==r||this.a==r||this.t==r)&&m(Error("Renderer was not initialized properly."));(a==r||!(a instanceof Pf))&&m(Error("Could not add shaders."));b=Object.keys(Rf);Object.keys(Qf).every(function(a){a=Qf[a];return-1!=this.kd.search(a)||-1!=this.Yc.search(a)}.bind(a))||m(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Rf[a];return-1!=
this.kd.search(a)||-1!=this.Yc.search(a)}.bind(a))||m(Error("Could not find all uniforms in the shader sources."));b=this.a.createShader(this.a.FRAGMENT_SHADER);c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.Yc);this.a.shaderSource(c,a.kd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||m(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||m(Error("Vertex Shader compilation failed!\n"+
this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c);this.a.attachShader(e,b);this.a.linkProgram(e);this.a.getProgramParameter(e,this.a.LINK_STATUS)||m(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e)));this.a.useProgram(e);this.fe=e;Object.keys(Qf).forEach(function(a){a=Qf[a];this.Qd.set(a,this.a.getAttribLocation(this.fe,a));this.a.enableVertexAttribArray(this.Qd.get(a))}.bind(this));
Object.keys(Rf).forEach(function(a){a=Rf[a];this.Gc.set(a,this.a.getUniformLocation(this.fe,a))}.bind(this));this.ge=a};
w.Va=function(a){rg.s.Va.call(this,a);var b=t;this.get(a.sa)&&(b=q);var c=a.sa,d=a.i,e=a.j,f=a.W,g=a.z,h=a.o,l=a.Wb,j=a.$,k=a.m,p=a.u;if(k!=r&&k.o!=r&&k.o.f)this.Va(k);else if(k!=r&&k.f&&this.Va(k),j!=r&&j.o!=r&&j.o.f)this.C.load(j,a);else if(g!=r&&g.o!=r&&g.o.f)this.C.load(g,a);else{if(h!=r&&ha(h))if(a.dc!=r){if(a.dc.Cd!=h.length||!a.f)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.C.load(h[b],a);return}else{if(h!=r&&h.f){this.C.load(a,a);return}if(p!=r&&p.o!=r&&p.o.f){this.C.load(p,a);return}}if(0<
a.e.length){h=a.e;j=h.length;for(k=k=0;k<j;k++)this.Va(h[k])}if(d){for(h=0;this.bd;)h++,window.console.log("Possible thread lock avoided: "+h);this.bd=q;j=a instanceof me&&a.ab instanceof oe;b&&(g!=r&&g.f)&&(h=this.gd.get(c),h!=r&&this.a.isBuffer(h.ha)&&this.a.deleteBuffer(h.ha));h=r;g!=r&&(!b||g.f?(h=a.Vb,h==r&&m(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=t,g.va&&(k=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),k=this.a.createTexture(),
k.oh=g.jb,this.hd.set(g.sa,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.va?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.xb,g.wb,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.va):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.oh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),j?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,r),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Sf(k,h.length,2),g.f=t):h=this.gd.get(c));lf(this.C,0.1);if(j)this.bd=
t,H.qa(this.c+".update"),lf(this.C,0.9);else{if(!b||d.f||l.f){j=l.ia;g=H.d.Na(j,d.Ob,d.Pb,d.Qb);j=H.d.Na(j,d.Lb,d.Mb,d.Nb);if(this.Bc===r||g.x<this.Bc)this.Bc=g.x;if(this.yc===r||j.x>this.yc)this.yc=j.x;if(this.Cc===r||g.y<this.Cc)this.Cc=g.y;if(this.zc===r||j.y>this.zc)this.zc=j.y;if(this.Dc===r||g.b<this.Dc)this.Dc=g.b;if(this.Ac===r||j.b>this.Ac)this.Ac=j.b;this.k=[(this.Bc+this.yc)/2,(this.Cc+this.zc)/2,(this.Dc+this.Ac)/2];l.f=t}b&&d.f&&(l=this.Jc.get(c),l!=r&&this.a.isBuffer(l.ha)&&this.a.deleteBuffer(l.ha));
l=r;!b||d.f?(l=this.a.createBuffer(),d.fb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,l),this.a.bufferData(this.a.ARRAY_BUFFER,d.L,this.a.STATIC_DRAW),l=new Sf(l,d.count,3),d.f=t):l=this.Jc.get(c);lf(this.C,0.3);b&&e.f&&(g=this.Jc.get(c),g!=r&&this.a.isBuffer(g.ha)&&this.a.deleteBuffer(g.ha));g=r;!b||e.f?(g=this.a.createBuffer(),e.fb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.L,this.a.STATIC_DRAW),g=new Sf(g,e.count,3),e.f=t):g=this.be.get(c);lf(this.C,0.3);b&&
(f&&f.f)&&(e=this.Wc.get(c),e!=r&&this.a.isBuffer(e.ha)&&this.a.deleteBuffer(e.ha));e=r;f&&(!b||f.f?(f.length!=d.length&&m(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.fb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.L,this.a.STATIC_DRAW),e=new Sf(e,f.count,3),f.f=t):e=this.Wc.get(c));lf(this.C,0.2);b&&(p&&p.f)&&(f=this.fd.get(c),f!=r&&this.a.isBuffer(f.ha)&&this.a.deleteBuffer(f.ha));f=r;p&&(f=p.sc,!b||p.f?(f.length!=d.length&&
m(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Sf(d,f.length,3),p.f=t):f=this.fd.get(c));lf(this.C,0.1);b||this.Ya.add(a);this.Jc.set(c,l);this.be.set(c,g);this.Wc.set(c,e);this.gd.set(c,h);this.fd.set(c,f);this.bd=a.f=t}}else a.f=t}};
function sg(a,b){var c=b.i.Vc,c=H.d.Na(b.Wb.ia,c[0],c[1],c[2]),c=H.d.Na(a.t.p,c.x,c.y,c.b),c=H.g.Ab(a.t.ua,c);return Math.round(1E3*c)/1E3}w.gg=function(a,b){if(this.F.PICKING_ENABLED){this.Eb(q,t);var c=new Uint8Array(4);this.a.readPixels(a,this.G-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
w.Eb=function(a,b){rg.s.Eb.call(this,a,b);var c=this.Ya.v,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.of):this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.a.viewport(0,0,this.M,this.G);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.t.nf,f=this.t.p;this.a.uniformMatrix4fv(this.Gc.get("perspective"),t,e);this.a.uniformMatrix4fv(this.Gc.get("view"),t,f);e=this.k;this.a.uniform3f(this.Gc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.Ra.length;for(e=0;e<f;++e){var g=this.Ra[e];if(g instanceof R){var h=H.d.Na(this.t.p,1,0,0),l=H.g.Ab(this.t.ua,h),h=H.d.Na(this.t.p,-1,0,0),j=H.g.Ab(this.t.ua,h),h=H.d.Na(this.t.p,0,1,0),k=H.g.Ab(this.t.ua,h),h=H.d.Na(this.t.p,0,-1,0),p=H.g.Ab(this.t.ua,h),h=H.d.Na(this.t.p,0,0,1),s=H.g.Ab(this.t.ua,h),h=H.d.Na(this.t.p,0,0,-1),h=H.g.Ab(this.t.ua,h),v=Math.max(l,k,s,j,p,h);v==l||v==j?ne(g,0):v==k||v==p?ne(g,1):(v==s||v==h)&&ne(g,2)}}if(this.F.ORDERING_ENABLED){l=t;f=this.Ra;g=f.length-1;do if(e=
f[g],e instanceof R&&e.Ka){j=e.zb;l=e.Q.e;1==j?l=e.R.e:2==j&&(l=e.Za.e);j=l.length;k=l[0];k.K=sg(this,k);k.Z=e.Z;p=l[j-1];p.K=sg(this,p);p.Z=e.Z;p=Math.round(1E3*((p.K-k.K)/j))/1E3;for(s=s=1;s<j-1;s++)h=Math.round(1E3*(k.K+s*p))/1E3,l[s].K=h,l[s].Z=e.Z;l=q}while(g--);f=this.Ya.v;g=f.length-1;do if(e=f[g],e.Ja&&!(1==e.Z||e instanceof me))e.K=sg(this,e),l=q;while(g--);l&&this.Ya.sort()}if(f=!a&&b!=r&&b&&this.F.STATISTICS_ENABLED)var z=0,A=0,C=0,E=0;var e=this.Qd,g=e.get("vertexPosition"),l=e.get("vertexNormal"),
j=e.get("vertexColor"),k=e.get("vertexTexturePos"),p=e.get("vertexScalar"),e=this.Gc,s=e.get("usePicking"),h=e.get("useObjectColor"),v=e.get("objectColor"),x=e.get("useScalars"),B=e.get("scalarsReplaceMode"),G=e.get("scalarsMin"),I=e.get("scalarsMax"),N=e.get("scalarsMinColor"),J=e.get("scalarsMaxColor"),K=e.get("scalarsInterpolation"),P=e.get("scalarsMinThreshold"),V=e.get("scalarsMaxThreshold"),T=e.get("objectOpacity"),ia=e.get("labelmapOpacity"),ka=e.get("useTexture"),M=e.get("useLabelMapTexture"),
Tb=e.get("textureSampler"),Ub=e.get("textureSampler2"),wg=e.get("volumeLowerThreshold"),xg=e.get("volumeUpperThreshold"),yg=e.get("volumeScalarMin"),zg=e.get("volumeScalarMax"),Ag=e.get("volumeWindowLow"),Bg=e.get("volumeWindowHigh"),Cg=e.get("volumeScalarMinColor"),Dg=e.get("volumeScalarMaxColor"),Jf=e.get("volumeTexture"),Eg=e.get("objectTransform"),Fg=e.get("pointSize"),e=d;do{var Z=c[d-e];if(Z){var da=r;Z instanceof me&&Z.ab&&(da=Z.ab);if(Z.Ja&&(!da||da.Ja)){var ta=Z.sa,Ua=Z.xc,Da=this.Jc.get(ta),
cb=this.be.get(ta),se=this.Wc.get(ta),Mb=this.fd.get(ta),te=this.gd.get(ta);this.a.bindBuffer(this.a.ARRAY_BUFFER,Da.ha);this.a.vertexAttribPointer(g,Da.ob,this.a.FLOAT,t,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,cb.ha);this.a.vertexAttribPointer(l,cb.ob,this.a.FLOAT,t,0,0);a?this.a.uniform1i(s,q):this.a.uniform1i(s,t);se&&!a&&!Ua?(this.a.uniform1i(h,t),this.a.bindBuffer(this.a.ARRAY_BUFFER,se.ha),this.a.vertexAttribPointer(j,se.ob,this.a.FLOAT,t,0,0)):(cb=1,Ua&&!a&&(cb=0),this.a.uniform1i(h,cb),
cb=Z.Gb,a&&(cb=[Math.floor(ta%65025%255)/255,Math.floor(ta%65025/255)/255,Math.floor(ta/65025)/255]),this.a.uniform3f(v,parseFloat(cb[0]),parseFloat(cb[1]),parseFloat(cb[2])),this.a.vertexAttribPointer(j,Da.ob,this.a.FLOAT,t,0,0));Mb&&!a&&!Ua?(this.a.uniform1i(x,q),this.a.uniform1i(B,Z.u.qf),ta=Z.u.sb,Ua=Z.u.qb,this.a.uniform3f(N,parseFloat(ta[0]),parseFloat(ta[1]),parseFloat(ta[2])),this.a.uniform3f(J,parseFloat(Ua[0]),parseFloat(Ua[1]),parseFloat(Ua[2])),this.a.uniform1f(P,parseFloat(Z.u.P)),this.a.uniform1f(V,
parseFloat(Z.u.S)),this.a.uniform1f(G,parseFloat(Z.u.Ia)),this.a.uniform1f(I,parseFloat(Z.u.Fa)),this.a.uniform1i(K,parseInt(Z.u.Td,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Mb.ha),this.a.vertexAttribPointer(p,Mb.ob,this.a.FLOAT,t,0,0)):(this.a.uniform1i(x,t),this.a.vertexAttribPointer(p,Da.ob,this.a.FLOAT,t,0,0));this.a.uniform1f(T,parseFloat(Z.Z));Z.z&&te&&!a?(this.a.uniform1i(ka,q),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.hd.get(Z.z.sa)),this.a.uniform1i(Tb,
0),this.a.bindBuffer(this.a.ARRAY_BUFFER,te.ha),this.a.vertexAttribPointer(k,te.ob,this.a.FLOAT,t,0,0),this.a.uniform1i(Jf,t)):(this.a.uniform1i(ka,t),this.a.vertexAttribPointer(k,Da.ob,this.a.FLOAT,t,0,0));da&&(this.a.uniform1i(Jf,q),this.a.uniform1f(wg,da.P),this.a.uniform1f(xg,da.S),this.a.uniform1f(yg,da.Ia),this.a.uniform1f(zg,da.Fa),ta=da.sb,Ua=da.qb,this.a.uniform3f(Cg,parseFloat(ta[0]),parseFloat(ta[1]),parseFloat(ta[2])),this.a.uniform3f(Dg,parseFloat(Ua[0]),parseFloat(Ua[1]),parseFloat(Ua[2])),
this.a.uniform1f(Ag,da.U),this.a.uniform1f(Bg,da.T),Mb=da.m,this.a.uniform1i(M,t),da.Ka?this.a.uniform1f(T,parseFloat(da.Z)):Mb&&Mb.Ja&&(da=Z.m.sa,this.a.uniform1i(M,q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.hd.get(da)),this.a.uniform1i(Ub,1),this.a.uniform1f(ia,Mb.Z)));this.a.uniformMatrix4fv(Eg,t,Z.Wb.ia);da=1;"POINTS"==Z.ja&&(da=Z.Ec);this.a.uniform1f(Fg,da);da=-1;Z.ja==Kc?(da=this.a.TRIANGLES,f&&(A+=Da.nb/3)):"LINES"==Z.ja?(this.a.lineWidth(Z.jc),da=this.a.LINES,
f&&(C+=Da.nb/2)):"POINTS"==Z.ja?(da=this.a.POINTS,f&&(E+=Da.nb)):"TRIANGLE_STRIPS"==Z.ja?(da=this.a.TRIANGLE_STRIP,f&&(A+=Da.nb/3)):"POLYGONS"==Z.ja&&(da=0==Da.nb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(A+=Da.nb/3));f&&(z+=Da.nb);this.a.drawArrays(da,0,Da.nb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+z+" | "),c+="Triangles: "+Math.round(A)+" | ",c+="Lines: "+C+" | ",c+="Points: "+E+" | ",c+="Textures: "+this.hd.ud(),window.console.log(c))}};
w.pd=function(){this.ge=r;delete this.ge;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);rg.s.pd.call(this)};D("X.renderer3D",rg);D("X.renderer3D.prototype.init",rg.prototype.ea);D("X.renderer3D.prototype.add",rg.prototype.add);D("X.renderer3D.prototype.onShowtime",rg.prototype.cg);D("X.renderer3D.prototype.onRender",rg.prototype.ag);D("X.renderer3D.prototype.get",rg.prototype.get);D("X.renderer3D.prototype.render",rg.prototype.cc);D("X.renderer3D.prototype.destroy",rg.prototype.pd);
D("X.renderer3D.prototype.resetBoundingBox",rg.prototype.ri);D("X.renderer3D.prototype.resetViewAndRender",rg.prototype.qc);D("X.renderer3D.prototype.pick",rg.prototype.gg);function tg(){Of.call(this);this.c="renderer2D";this.ff=this.Ud=this.df=this.Sd=this.tb=r;this.ed=this.Sb=this.Tb=this.he=this.ie=0;this.T=this.U=this.S=this.P=this.bf=-1}F(tg,Of);tg.prototype.Uh=aa();tg.prototype.ci=aa();tg.prototype.Ke=function(a){tg.s.Ke.call(this,a);var b=this.Ra[0];if(b){var c=this.tb;b["index"+c]=a.I?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
tg.prototype.di=function(a){var b=this.Ra[0];if(b){var c=b.T-b.U,d=c/2,e=parseInt(c+c/15*-a.le,10);a=parseInt(d+d/15*a.Zd,10);c==e&&e++;d==a&&a++;b.U-=parseInt(d-a,10);b.U-=parseInt(c-e,10);b.U=Math.max(b.U,b.Ia);b.T-=parseInt(d-a,10);b.T+=parseInt(c-e,10);b.T=Math.min(b.T,b.Fa);eval("this.onWindowLevel();")}};tg.prototype.__defineGetter__("orientation",u("tb"));
tg.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&("Y"!=a&&"Z"!=a)&&m(Error("Invalid orientation."));this.tb=a});w=tg.prototype;w.ea=function(){this.tb||m(Error("No 2D orientation set."));tg.s.ea.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ga.width,this.ga.height);this.Sd=Hd("canvas");this.Ud=Hd("canvas");O(this.t,Yc,this.di.bind(this))};w.rotate=function(){this.ed++};w.ti=function(){this.ed--};
w.qc=function(){tg.s.qc.call(this);ug(this);var a=this.Ra[0];a&&(a.T=a.Fa,a.U=a.Ia)};
w.Va=function(a){tg.s.Va.call(this,a);var b=t;this.get(a.sa)&&(b=q);if(a instanceof R){var c=a.o,d=a.m,e=a.$;if(d!=r&&d.o!=r&&d.o.f)this.Va(d);else if(e!=r&&e.o!=r&&e.o.f)this.C.load(e,a);else{if(c!=r&&ha(c))if(a.dc!=r){if(a.dc.Cd!=c.length||b&&!a.f)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.C.load(c[b],a);return}else if(c!=r&&c.f){this.C.load(a,a);return}var d=c=0,e=a.aa,f=a.H;"X"==this.tb?(this.Ub=a.Q.e,c=e[1],d=e[2],this.Tb=f[1],this.Sb=f[2]):"Y"==this.tb?(this.Ub=a.R.e,c=e[0],d=e[2],this.Tb=
f[0],this.Sb=f[2]):"Z"==this.tb&&(this.Ub=a.Za.e,c=e[0],d=e[1],this.Tb=f[0],this.Sb=f[1]);this.ie=c;this.he=d;e=this.Sd;e.width=c;e.height=d;f=this.Ud;f.width=c;f.height=d;this.df=e.getContext("2d");this.ff=f.getContext("2d");b||(this.Ya.add(a),ug(this))}}};function ug(a){var b=Math.min(a.M/(a.ie*a.Tb),a.G/(a.he*a.Sb));a.t.p[14]=b}
w.Eb=function(a,b){tg.s.Eb.call(this,a,b);if(0!=this.Ya.v.length){var c=this.M,d=this.G,e=this.t.p;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e[12],g=-1*e[13],h=Math.max(e[14],0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.Ra[0],l=e["index"+this.tb],j=this.Ub[parseInt(l,10)],k=j.z.va,j=j.m,p=r;j&&(p=j.va);var s=this.ie,v=this.he,z=this.df,A=this.ff,C=z.getImageData(0,0,s,v),E=A.getImageData(0,0,s,v),x=C.data,B=E.data,G=x.length,I=e.Fa,N=e.P,J=e.S,K=e.U/I,P=e.T/I;if(this.bf!=
l||this.P!=N||this.S!=J||this.U!=K||this.T!=P){var V=0;do{var T=[0,0,0,0],ia=[0,0,0,0],ka=k[V]/255*I,M=k[V],M=(M/255-K)/(P-K),M=255*M;ka>=N&&ka<=J&&(T=new S(e.sb[0],e.sb[1],e.sb[2]),T=(new S(e.qb[0],e.qb[1],e.qb[2])).scale(M).add(T.scale(255-M)),T=[Math.floor(T.x),Math.floor(T.y),Math.floor(T.b),255],j&&(ia=[p[V],p[V+1],p[V+2],p[V+3]]));M=G-1-V;x[M-3]=T[0];x[M-2]=T[1];x[M-1]=T[2];x[M]=T[3];B[M-3]=ia[0];B[M-2]=ia[1];B[M-1]=ia[2];B[M]=ia[3];V+=4}while(V<G);z.putImageData(C,0,0);A.putImageData(E,0,0);
this.bf=l;this.P=N;this.S=J;this.U=K;this.T=P}this.a.globalAlpha=1;this.a.translate(c/2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.ed);switch(this.ed%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-s*this.Tb/2+f;g=-v*this.Sb/2+g;this.a.drawImage(this.Sd,f,g,s*this.Tb,v*this.Sb);j&&e.m.Ja&&(this.a.globalAlpha=e.m.Z,this.a.drawImage(this.Ud,f,g,s*this.Tb,v*this.Sb))}};D("X.renderer2D",tg);D("X.renderer2D.prototype.init",tg.prototype.ea);D("X.renderer2D.prototype.add",tg.prototype.add);
D("X.renderer2D.prototype.onShowtime",tg.prototype.cg);D("X.renderer2D.prototype.onRender",tg.prototype.ag);D("X.renderer2D.prototype.onScroll",tg.prototype.Uh);D("X.renderer2D.prototype.onWindowLevel",tg.prototype.ci);D("X.renderer2D.prototype.get",tg.prototype.get);D("X.renderer2D.prototype.rotate",tg.prototype.rotate);D("X.renderer2D.prototype.rotateCounter",tg.prototype.ti);D("X.renderer2D.prototype.resetViewAndRender",tg.prototype.qc);D("X.renderer2D.prototype.render",tg.prototype.cc);
D("X.renderer2D.prototype.destroy",tg.prototype.pd);function vg(){W.call(this);this.c="fibers";Ea(this,new pc)}F(vg,W);D("X.fibers",vg);function Gg(){W.call(this);this.c="mesh";Ea(this,new pc)}F(Gg,W);D("X.mesh",Gg);
