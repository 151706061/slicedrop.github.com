/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function n(a){throw a;}var p=void 0,q=!0,t=null,u=!1;function da(){return function(){}}function ea(a){return function(b){this[a]=b}}function v(a){return function(){return this[a]}}var w,fa=this;function ga(){}
function ha(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==p}function ja(a){return"array"==ha(a)}function la(a){var b=ha(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ma(a){return"string"==typeof a}function x(a){return"number"==typeof a}function na(a){return"function"==ha(a)}function oa(a){var b=typeof a;return"object"==b&&a!=t||"function"==b}function pa(a){return a[qa]||(a[qa]=++ra)}var qa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;
function sa(a,b,c){return a.call.apply(a.bind,arguments)}function ta(a,b,c){a||n(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){ua=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sa:ta;return ua.apply(t,arguments)}
function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var wa=Date.now||function(){return+new Date};function B(a,b){var c=a.split("."),d=fa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ia(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function C(a,b){function c(){}c.prototype=b.prototype;a.A=b.prototype;a.prototype=new c;a.prototype.constructor=a};function xa(a,b,c){this.Va=this.Ua=this.Ta=0;3==arguments.length?(this.Ta=Number(a),this.Ua=Number(b),this.Va=Number(c)):a instanceof xa?(this.Ta=Number(a.x()),this.Ua=Number(a.y()),this.Va=Number(a.d())):(this.Ta=Number(a[0]),this.Ua=Number(a[1]),this.Va=Number(a[2]))}
xa.prototype={l:function(){return new xa(this.Ta,this.Ua,this.Va)},Zb:function(a){return this.Ta*a.x()+this.Ua*a.y()+this.Va*a.d()},oe:function(a,b){return ya(this,Aa(Ba(a,this),b))},length:function(){return Math.sqrt(this.Zb(this))},kc:function(a){return new xa(this.Ua*a.d()-this.Va*a.y(),this.Va*a.x()-this.Ta*a.d(),this.Ta*a.y()-this.Ua*a.x())},x:v("Ta"),y:v("Ua"),d:v("Va")};function Ca(a){var b=a.length();return new xa(a.Ta/b,a.Ua/b,a.Va/b)}
function Aa(a,b){return new xa(a.Ta*b,a.Ua*b,a.Va*b)}function Ba(a,b){return new xa(a.Ta-b.x(),a.Ua-b.y(),a.Va-b.d())}function ya(a,b){return new xa(a.Ta+b.x(),a.Ua+b.y(),a.Va+b.d())}function Da(a){return new xa(-a.Ta,-a.Ua,-a.Va)};var D=D||{};D.Xj=q;D.$a=function(a){eval("X.DEV === undefined")||window.console.time(a)};D.Wa=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Nh=0;this.Tj=function(){return this.Nh++}};function Fa(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);c in a||(d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c])}}var Ga=window.Ch;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&n(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ha=0,Ia=["ms","moz","webkit","o"],Ja=0;Ja<Ia.length&&!window.requestAnimationFrame;++Ja)window.requestAnimationFrame=window[Ia[Ja]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ia[Ja]+"CancelAnimationFrame"]||window[Ia[Ja]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ha)),d=window.setTimeout(function(){a(b+c)},c);Ha=b+c;return d});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===p&&n(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});B("$",Ga);B("Function.prototype.bind",Function.prototype.bind);
B("window.requestAnimationFrame",window.requestAnimationFrame);B("window.cancelAnimationFrame",window.cancelAnimationFrame);var Ka=0;function La(){}w=La.prototype;w.key=0;w.oc=u;w.ce=u;w.wa=function(a,b,c,d,e,f){na(a)?this.Qg=q:a&&a.handleEvent&&na(a.handleEvent)?this.Qg=u:n(Error("Invalid listener argument"));this.$b=a;this.ih=b;this.src=c;this.type=d;this.capture=!!e;this.mf=f;this.ce=u;this.key=++Ka;this.oc=u};w.handleEvent=function(a){return this.Qg?this.$b.call(this.mf||this.src,a):this.$b.handleEvent.call(this.$b,a)};function Ma(a,b){for(var c in a)b.call(p,a[c],c,a)}function Na(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}var Oa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Oa.length;f++)c=Oa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Ra(a){if(!Sa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ta,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ua,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Va,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Wa,"&quot;"));return a}var Ta=/&/g,Ua=/</g,Va=/>/g,Wa=/\"/g,Sa=/[&<>\"]/;var Xa,Ya,Za,$a,ab,bb,cb;function eb(){return fa.navigator?fa.navigator.userAgent:t}function fb(){return fa.navigator}$a=Za=Ya=Xa=u;var gb;if(gb=eb()){var hb=fb();Xa=0==gb.indexOf("Opera");Ya=!Xa&&-1!=gb.indexOf("MSIE");Za=!Xa&&-1!=gb.indexOf("WebKit");$a=!Xa&&!Za&&"Gecko"==hb.product}var ib=Xa,J=Ya,kb=$a,lb=Za,mb,ob=fb();mb=ob&&ob.platform||"";ab=-1!=mb.indexOf("Mac");bb=-1!=mb.indexOf("Win");cb=-1!=mb.indexOf("Linux");var pb=!!fb()&&-1!=(fb().appVersion||"").indexOf("X11");
function tb(){var a=fa.document;return a?a.documentMode:p}var ub;a:{var vb="",wb;if(ib&&fa.opera)var xb=fa.opera.version,vb="function"==typeof xb?xb():xb;else if(kb?wb=/rv\:([^\);]+)(\)|;)/:J?wb=/MSIE\s+([^\);]+)(\)|;)/:lb&&(wb=/WebKit\/(\S+)/),wb)var yb=wb.exec(eb()),vb=yb?yb[1]:"";if(J){var zb=tb();if(zb>parseFloat(vb)){ub=String(zb);break a}}ub=vb}var Ab={};
function Bb(a){var b;if(!(b=Ab[a])){b=0;for(var c=String(ub).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",m=RegExp("(\\d*)(\\D*)","g"),j=RegExp("(\\d*)(\\D*)","g");do{var k=m.exec(g)||["","",""],l=j.exec(h)||["","",""];if(0==k[0].length&&0==l[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==l[1].length?0:parseInt(l[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==l[1].length?0:parseInt(l[1],10))?1:0)||((0==k[2].length)<(0==l[2].length)?-1:(0==k[2].length)>(0==l[2].length)?1:0)||(k[2]<l[2]?-1:k[2]>l[2]?1:0)}while(0==b)}b=Ab[a]=0<=b}return b}var Cb=fa.document,Db=!Cb||!J?p:tb()||("CSS1Compat"==Cb.compatMode?parseInt(ub,10):5);var Eb=!J||J&&9<=Db,Fb=J&&!Bb("9");!lb||Bb("528");kb&&Bb("1.9b")||J&&Bb("8")||ib&&Bb("9.5")||lb&&Bb("528");kb&&!Bb("8")||J&&Bb("9");var Gb=Array.prototype,Hb=Gb.indexOf?function(a,b,c){return Gb.indexOf.call(a,b,c)}:function(a,b,c){c=c==t?0:0>c?Math.max(0,a.length+c):c;if(ma(a))return!ma(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ib=Gb.forEach?function(a,b,c){Gb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Jb=Gb.map?function(a,b,c){return Gb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ma(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Lb=Gb.some?function(a,b,c){return Gb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return q;return u};function Mb(a,b){var c=Hb(a,b);0<=c&&Gb.splice.call(a,c,1)}function Nb(a,b,c){return 2>=arguments.length?Gb.slice.call(a,b):Gb.slice.call(a,b,c)};function Ob(){0!=Pb&&(this.Xk=Error().stack,pa(this))}var Pb=0;function Qb(a,b){this.type=a;this.currentTarget=this.target=b}w=Qb.prototype;w.nc=u;w.defaultPrevented=u;w.te=q;w.stopPropagation=function(){this.nc=q};w.preventDefault=function(){this.defaultPrevented=q;this.te=u};function Rb(a){Rb[" "](a);return a}Rb[" "]=ga;function Sb(a,b){a&&this.wa(a,b)}C(Sb,Qb);w=Sb.prototype;w.target=t;w.relatedTarget=t;w.offsetX=0;w.offsetY=0;w.clientX=0;w.clientY=0;w.screenX=0;w.screenY=0;w.button=0;w.keyCode=0;w.charCode=0;w.ctrlKey=u;w.altKey=u;w.shiftKey=u;w.metaKey=u;w.Aj=u;w.lb=t;
w.wa=function(a,b){var c=this.type=a.type;Qb.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(kb){var e;a:{try{Rb(d.nodeName);e=q;break a}catch(f){}e=u}e||(d=t)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=lb||a.offsetX!==p?a.offsetX:a.layerX;this.offsetY=lb||a.offsetY!==p?a.offsetY:a.layerY;this.clientX=a.clientX!==p?a.clientX:a.pageX;this.clientY=a.clientY!==p?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Aj=ab?a.metaKey:a.ctrlKey;this.state=a.state;this.lb=a;a.defaultPrevented&&this.preventDefault();delete this.nc};w.stopPropagation=function(){Sb.A.stopPropagation.call(this);this.lb.stopPropagation?this.lb.stopPropagation():this.lb.cancelBubble=q};
w.preventDefault=function(){Sb.A.preventDefault.call(this);var a=this.lb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=u,Fb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};w.ui=v("lb");var Tb={},Ub={},Vb={},Wb={};function N(a,b,c,d,e){if(ja(b)){for(var f=0;f<b.length;f++)N(a,b[f],c,d,e);return t}a=Xb(a,b,c,u,d,e);b=a.key;Tb[b]=a;return b}
function Xb(a,b,c,d,e,f){b||n(Error("Invalid event type"));e=!!e;var g=Ub;b in g||(g[b]={la:0,Ka:0});g=g[b];e in g||(g[e]={la:0,Ka:0},g.la++);var g=g[e],h=pa(a),m;g.Ka++;if(g[h]){m=g[h];for(var j=0;j<m.length;j++)if(g=m[j],g.$b==c&&g.mf==f){if(g.oc)break;d||(m[j].ce=u);return m[j]}}else m=g[h]=[],g.la++;var k=Yb,l=Eb?function(a){return k.call(l.src,l.$b,a)}:function(a){a=k.call(l.src,l.$b,a);if(!a)return a},j=l,g=new La;g.wa(c,j,a,b,e,f);g.ce=d;j.src=a;j.$b=g;m.push(g);Vb[h]||(Vb[h]=[]);Vb[h].push(g);
a.addEventListener?(a==fa||!a.customEvent_)&&a.addEventListener(b,j,e):a.attachEvent(b in Wb?Wb[b]:Wb[b]="on"+b,j);return g}function Zb(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)Zb(a,b[f],c,d,e);else a=Xb(a,b,c,q,d,e),Tb[a.key]=a}function $b(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)$b(a,b[f],c,d,e);else{d=!!d;a:{f=Ub;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=t}if(a)for(f=0;f<a.length;f++)if(a[f].$b==c&&a[f].capture==d&&a[f].mf==e){ac(a[f].key);break}}}
function ac(a){var b=Tb[a];if(!b||b.oc)return u;var c=b.src,d=b.type,e=b.ih,f=b.capture;c.removeEventListener?(c==fa||!c.customEvent_)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Wb?Wb[d]:Wb[d]="on"+d,e);c=pa(c);Vb[c]&&(e=Vb[c],Mb(e,b),0==e.length&&delete Vb[c]);b.oc=q;if(b=Ub[d][f][c])b.Yg=q,bc(d,f,c,b);delete Tb[a];return q}
function bc(a,b,c,d){if(!d.qe&&d.Yg){for(var e=0,f=0;e<d.length;e++)d[e].oc?d[e].ih.src=t:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Yg=u;0==f&&(delete Ub[a][b][c],Ub[a][b].la--,0==Ub[a][b].la&&(delete Ub[a][b],Ub[a].la--),0==Ub[a].la&&delete Ub[a])}}function cc(a,b){var c=pa(a),d=Vb[c];if(d){var e=ia(b),f=ia(p);return e&&f?(d=Ub[b],!!d&&!!d[p]&&c in d[p]):!e&&!f?q:Lb(d,function(a){return e&&a.type==b||f&&a.capture==p})}return u}
function dc(a,b,c,d,e){var f=1;b=pa(b);if(a[b]){var g=--a.Ka,h=a[b];h.qe?h.qe++:h.qe=1;try{for(var m=h.length,j=0;j<m;j++){var k=h[j];k&&!k.oc&&(f&=ec(k,e)!==u)}}finally{a.Ka=Math.max(g,a.Ka),h.qe--,bc(c,d,b,h)}}return Boolean(f)}function ec(a,b){a.ce&&ac(a.key);return a.handleEvent(b)}
function Yb(a,b){if(a.oc)return q;var c=a.type,d=Ub;if(!(c in d))return q;var d=d[c],e,f;if(!Eb){var g;if(!(g=b))a:{g=["window","event"];for(var h=fa;e=g.shift();)if(h[e]!=t)h=h[e];else{g=t;break a}g=h}e=g;g=q in d;h=u in d;if(g){if(0>e.keyCode||e.returnValue!=p)return q;a:{var m=u;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(j){m=q}if(m||e.returnValue==p)e.returnValue=q}}m=new Sb;m.wa(e,this);e=q;try{if(g){for(var k=[],l=m.currentTarget;l;l=l.parentNode)k.push(l);f=d[q];f.Ka=f.la;for(var s=k.length-
1;!m.nc&&0<=s&&f.Ka;s--)m.currentTarget=k[s],e&=dc(f,k[s],c,q,m);if(h){f=d[u];f.Ka=f.la;for(s=0;!m.nc&&s<k.length&&f.Ka;s++)m.currentTarget=k[s],e&=dc(f,k[s],c,u,m)}}else e=ec(a,m)}finally{k&&(k.length=0)}return e}c=new Sb(b,this);return e=ec(a,c)}var fc=0;function gc(a){return a+"_"+fc++};function hc(){Ob.call(this);this.$k={};this.Vk=this}C(hc,Ob);hc.prototype.customEvent_=q;w=hc.prototype;w.Ef=t;w.Kf=ea("Ef");w.addEventListener=function(a,b,c,d){N(this,a,b,c,d)};w.removeEventListener=function(a,b,c,d){$b(this,a,b,c,d)};
w.dispatchEvent=function(a){var b=a.type||a,c=Ub;if(b in c){if(ma(a))a=new Qb(a,this);else if(a instanceof Qb)a.target=a.target||this;else{var d=a;a=new Qb(b,this);Pa(a,d)}var d=1,e,c=c[b],b=q in c,f;if(b){e=[];for(f=this;f;f=f.Ef)e.push(f);f=c[q];f.Ka=f.la;for(var g=e.length-1;!a.nc&&0<=g&&f.Ka;g--)a.currentTarget=e[g],d&=dc(f,e[g],a.type,q,a)&&a.te!=u}if(u in c)if(f=c[u],f.Ka=f.la,b)for(g=0;!a.nc&&g<e.length&&f.Ka;g++)a.currentTarget=e[g],d&=dc(f,e[g],a.type,u,a)&&a.te!=u;else for(e=this;!a.nc&&
e&&f.Ka;e=e.Ef)a.currentTarget=e,d&=dc(f,e,a.type,u,a)&&a.te!=u;a=Boolean(d)}else a=q;return a};function O(){hc.call(this);this.g="base";this.ta=window["X.counter"].Tj();this.j=u}C(O,hc);O.prototype.__defineGetter__("classname",v("g"));O.prototype.__defineGetter__("id",v("ta"));B("X.base",O);function ic(a,b){this.Ra=new xa(a);this.ra=new xa(b)}ic.prototype={l:function(){return new ic(this.Ra.l(),this.ra.l())},mc:function(){this.ra=Da(this.ra)}};function jc(a,b){this.ra=a;this.Gd=b}jc.prototype={l:function(){return new jc(this.ra.l(),this.Gd)},mc:function(){this.ra=Da(this.ra);this.Gd=-this.Gd}};function kc(a,b){this.Hb=a;this.ze=b;var c=a[0].Ra,d=a[2].Ra,d=Ca(Ba(a[1].Ra,c).kc(Ba(d,c)));this.Qa=new jc(d,d.Zb(c))}kc.prototype={l:function(){var a=this.Hb.map(function(a){return a.l()});return new kc(a,this.ze)},mc:function(){this.Hb.reverse().map(function(a){a.mc()});this.Qa.mc()}};
function lc(a,b,c,d,e,f){for(var g=0,h=[],m=0;m<a.Hb.length;m++){var j=b.ra.Zb(a.Hb[m].Ra)-b.Gd,j=-1E-5>j?2:1E-5<j?1:0,g=g|j;h.push(j)}switch(g){case 0:(0<b.ra.Zb(a.Qa.ra)?c:d).push(a);break;case 1:e.push(a);break;case 2:f.push(a);break;case 3:c=[];d=[];for(m=0;m<a.Hb.length;m++){var k=(m+1)%a.Hb.length,j=h[m],l=h[k],g=a.Hb[m],k=a.Hb[k];2!=j&&c.push(g);1!=j&&d.push(2!=j?g.l():g);3==(j|l)&&(j=(b.Gd-b.ra.Zb(g.Ra))/b.ra.Zb(Ba(k.Ra,g.Ra)),j=new ic(g.Ra.oe(k.Ra,j),g.ra.oe(k.ra,j)),c.push(j),d.push(j.l()))}3<=
c.length&&e.push(new kc(c,a.ze));3<=d.length&&f.push(new kc(d,a.ze))}};function mc(a){this.ua=this.va=this.Qa=t;this.X=[];a&&nc(this,a)}mc.prototype={l:function(){var a=new mc,b=this.Qa&&this.Qa.l();a.Qa=b;b=this.va&&this.va.l();a.va=b;b=this.ua&&this.ua.l();a.ua=b;a.ye(this.X.map(function(a){return a.l()}));return a},W:function(){for(var a=0;a<this.X.length;a++)this.X[a].mc();this.Qa.mc();this.va&&this.va.W();this.ua&&this.ua.W();a=this.va;this.va=this.ua;this.ua=a},ye:ea("X")};
function nc(a,b){if(b.length){a.Qa||(a.Qa=b[0].Qa.l());for(var c=[],d=[],e=0;e<b.length;e++)lc(b[e],a.Qa,a.X,a.X,c,d);c.length&&(a.va||(a.va=new mc),nc(a.va,c));d.length&&(a.ua||(a.ua=new mc),nc(a.ua,d))}}function oc(a){var b=a.X.slice();a.va&&(b=b.concat(oc(a.va)));a.ua&&(b=b.concat(oc(a.ua)));return b}function pc(a,b){a.X=qc(b,a.X);a.va&&pc(a.va,b);a.ua&&pc(a.ua,b)}
function qc(a,b){if(!a.Qa)return b.slice();for(var c=[],d=[],e=0;e<b.length;e++)lc(b[e],a.Qa,c,d,c,d);a.va&&(c=qc(a.va,c));d=a.ua?qc(a.ua,d):[];return c.concat(d)};function rc(){this.X=[]}function sc(a){var b=new rc;b.ye(a);return b}
rc.prototype={l:function(){var a=new rc;a.ye(this.X.map(function(a){return a.l()}));return a},Tf:function(a){var b=new mc(this.l().X);a=new mc(a.l().X);pc(b,a);pc(a,b);a.W();pc(a,b);a.W();nc(b,oc(a));return sc(oc(b))},Ea:function(a){var b=new mc(this.l().X);a=new mc(a.l().X);b.W();pc(b,a);pc(a,b);a.W();pc(a,b);a.W();nc(b,oc(a));b.W();return sc(oc(b))},of:function(a){var b=new mc(this.l().X);a=new mc(a.l().X);b.W();pc(a,b);a.W();pc(b,a);pc(a,b);nc(b,oc(a));b.W();return sc(oc(b))},inverse:function(){var a=
this.l();a.X.map(function(a){a.mc()});return a},ye:ea("X")};function tc(){O.call(this);this.g="indexer";this.Xe=[];this.Ok=[];this.Fa={}}C(tc,O);tc.prototype.add=function(a){a==t&&n(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.Fa||(this.Fa[b]=this.Xe.length,this.Xe.push(a));return this.Fa[b]};tc.prototype.unique=v("Xe");function uc(a){O.call(this);this.g="file";this.Wd=a;this.j=q}C(uc,O);function vc(){this.nb=this.r=t}vc.prototype.__defineSetter__("file",function(a){if(a==t||ja(a)&&0==a.length)this.r=t;else{if(ja(a)){if(1==a.length){this.r=new uc(a[0]);return}this.r=Jb(a,function(a){var c=new Q;c.r=new uc(a);return c})}else this.r=new uc(a);this.nb=t}});vc.prototype.__defineGetter__("file",function(){return!this.r?"":ja(this.r)?this.r.map(function(a){return a.r.Wd}):this.r.Wd});
vc.prototype.__defineGetter__("filedata",function(){return ja(this.r)?this.r.map(function(a){return a.nb}):this.nb});vc.prototype.__defineSetter__("filedata",function(a){if(a==t||ja(a)&&0==a.length)this.nb=t;if(ja(a))if(1==a.length)this.nb=a[0];else{var b=this.r.length,c;for(c=0;c<b;c++)this.r[c].nb=a[c]}else this.nb=a});function wc(a){if("function"==typeof a.vd)return a.vd();if(ma(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Na(a)};function xc(a,b){this.ba={};this.R=[];var c=arguments.length;if(1<c){c%2&&n(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.Ze(a)}w=xc.prototype;w.la=0;w.Vf=0;w.ie=v("la");w.vd=function(){yc(this);for(var a=[],b=0;b<this.R.length;b++)a.push(this.ba[this.R[b]]);return a};function zc(a){for(var b=0;b<a.R.length;b++){var c=a.R[b];if(Ac(a.ba,c)&&a.ba[c]==u)return q}return u}w.clear=function(){this.ba={};this.Vf=this.la=this.R.length=0};
w.remove=function(a){return Ac(this.ba,a)?(delete this.ba[a],this.la--,this.Vf++,this.R.length>2*this.la&&yc(this),q):u};function yc(a){if(a.la!=a.R.length){for(var b=0,c=0;b<a.R.length;){var d=a.R[b];Ac(a.ba,d)&&(a.R[c++]=d);b++}a.R.length=c}if(a.la!=a.R.length){for(var e={},c=b=0;b<a.R.length;)d=a.R[b],Ac(e,d)||(a.R[c++]=d,e[d]=1),b++;a.R.length=c}}w.get=function(a,b){return Ac(this.ba,a)?this.ba[a]:b};w.set=function(a,b){Ac(this.ba,a)||(this.la++,this.R.push(a),this.Vf++);this.ba[a]=b};
w.Ze=function(a){var b;if(a instanceof xc)yc(a),b=a.R.concat(),a=a.vd();else{b=[];var c=0,d;for(d in a)b[c++]=d;a=Na(a)}for(c=0;c<b.length;c++)this.set(b[c],a[c])};w.l=function(){return new xc(this)};w.Sf=function(){for(var a=new xc,b=0;b<this.R.length;b++){var c=this.R[b];a.set(this.ba[c],c)}return a};function Ac(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Bc(){O.call(this);this.g="colortable";this.Fa=new xc;Fa(this,new vc)}C(Bc,O);Bc.prototype.add=function(a,b,c,d,e,f){(!x(a)||!x(c)||!x(d)||!x(e)||!x(f))&&n(Error("Invalid color table entry."));this.Fa.set(a,[b,c,d,e,f]);this.j=q};Bc.prototype.get=function(a){return this.Fa.get(a)};B("X.colortable.prototype.get",Bc.prototype.get);function Cc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.d=ia(c)?c:0}Cc.prototype.l=function(){return new Cc(this.x,this.y,this.d)};function U(a,b,c){this.x=a;this.y=b;this.d=c}C(U,Cc);w=U.prototype;w.l=function(){return new U(this.x,this.y,this.d)};w.Eb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.d*this.d)};w.scale=function(a){this.x*=a;this.y*=a;this.d*=a;return this};w.W=function(){this.x=-this.x;this.y=-this.y;this.d=-this.d;return this};w.normalize=function(){return this.scale(1/this.Eb())};w.add=function(a){this.x+=a.x;this.y+=a.y;this.d+=a.d;return this};
w.Ea=function(a){this.x-=a.x;this.y-=a.y;this.d-=a.d;return this};function Dc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.d-b.d;return Math.sqrt(c*c+d*d+e*e)}function Ec(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.d-b.d;return c*c+d*d+e*e}function Fc(a,b){return new U(a.x+b.x,a.y+b.y,a.d+b.d)}function Gc(a,b){return new U(a.y*b.d-a.d*b.y,a.d*b.x-a.x*b.d,a.x*b.y-a.y*b.x)};D.m=U;w=D.m.prototype;w.l=U.prototype.l;w.Eb=U.prototype.Eb;w.scale=U.prototype.scale;w.W=U.prototype.W;w.add=U.prototype.add;w.Ea=U.prototype.Ea;w.normalize=function(){var a=this.Eb();return 0==a?this.scale(0):this.scale(1/a)};D.m.Zb=function(a,b){return a.x*b.x+a.y*b.y+a.d*b.d};D.m.kc=Gc;D.m.lf=Dc;D.m.oe=function(a,b,c){return new U(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.d+c*(b.d-a.d))};D.m.prototype.__defineGetter__("xx",v("x"));D.m.prototype.__defineGetter__("yy",v("y"));
D.m.prototype.__defineGetter__("zz",v("d"));B("X.vector",D.m);B("X.vector.prototype.clone",D.m.prototype.l);B("X.vector.prototype.magnitude",D.m.prototype.Eb);B("X.vector.prototype.scale",D.m.prototype.scale);B("X.vector.prototype.invert",D.m.prototype.W);B("X.vector.prototype.normalize",D.m.prototype.normalize);B("X.vector.prototype.add",D.m.prototype.add);B("X.vector.prototype.subtract",D.m.prototype.Ea);B("X.vector.dot",D.m.Zb);B("X.vector.cross",D.m.kc);B("X.vector.distance",D.m.lf);
B("X.vector.lerp",D.m.oe);function Hc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Hc.prototype.BYTES_PER_ELEMENT=8;Hc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Hc.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Hc.BYTES_PER_ELEMENT=8}catch(Ic){}Hc.prototype.BYTES_PER_ELEMENT=Hc.prototype.BYTES_PER_ELEMENT;Hc.prototype.set=Hc.prototype.set;Hc.prototype.toString=Hc.prototype.toString;B("Float64Array",Hc)};function Jc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Jc.prototype.BYTES_PER_ELEMENT=4;Jc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Jc.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Jc.BYTES_PER_ELEMENT=4,Jc.prototype.BYTES_PER_ELEMENT=Jc.prototype.BYTES_PER_ELEMENT,Jc.prototype.set=Jc.prototype.set,Jc.prototype.toString=Jc.prototype.toString,B("Float32Array",Jc));function Kc(){return new Float32Array(3)}function Lc(a,b,c){var d=Kc();d[0]=a;d[1]=b;d[2]=c;return d}function Nc(a,b){var c=a[0],d=a[1],e=a[2],c=1/Math.sqrt(c*c+d*d+e*e);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c};function Oc(){return new Float32Array(4)}function Pc(a,b,c,d){var e=Oc();e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e};function Qc(){return new Float32Array(16)}function Rc(){var a=Qc();a[0]=a[5]=a[10]=a[15]=1;return a}function Sc(a,b,c,d,e,f,g,h,m,j,k,l,s,r,z,y,E){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=m;a[8]=j;a[9]=k;a[10]=l;a[11]=s;a[12]=r;a[13]=z;a[14]=y;a[15]=E;return a}function Tc(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3]}function Uc(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3]}function Vc(a,b,c,d,e,f){a[b]=c;a[b+4]=d;a[b+8]=e;a[b+12]=f}
function Wc(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function Xc(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12]}
function Yc(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],m=a[5],j=a[6],k=a[7],l=a[8],s=a[9],r=a[10],z=a[11],y=a[12],E=a[13],F=a[14];a=a[15];var K=b[0],A=b[1],G=b[2],I=b[3],H=b[4],R=b[5],M=b[6],S=b[7],aa=b[8],Z=b[9],ba=b[10],L=b[11],T=b[12],P=b[13],Ea=b[14];b=b[15];c[0]=d*K+h*A+l*G+y*I;c[1]=e*K+m*A+s*G+E*I;c[2]=f*K+j*A+r*G+F*I;c[3]=g*K+k*A+z*G+a*I;c[4]=d*H+h*R+l*M+y*S;c[5]=e*H+m*R+s*M+E*S;c[6]=f*H+j*R+r*M+F*S;c[7]=g*H+k*R+z*M+a*S;c[8]=d*aa+h*Z+l*ba+y*L;c[9]=e*aa+m*Z+s*ba+E*L;c[10]=f*aa+j*Z+r*ba+F*
L;c[11]=g*aa+k*Z+z*ba+a*L;c[12]=d*T+h*P+l*Ea+y*b;c[13]=e*T+m*P+s*Ea+E*b;c[14]=f*T+j*P+r*Ea+F*b;c[15]=g*T+k*P+z*Ea+a*b;return c}
function Zc(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],m=a[6],j=a[7],k=a[8],l=a[9],s=a[10],r=a[11],z=a[12],y=a[13],E=a[14],F=a[15],K=c*h-d*g,A=c*m-e*g,G=c*j-f*g,I=d*m-e*h,H=d*j-f*h,R=e*j-f*m,M=k*y-l*z,S=k*E-s*z,aa=k*F-r*z,Z=l*E-s*y,ba=l*F-r*y,L=s*F-r*E,T=K*L-A*ba+G*Z+I*aa-H*S+R*M;if(0==T)return u;T=1/T;b[0]=(h*L-m*ba+j*Z)*T;b[1]=(-d*L+e*ba-f*Z)*T;b[2]=(y*R-E*H+F*I)*T;b[3]=(-l*R+s*H-r*I)*T;b[4]=(-g*L+m*aa-j*S)*T;b[5]=(c*L-e*aa+f*S)*T;b[6]=(-z*R+E*G-F*A)*T;b[7]=(k*R-s*G+r*A)*T;b[8]=(g*ba-h*
aa+j*M)*T;b[9]=(-c*ba+d*aa-f*M)*T;b[10]=(z*H-y*G+F*K)*T;b[11]=(-k*H+l*G-r*K)*T;b[12]=(-g*Z+h*S-m*M)*T;b[13]=(c*Z-d*S+e*M)*T;b[14]=(-z*I+y*A-E*K)*T;b[15]=(k*I-l*A+s*K)*T;return q}function $c(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[4]+b*a[8]+a[12];c[1]=d*a[1]+e*a[5]+b*a[9]+a[13];c[2]=d*a[2]+e*a[6]+b*a[10]+a[14]}
function ad(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=d*a[0]+e*a[4]+f*a[8]+b*a[12];c[1]=d*a[1]+e*a[5]+f*a[9]+b*a[13];c[2]=d*a[2]+e*a[6]+f*a[10]+b*a[14];c[3]=d*a[3]+e*a[7]+f*a[11]+b*a[15];return c}function bd(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],f=a[2]*b+a[6]*c+a[10]*d+a[14],g=a[3]*b+a[7]*c+a[11]*d+a[15];a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=e;a[14]=f;a[15]=g;return a}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);D.f={};D.f.Tg=function(a,b,c,d){c=c.Ea(b);c.normalize();d=D.m.kc(c,d);d.normalize();var e=D.m.kc(d,c);e.normalize();c.W();Vc(a,0,d.x,d.y,d.d,0);Vc(a,1,e.x,e.y,e.d,0);Vc(a,2,c.x,c.y,c.d,0);bd(a,-b.x,-b.y,-b.d);return a};D.f.Z=function(a,b,c,d){var e=1/(b*a[3]+c*a[7]+d*a[11]+a[15]);return new D.m((b*a[0]+c*a[4]+d*a[8]+a[12])*e,(b*a[1]+c*a[5]+d*a[9]+a[13])*e,(b*a[2]+c*a[6]+d*a[10]+a[14])*e)};
D.f.Rj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);Xc(a,b,d);Xc(a,c,e);Wc(a,b,e);Wc(a,c,d);return a};D.f.Qj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);Uc(a,b,d);Uc(a,c,e);Tc(a,b,e);Tc(a,c,d);return a};D.f.wd=Rc;D.f.l=function(a){var b=Qc();b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
D.f.Sf=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=d;b[9]=f;b[11]=a[14];b[12]=e;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
D.f.ji=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],m=a[7],j=a[8],k=a[9],l=a[10],s=a[11],r=a[12],z=a[13],y=a[14];a=a[15];return(b*g-c*f)*(l*a-s*y)-(b*h-d*f)*(k*a-s*z)+(b*m-e*f)*(k*y-l*z)+(c*h-d*g)*(j*a-s*r)-(c*m-e*g)*(j*y-l*r)+(d*m-e*h)*(j*z-k*r)};D.f.W=Zc;D.f.qf=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return Sc(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0)};
D.f.Pi=function(a,b,c,d,e,f,g){return Sc(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};D.f.Qi=function(a,b,c,d,e,f,g){return Sc(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)};D.f.multiply=Yc;D.f.Xg=ad;D.f.translate=bd;D.f.scale=function(a,b,c,d){return Sc(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])};
D.f.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],m=a[3],j=a[4],k=a[5],l=a[6],s=a[7],r=a[8],z=a[9],y=a[10],E=a[11],F=Math.cos(b),K=Math.sin(b),A=1-F;b=c*c*A+F;var G=c*d*A+e*K,I=c*e*A-d*K,H=c*d*A-e*K,R=d*d*A+F,M=d*e*A+c*K,S=c*e*A+d*K;c=d*e*A-c*K;e=e*e*A+F;return Sc(a,f*b+j*G+r*I,g*b+k*G+z*I,h*b+l*G+y*I,m*b+s*G+E*I,f*H+j*R+r*M,g*H+k*R+z*M,h*H+l*R+y*M,m*H+s*R+E*M,f*S+j*c+r*e,g*S+k*c+z*e,h*S+l*c+y*e,m*S+s*c+E*e,a[12],a[13],a[14],a[15])};
D.f.ue=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],m=a[10],j=a[11],k=Math.cos(b),l=Math.sin(b);a[4]=c*k+g*l;a[5]=d*k+h*l;a[6]=e*k+m*l;a[7]=f*k+j*l;a[8]=c*-l+g*k;a[9]=d*-l+h*k;a[10]=e*-l+m*k;a[11]=f*-l+j*k;return a};D.f.ve=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],m=a[10],j=a[11],k=Math.cos(b),l=Math.sin(b);a[0]=c*k+g*-l;a[1]=d*k+h*-l;a[2]=e*k+m*-l;a[3]=f*k+j*-l;a[8]=c*l+g*k;a[9]=d*l+h*k;a[10]=e*l+m*k;a[11]=f*l+j*k;return a};
D.f.we=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],m=a[6],j=a[7],k=Math.cos(b),l=Math.sin(b);a[0]=c*k+g*l;a[1]=d*k+h*l;a[2]=e*k+m*l;a[3]=f*k+j*l;a[4]=c*-l+g*k;a[5]=d*-l+h*k;a[6]=e*-l+m*k;a[7]=f*-l+j*k;return a};B("X.matrix.identity",D.f.wd);B("X.matrix.clone",D.f.l);B("X.matrix.transpose",D.f.Sf);B("X.matrix.determinant",D.f.ji);B("X.matrix.invert",D.f.W);B("X.matrix.multiply",D.f.multiply);B("X.matrix.multiplyByVector",D.f.Z);B("X.matrix.multiplyByVec4",D.f.Xg);
B("X.matrix.makePerspective",D.f.qf);B("X.matrix.makeFrustum",D.f.Pi);B("X.matrix.makeOrtho",D.f.Qi);B("X.matrix.makeLookAt",D.f.Tg);B("X.matrix.translate",D.f.translate);B("X.matrix.scale",D.f.scale);B("X.matrix.rotate",D.f.rotate);B("X.matrix.rotateX",D.f.ue);B("X.matrix.rotateY",D.f.ve);B("X.matrix.rotateZ",D.f.we);B("X.matrix.swapRows",D.f.Rj);B("X.matrix.swapCols",D.f.Qj);function cd(){O.call(this);this.g="transform";this.O=D.f.wd()}C(cd,O);cd.prototype.__defineGetter__("matrix",v("O"));cd.prototype.__defineSetter__("matrix",function(a){(a==t||!(a instanceof Float32Array))&&n(Error("Invalid matrix."));this.O=a;this.p()});w=cd.prototype;w.ue=function(a){(!x(a)||-360>a||360<a)&&n(Error("Invalid angle."));D.f.ue(this.O,a*Math.PI/180);this.p()};w.ve=function(a){(!x(a)||-360>a||360<a)&&n(Error("Invalid angle."));D.f.ve(this.O,a*Math.PI/180);this.p()};
w.we=function(a){(!x(a)||-360>a||360<a)&&n(Error("Invalid angle."));D.f.we(this.O,a*Math.PI/180);this.p()};w.wh=function(a){x(a)||n(Error("Invalid distance."));D.f.translate(this.O,a,0,0);this.p()};w.xh=function(a){x(a)||n(Error("Invalid distance."));D.f.translate(this.O,0,a,0);this.p()};w.yh=function(a){x(a)||n(Error("Invalid distance."));D.f.translate(this.O,0,0,a);this.p()};function dd(a,b,c){a.O[b+4*c]*=-1;a.p()}w.qi=function(){dd(this,0,0)};w.ri=function(){dd(this,1,1)};
w.si=function(){dd(this,2,2)};w.p=function(){this.j=q};B("X.transform",cd);B("X.transform.prototype.rotateX",cd.prototype.ue);B("X.transform.prototype.rotateY",cd.prototype.ve);B("X.transform.prototype.rotateZ",cd.prototype.we);B("X.transform.prototype.translateX",cd.prototype.wh);B("X.transform.prototype.translateY",cd.prototype.xh);B("X.transform.prototype.translateZ",cd.prototype.yh);B("X.transform.prototype.flipX",cd.prototype.qi);B("X.transform.prototype.flipY",cd.prototype.ri);
B("X.transform.prototype.flipZ",cd.prototype.si);B("X.transform.prototype.modified",cd.prototype.p);function ed(){O.call(this);this.g="texture";this.Wb=this.Mb=this.r=t;this.Re=this.Se=0;this.dg=u;Fa(this,new vc)}C(ed,O);ed.prototype.__defineSetter__("rawData",function(a){this.Wb=a;this.j=q});ed.prototype.__defineSetter__("rawDataHeight",function(a){this.Re=a;this.j=q});ed.prototype.__defineSetter__("rawDataWidth",function(a){this.Se=a;this.j=q});ed.prototype.__defineSetter__("grayscale",function(a){this.dg=a;this.j=q});B("X.texture",ed);function V(a,b){O.call(this);this.g="triplets";this.gb=Infinity;this.bb=-Infinity;this.hb=Infinity;this.cb=-Infinity;this.ib=Infinity;this.eb=-Infinity;this.Ld=[0,0,0];this.cg=q;this.S=0;this.$=new Float32Array(a);b!=t&&(this.$=b.$.subarray(0,b.$.length),this.S=this.$.length,this.gb=b.gb,this.bb=b.bb,this.hb=b.hb,this.cb=b.cb,this.ib=b.ib,this.eb=b.eb,this.Ld=b.Ld.slice(),this.cg=u)}C(V,O);w=V.prototype;
w.add=function(a,b,c){this.gb=Math.min(this.gb,a);this.bb=Math.max(this.bb,a);this.hb=Math.min(this.hb,b);this.cb=Math.max(this.cb,b);this.ib=Math.min(this.ib,c);this.eb=Math.max(this.eb,c);this.Ld=[(this.gb+this.bb)/2,(this.hb+this.cb)/2,(this.ib+this.eb)/2];this.cg=u;this.j=q;this.$[this.S++]=a;this.$[this.S++]=b;this.$[this.S++]=c;return this.S/3};w.Fb=function(){if(this.S!=this.$.length){var a=new Float32Array(this.S);a.set(this.$.subarray(0,this.S));this.$=a}};
w.get=function(a){a*=3;return[this.$[a],this.$[a+1],this.$[a+2]]};w.remove=function(){n(Error("Not implemented."))};w.clear=function(){this.$=new Float32Array(this.$.length);this.j=q};V.prototype.__defineGetter__("count",function(){this.Fb();return this.$.length/3});V.prototype.__defineGetter__("length",function(){this.Fb();return this.$.length});B("X.triplets",V);B("X.triplets.prototype.add",V.prototype.add);B("X.triplets.prototype.resize",V.prototype.Fb);B("X.triplets.prototype.get",V.prototype.get);
B("X.triplets.prototype.remove",V.prototype.remove);B("X.triplets.prototype.clear",V.prototype.clear);function fd(){this.Da=gd;this.ea=new cd;this.u=[1,1,1];this.Hc=this.D=this.na=this.q=this.h=t;this.Cc=[];this.M=q;this.Bc=this.cd=1;this.sc=t;this.Uc=u;this.qa=1;this.sa=0;this.bd=q}var gd="TRIANGLES";fd.prototype.__defineSetter__("type",function(a){return this.Da=a});fd.prototype.__defineGetter__("type",v("Da"));fd.prototype.__defineGetter__("texture",function(){this.D||(this.D=new ed);return this.D});fd.prototype.__defineGetter__("transform",v("ea"));fd.prototype.__defineGetter__("points",v("h"));
fd.prototype.__defineSetter__("points",ea("h"));fd.prototype.__defineGetter__("normals",v("q"));fd.prototype.__defineSetter__("normals",ea("q"));fd.prototype.__defineGetter__("colors",v("na"));fd.prototype.__defineSetter__("colors",ea("na"));fd.prototype.__defineGetter__("color",v("u"));fd.prototype.__defineSetter__("color",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid color."));for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.u=a;this.j=q});
fd.prototype.__defineGetter__("opacity",v("qa"));fd.prototype.__defineSetter__("opacity",function(a){(!x(a)||1<a||0>a)&&n(Error("Invalid opacity."));for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d]!=t&&(b[d].opacity=a);this.qa=a;this.j=q});fd.prototype.__defineGetter__("caption",v("sc"));fd.prototype.__defineSetter__("caption",function(a){this.sc=a;this.j=q});fd.prototype.__defineGetter__("visible",v("M"));
fd.prototype.__defineSetter__("visible",function(a){for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d]!=t&&(b[d].visible=a);this.M=a;this.j=q});fd.prototype.__defineGetter__("pointsize",v("cd"));fd.prototype.__defineSetter__("pointsize",function(a){x(a)||n(Error("Invalid point size."));this.cd=a;this.j=q});fd.prototype.__defineGetter__("magicmode",v("Uc"));fd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&n(Error("Invalid magic mode setting."));this.Uc=a;this.j=q});
fd.prototype.__defineGetter__("linewidth",v("Bc"));fd.prototype.__defineSetter__("linewidth",function(a){x(a)||n(Error("Invalid line width."));this.Bc=a;this.j=q});fd.prototype.__defineGetter__("pickable",v("bd"));fd.prototype.__defineSetter__("pickable",function(a){"boolean"!=typeof a&&n(Error("Invalid pickable setting."));this.bd=a;this.j=q});fd.prototype.__defineGetter__("textureCoordinateMap",v("Hc"));fd.prototype.__defineSetter__("textureCoordinateMap",ea("Tk"));function hd(){this.fb=Infinity;this.ha=this.oa=-Infinity;this.ia=Infinity;this.Rb=[0,0,0];this.Pb=[1,1,1]}hd.prototype.__defineGetter__("lowerThreshold",v("ha"));hd.prototype.__defineSetter__("lowerThreshold",ea("ha"));hd.prototype.__defineGetter__("upperThreshold",v("ia"));hd.prototype.__defineSetter__("upperThreshold",ea("ia"));hd.prototype.__defineGetter__("min",v("fb"));hd.prototype.__defineGetter__("max",v("oa"));hd.prototype.__defineGetter__("minColor",v("Rb"));
hd.prototype.__defineSetter__("minColor",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid min. color."));this.Rb=a});hd.prototype.__defineGetter__("maxColor",v("Pb"));hd.prototype.__defineSetter__("maxColor",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid max. color."));this.Pb=a});function id(){O.call(this);this.g="scalars";this.Rc=this.G=t;this.qg=q;this.Ge=0;Fa(this,new vc);Fa(this,new hd);this.Rb=[0,1,0];this.Pb=[1,0,0]}C(id,O);id.prototype.__defineGetter__("array",v("G"));id.prototype.__defineSetter__("array",function(a){this.Rc=this.G=a;this.j=q});id.prototype.__defineGetter__("interpolation",v("Ge"));id.prototype.__defineSetter__("interpolation",ea("Ge"));B("X.scalars",id);function W(a){O.call(this);this.g="object";this.c=[];this.H=this.Aa=t;Fa(this,new fd);a!=t&&this.ic(a)}C(W,O);
W.prototype.ic=function(a){this.Da=a.Da;this.ea=new cd;this.ea.O=new Float32Array(a.ea.O);this.u=a.u.slice();a.h&&(this.h=new V(a.h.length,a.h));a.q&&(this.q=new V(a.q.length,a.q));a.na&&(this.na=new V(a.na.length,a.na));this.D=a.D;this.Hc=a.Hc;a.r&&(this.r=new uc((new String(a.r.Wd)).toString()));this.qa=a.qa;this.c.length=0;var b=a.c;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.c.push(new D[b[d].g](b[d]));this.M=a.M;this.cd=a.cd;this.Bc=a.Bc;a.sc&&(this.sc=(new String(a.sc)).toString());this.Uc=
a.Uc;this.bd=a.bd;this.Cc=a.Cc.slice();this.j=q};W.prototype.__defineGetter__("colortable",function(){this.Aa||(this.Aa=new Bc);return this.Aa});W.prototype.__defineGetter__("scalars",function(){this.H||(this.H=new id);return this.H});W.prototype.__defineGetter__("children",v("c"));W.prototype.p=function(){var a=new jd;a.L=this;this.dispatchEvent(a)};W.prototype.remove=function(){var a=new kd;a.L=this;this.dispatchEvent(a)};
function ld(a,b){(a==t||b==t||!(a instanceof W)||!(b instanceof W))&&n(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.qa?-1:1==b.qa?1:a.sa!=t&&b.sa!=t&&a.sa>b.sa?-1:1}B("X.object",W);B("X.object.prototype.modified",W.prototype.p);B("X.object.prototype.remove",W.prototype.remove);function md(){}function nd(a){for(var b=a.h.count,c=[],d=0,d=0;d<b;d+=3){var e=a.h.get(d),f=a.h.get(d+1),g=a.h.get(d+2),h=a.q.get(d),m=a.q.get(d+1),j=a.q.get(d+2),k=a.u;a.na&&0<a.na.length&&(k=a.na.get(d));var l=[];l.push(new ic(e,h));l.push(new ic(f,m));l.push(new ic(g,j));c.push(new kc(l,k))}return sc(c)}
function od(a,b){(b==t||!(b instanceof rc))&&n(Error("Invalid CSG object."));var c=new tc,d=[];Jb(b.X,function(a){var b=[],g=a.ze,b=Jb(a.Hb,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Mh=Jb(c.unique(),function(a){return[a.Ra.x(),a.Ra.y(),a.Ra.d()]});a.Lh=Jb(c.unique(),function(a){return[a.ra.x(),a.ra.y(),a.ra.d()]});a.Kh=Jb(c.unique(),function(a){return!a.color?t:[a.color[0],a.color[1],a.color[2]]});a.h=new V(9*d.length);a.q=new V(9*d.length);
a.na=new V(9*d.length);Jb(d,function(a){var b=a[0],c=a[1];a=a[2];var d=this.Mh,m=this.Lh,j=this.Kh;this.h.add(d[b][0],d[b][1],d[b][2]);this.h.add(d[c][0],d[c][1],d[c][2]);this.h.add(d[a][0],d[a][1],d[a][2]);this.q.add(m[b][0],m[b][1],m[b][2]);this.q.add(m[c][0],m[c][1],m[c][2]);this.q.add(m[a][0],m[a][1],m[a][2]);j[b]&&this.na.add(j[b][0],j[b][1],j[b][2]);j[c]&&this.na.add(j[c][0],j[c][1],j[c][2]);j[a]&&this.na.add(j[a][0],j[a][1],j[a][2])}.bind(a));0==a.na.S&&(a.na=t);a.Da=gd}
md.prototype.Tf=function(a){(a==t||!(a instanceof rc)&&!(a instanceof W))&&n(Error("Invalid object."));var b=a;a instanceof W&&(b=nd(b));a=new W;Fa(a,new md);od(a,nd(this).Tf(b));return a};md.prototype.Ea=function(a){(a==t||!(a instanceof rc)&&!(a instanceof W))&&n(Error("Invalid object."));var b=a;a instanceof W&&(b=nd(b));a=new W;Fa(a,new md);od(a,nd(this).Ea(b));return a};
md.prototype.of=function(a){(a==t||!(a instanceof rc)&&!(a instanceof W))&&n(Error("Invalid object."));var b=a;a instanceof W&&(b=nd(b));a=new W;Fa(a,new md);od(a,nd(this).of(b));return a};md.prototype.inverse=function(){var a=new W;Fa(a,new md);od(a,nd(this).inverse());return a};B("X.constructable",md);B("X.constructable.prototype.intersect",md.prototype.of);B("X.constructable.prototype.inverse",md.prototype.inverse);B("X.constructable.prototype.subtract",md.prototype.Ea);
B("X.constructable.prototype.union",md.prototype.Tf);function pd(a){Qb.call(this,a);this.g="event"}C(pd,Qb);var qd=gc("pan"),rd=gc("rotate"),sd=gc("zoom"),td=gc("scroll");gc("render");var ud=gc("resetview"),vd=gc("windowlevel"),wd=gc("modified"),xd=gc("remove"),yd=gc("progress"),zd=gc("hover"),Ad=gc("hover_end"),Bd=gc("computing"),Cd=gc("computing_end"),Dd=gc("computing_progress");function Ed(){pd.call(this,vd);this.Le=this.Ye=0}C(Ed,pd);function Fd(){pd.call(this,qd);this.sa=new D.m(0,0,0)}C(Fd,pd);
function Gd(){pd.call(this,rd);this.sa=new D.m(0,0,0)}C(Gd,pd);function Hd(){pd.call(this,sd);this.ab=this.ob=u}C(Hd,pd);function Id(){pd.call(this,td);this.aa=u}C(Id,pd);function Jd(){pd.call(this,zd);this.be=this.ae=0}C(Jd,pd);function Kd(){pd.call(this,Ad)}C(Kd,pd);function Ld(){pd.call(this,ud)}C(Ld,pd);function jd(){pd.call(this,wd);this.C=this.L=t}C(jd,pd);function kd(){pd.call(this,xd);this.C=this.L=t}C(kd,pd);function Md(){pd.call(this,yd);this.qd=0}C(Md,pd);
function Nd(){pd.call(this,Bd);this.L=t}C(Nd,pd);function Od(){pd.call(this,Dd);this.qd=0}C(Od,pd);function Pd(){pd.call(this,Cd);this.L=t}C(Pd,pd);B("X.event.events.PAN",qd);B("X.event.events.ROTATE",rd);B("X.event.events.ZOOM",sd);B("X.event.events.SCROLL",td);function Qd(){O.call(this);this.g="parser";this.Q=t;this.S=0;this.Qh=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.Sd=q;this.Qk=-Infinity;this.Pk=Infinity}C(Qd,O);Qd.prototype.parse=function(){n(Error("The function parse() should be overloaded."))};function Rd(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)if(!isNaN(a[e]))var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Sd(a,b,c){b===p&&(b=0);c===p&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function Y(a,b,c){c!=t||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array;d=4;break;case "complex":e=Float64Array;d=8;break;case "double":e=Float64Array,d=8}b=new e(a.Q.slice(a.S,a.S+=c*d));if(a.Qh!=a.Sd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>
g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Td(a,b){var c=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],d=Pc(0,0,0,1),e=Oc();ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Pc(0,0,b[3],1);ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Pc(0,b[2],0,
1);ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Pc(b[1],0,0,1);ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Pc(b[1],b[2],0,1);ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>
c[5]?e[2]:c[5];d=Pc(b[1],0,b[3],1);ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Pc(0,b[2],b[3],1);ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Pc(b[1],b[2],b[3],1);ad(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:
c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];return c}
function Ud(a,b){var c=Rc();if(!(a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2])){var d=Math.acos(a[2]),e=Kc(),f=a[0],g=a[1],h=a[2],m=b[0],j=b[1],k=b[2];e[0]=g*k-h*j;e[1]=h*m-f*k;e[2]=f*j-g*m;Nc(e,e);f=Math.cos(d/2);g=Math.sin(d/2)*e[0];h=Math.sin(d/2)*e[1];d=Math.sin(d/2)*e[2];Vc(c,0,f*f+g*g-h*h-d*d,2*(g*h-f*d),2*(g*d+f*h),0);Vc(c,1,2*(g*h+f*d),f*f+h*h-g*g-d*d,2*(h*d-f*g),0);Vc(c,2,2*(g*d-f*h),2*(h*d+f*g),f*f+d*d-h*h-g*g,0)}d=Qc();Zc(c,d);return[c,d]}
function Vd(a,b,c,d,e,f,g,h,m){var j=new Wd;Nc(c,c);for(var k=[],l=[],s=0;6>s;s++)for(var r=Math.floor(s/2),z=(r+1)%3,y=(r+2)%3,E=(4+2*r)%6,F=0;2>F;F++){var K=(2+F+2*r)%6,A=-(c[r]*(e[s]-a[r])+c[z]*(e[K]-a[z]))/c[y]+a[y];if(A>=e[E]&&A<=e[E+1]||A<=e[E]&&A>=e[E+1]){var G=[];G[r]=e[s];G[z]=e[K];G[y]=A;k.push(G)}else G=[],G[r]=e[s],G[z]=e[K],G[y]=A,l.push(G)}a=Lc(0,0,1);a=Ud(c,a);e=a[0];a=a[1];r=[];for(l=0;l<k.length;++l)s=Pc(k[l][0],k[l][1],k[l][2],1),z=Oc(),ad(e,s,z),r.push([z[0],z[1],z[2]]);e=Lc(1,
0,0);k=Kc();$c(a,e,k);l=Lc(0,1,0);e=Kc();$c(a,l,e);s=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];for(l=l=0;l<r.length;++l)r[l][0]<s[0]&&(s[0]=r[l][0]),r[l][0]>s[1]&&(s[1]=r[l][0]),r[l][1]<s[2]&&(s[2]=r[l][1]),r[l][1]>s[3]&&(s[3]=r[l][1]),r[l][2]<s[4]&&(s[4]=r[l][2]),r[l][2]>s[5]&&(s[5]=r[l][2]);l=Pc(s[0]+(s[1]-s[0])/2,s[2]+(s[3]-s[2])/2,s[4]+(s[5]-s[4])/2,0);r=Oc();Yc(a,l,r);z=Math.floor(s[0]);y=Math.ceil(s[1]);E=y-z;F=Math.floor(s[2]);
K=Math.ceil(s[3]);A=K-F;G=b[0];b=b[1];var l=Math.ceil(E/G),I=Math.ceil(A/b),H=new Uint8Array(4*l*I),R=new ed;R.Se=l;R.Re=I;var I=Oc(),M=Pc(0,0,s[4],1),S=Qc();Yc(g.Hh,a,S);for(var aa=K-1E-7,Z=y-1E-7,ba=0,L=0,T=0,P=F,P=F;P<=aa;P+=b){T++;L=0;M[1]=P;for(l=z;l<=Z;l+=G){L++;M[0]=l;ad(S,M,I);var Ea=4*ba,qb=Math.round(I[2]),rb=Math.round(I[1]),sb=Math.round(I[0]);if(0<=sb&&sb<g.T[0]&&0<=rb&&rb<g.T[1]&&0<=qb&&qb<g.T[2]){var jb=f[qb][rb][sb],Mc=sb=rb=qb=0;m?((jb=m.get(jb))||(jb=[0,0.61,0,0,1]),qb=255*jb[1],
rb=255*jb[2],sb=255*jb[3],Mc=255*jb[4]):(qb=rb=sb=255*(jb/g.oa),Mc=255);H[Ea]=qb;H[++Ea]=rb;H[++Ea]=sb;H[++Ea]=Mc}else H[Ea]=0,H[++Ea]=0,H[++Ea]=0,H[++Ea]=0;ba++}}R.Wb=H;j.D=R;j.Wh=s;j.Jh=a;j.Ih=S;j.Ph=F;j.Nk=K;j.Vh=z;j.Uk=y;j.fg=L;j.eg=T;j.Jc=G;j.I=E;j.wc=b;j.w=A;j.B=[r[0],r[1],r[2]];j.vc=[c[0],c[1],c[2]];j.Xd=[k[0],k[1],k[2]];j.aa=[e[0],e[1],e[2]];j.M=u;j.Cb=g;j.xb=g.Cb!=t&&!h?u:q;j.rc=d;j.jc();j.M=u;return j}
function Xd(a,b,c,d){var e;e=d.ma;for(var f=[],g=[],h=0;6>h;h++){var m=Math.floor(h/2),j=(m+1)%3,k=(m+2)%3,l=(2+2*m)%6,s=(4+2*m)%6,r=(e[h]-b[m])*(1/c[m]);if(Infinity!=r&&-Infinity!=r){var z=b[j]+c[j]*r,r=b[k]+c[k]*r;z>=e[l]&&z<=e[l+1]&&r>=e[s]&&r<=e[s+1]?(l=[],l[m]=e[h],l[j]=z,l[k]=r,f.push(l)):(l=[],l[m]=e[h],l[j]=z,l[k]=r,g.push(l))}}e=[f,g];b=e[0];d.b[a].k=e;e=Dc(new U(b[0][0],b[0][1],b[0][2]),new U(b[1][0],b[1][1],b[1][2]));d.b[a].Mk=e;f=Lc(0,0,1);g=Ud(c,f)[0];h=Pc(d.De[0],d.De[1],d.De[2],0);
f=Oc();ad(g,h,f);g=Oc();h=f[2];g[0]=c[0]*h;g[1]=c[1]*h;g[2]=c[2]*h;g[3]=c[3]*h;0.5>Math.abs(f[0])&&(f[0]=0.5);0.5>Math.abs(f[1])&&(f[1]=0.5);d.b[a].Ca=[Math.abs(f[0]),Math.abs(f[1])];d.b[a].Fc=f[2];d.b[a].z=g;e=Math.abs(Math.floor(e/f[2]));d.ed[a]=e;d.b[a].o=e;d.b[a].k[0][0][0]>d.b[a].k[0][1][0]?0<g[0]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][0]<d.b[a].k[0][1][0]?0>g[0]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][1]>d.b[a].k[0][1][1]?
0<g[1]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][1]<d.b[a].k[0][1][1]?0>g[1]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][2]>d.b[a].k[0][1][2]?0<g[2]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][2]<d.b[a].k[0][1][2]&&0>g[2]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e);d.b[a].Oe=-(c[0]*b[0][0]+c[1]*b[0][1]+c[2]*b[0][2])}
function Yd(a,b){var c;c=b.Q;for(var d=b.T,e=b.oa,f=Array(d[2]),g=Array(d[2]),h=d[1]*d[0],m=0,j=0,k=0,l=0,s=0,l=0;l<d[2];l++){var r=c.subarray(l*h,(l+1)*h),s=0;g[l]=Array(d[1]);f[l]=Array(d[1]);for(k=0;k<d[1];k++){g[l][k]=new c.constructor(d[0]);f[l][k]=new c.constructor(d[0]);for(j=0;j<d[0];j++)m=r[s],g[l][k][j]=255*(m/e),f[l][k][j]=m,s++}}c=[f,g];b.da=c[0];b.Kk=c[1];D.$a(a.g+".reslice");b.J=b.e!=t;b.Aa&&(b.Qc=b.Aa.Fa);b.gl=[b.T[0],b.T[1],b.T[2]];b.t=[b.ya[0]+b.wb[0]/2,b.ya[1]+b.wb[1]/2,b.ya[2]+
b.wb[2]/2];b.ma=[Math.min(b.ya[0],b.ya[0]+b.wb[0]),Math.max(b.ya[0],b.ya[0]+b.wb[0]),Math.min(b.ya[1],b.ya[1]+b.wb[1]),Math.max(b.ya[1],b.ya[1]+b.wb[1]),Math.min(b.ya[2],b.ya[2]+b.wb[2]),Math.max(b.ya[2],b.ya[2]+b.wb[2])];b.b=[{},{},{}];c=Lc(b.t[0],b.t[1],b.t[2]);b.b[0].gd=c;d=Lc(1,0,0);Nc(d,d);b.b[0].i=d;e=[1,0,0];b.b[0].u=e;Xd(0,c,d,b);b.c[0].c=Array(b.b[0].o);c[0]=b.b[0].k[0][0][0]+b.b[0].z[0]*Math.round(b.b[0].o/2);c[1]=b.b[0].k[0][0][1]+b.b[0].z[1]*Math.round(b.b[0].o/2);c[2]=b.b[0].k[0][0][2]+
b.b[0].z[2]*Math.round(b.b[0].o/2);c=Vd(c,b.b[0].Ca,b.b[0].i,b.b[0].u,b.ma,b.da,b,b.J,b.Qc);b.J&&(c.e=b.e.c[0].c[Math.round(b.b[0].o/2)].D);b.c[0].c[Math.round(b.b[0].o/2)]=c;b.yb=Math.round(b.b[0].o/2);b.xc=Math.round(b.b[0].o/2);c=Lc(b.t[0],b.t[1],b.t[2]);b.b[1].gd=c;d=Lc(0,1,0);Nc(d,d);b.b[1].i=d;e=[0,1,0];b.b[1].u=e;Xd(1,c,d,b);b.c[1].c=Array(b.b[1].o);c[0]=b.b[1].k[0][0][0]+b.b[1].z[0]*Math.round(b.b[1].o/2);c[1]=b.b[1].k[0][0][1]+b.b[1].z[1]*Math.round(b.b[1].o/2);c[2]=b.b[1].k[0][0][2]+b.b[1].z[2]*
Math.round(b.b[1].o/2);c=Vd(c,b.b[1].Ca,b.b[1].i,b.b[1].u,b.ma,b.da,b,b.J,b.Qc);b.J&&(c.e=b.e.c[1].c[Math.round(b.b[1].o/2)].D);b.c[1].c[Math.round(b.b[1].o/2)]=c;b.zb=Math.round(b.b[1].o/2);b.yc=Math.round(b.b[1].o/2);c=Lc(b.t[0],b.t[1],b.t[2]);b.b[2].gd=c;d=Lc(0,0,1);Nc(d,d);b.b[2].i=d;e=[0,0.392,0.804];b.b[2].u=e;Xd(2,c,d,b);b.c[2].c=Array(b.b[2].o);c[0]=b.b[2].k[0][0][0]+b.b[2].z[0]*Math.round(b.b[2].o/2);c[1]=b.b[2].k[0][0][1]+b.b[2].z[1]*Math.round(b.b[2].o/2);c[2]=b.b[2].k[0][0][2]+b.b[2].z[2]*
Math.round(b.b[2].o/2);c=Vd(c,b.b[2].Ca,b.b[2].i,b.b[2].u,b.ma,b.da,b,b.J,b.Qc);b.J&&(c.e=b.e.c[2].c[Math.round(b.b[2].o/2)].D);b.c[2].c[Math.round(b.b[2].o/2)]=c;b.Ab=Math.round(b.b[2].o/2);b.zc=Math.round(b.b[2].o/2);D.Wa(a.g+".reslice");return b.da};function Zd(){Qd.call(this);this.g="parserLBL"}C(Zd,Qd);
Zd.prototype.parse=function(a,b,c){D.$a(this.g+".parse");var d=b.Cc,e=d.length;0==e&&n(Error("No _pointIndices defined on the X.object."));this.Q=c;var f=[],g=Y(this,"uchar",c.byteLength),h=g.length,m=u,j=0;for(c=1;c<h;c++)10==g[c-1]?(j=c,m=q):m&&32==g[c]&&(f.push(parseInt(Sd(g,j,c),10)),m=u);g=b.H.G?b.H.G:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)m=d[c],m>e&&n(Error("Could not find scalar for vertex.")),m=g[m],f[h++]=m,f[h++]=m,f[h++]=m;b.H.G=
g;b.H.Rc=f;b.H.j=q;D.Wa(this.g+".parse");d=new jd;d.L=b;d.C=a;this.dispatchEvent(d)};B("X.parserLBL",Zd);B("X.parserLBL.prototype.parse",Zd.prototype.parse);var $d;function ae(a,b){var c;c=a.className;c=ma(c)&&c.match(/\S+/g)||[];for(var d=Nb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Hb(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};function be(a,b){this.width=a;this.height=b}w=be.prototype;w.l=function(){return new be(this.width,this.height)};w.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};w.scale=function(a,b){var c=x(b)?b:a;this.width*=a;this.height*=c;return this};var ce=!J||J&&9<=Db;!kb&&!J||J&&J&&9<=Db||kb&&Bb("1.9.1");J&&Bb("9");function de(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}w=de.prototype;w.l=function(){return new de(this.x,this.y)};function ee(a,b){return new de(a.x-b.x,a.y-b.y)}w.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};w.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};w.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};
w.translate=function(a,b){a instanceof de?(this.x+=a.x,this.y+=a.y):(this.x+=a,x(b)&&(this.y+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.x*=a;this.y*=c;return this};function fe(a){return a?new ge(he(a)):$d||($d=new ge)}function ie(a){return ma(a)?document.getElementById(a):a}var je={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ke(a,b,c){return le(document,arguments)}
function le(a,b){var c=b[0],d=b[1];if(!ce&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Ra(d.name),'"');if(d.type){c.push(' type="',Ra(d.type),'"');var e={};Pa(e,d);delete e.type;d=e}c.push(">");c=c.join("")}var f=a.createElement(c);d&&(ma(d)?f.className=d:ja(d)?ae.apply(t,[f].concat(d)):Ma(d,function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in je?f.setAttribute(je[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?f.setAttribute(b,a):
f[b]=a}));if(2<b.length){d=function(b){b&&f.appendChild(ma(b)?a.createTextNode(b):b)};for(c=2;c<b.length;c++){var g=b[c];if(la(g)&&!(oa(g)&&0<g.nodeType)){var e=Ib,h;a:{if((h=g)&&"number"==typeof h.length){if(oa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(na(h)){h="function"==typeof h.item;break a}}h=u}if(h)if(h=g.length,0<h){for(var m=Array(h),j=0;j<h;j++)m[j]=g[j];g=m}else g=[];e(g,d)}else d(g)}}return f}function me(a){return"CSS1Compat"==a.compatMode}
function ne(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function oe(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function pe(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function he(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ge(a){this.fa=a||fa.document||document}w=ge.prototype;w.je=fe;
w.s=function(a){return ma(a)?this.fa.getElementById(a):a};w.Ch=ge.prototype.s;w.Kc=function(a,b,c){return le(this.fa,arguments)};w.createElement=function(a){return this.fa.createElement(a)};w.createTextNode=function(a){return this.fa.createTextNode(String(a))};function qe(a){return me(a.fa)}
function re(a){var b=a.fa;a=!lb&&me(b)?b.documentElement:b.body;b=b.parentWindow||b.defaultView;return J&&Bb("10")&&b.pageYOffset!=a.scrollTop?new de(a.scrollLeft,a.scrollTop):new de(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}w.appendChild=function(a,b){a.appendChild(b)};w.contains=pe;function se(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}w=se.prototype;w.l=function(){return new se(this.top,this.right,this.bottom,this.left)};w.contains=function(a){return!this||!a?u:a instanceof se?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};
w.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};w.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};w.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};
w.translate=function(a,b){a instanceof de?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,x(b)&&(this.top+=b,this.bottom+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};function te(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}w=te.prototype;w.l=function(){return new te(this.left,this.top,this.width,this.height)};w.Pg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,q}return u};
w.contains=function(a){return a instanceof te?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};function ue(a,b){var c=b.x<a.left?a.left-b.x:Math.max(b.x-(a.left+a.width),0),d=b.y<a.top?a.top-b.y:Math.max(b.y-(a.top+a.height),0);return c*c+d*d}w.lf=function(a){return Math.sqrt(ue(this,a))};
w.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
w.translate=function(a,b){a instanceof de?(this.left+=a.x,this.top+=a.y):(this.left+=a,x(b)&&(this.top+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};function ve(a,b){var c=he(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,t))?c[b]||c.getPropertyValue(b)||"":""}function we(a,b){return ve(a,b)||(a.currentStyle?a.currentStyle[b]:t)||a.style&&a.style[b]}function xe(a){a=a?he(a):document;return J&&!(J&&9<=Db)&&!qe(fe(a))?a.body:a.documentElement}
function ye(a){var b=a.getBoundingClientRect();J&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ze(a){if(J&&!(J&&8<=Db))return a.offsetParent;var b=he(a),c=we(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=we(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return t}
function Ae(a){for(var b=new se(0,Infinity,Infinity,0),c=fe(a),d=c.fa.body,e=c.fa.documentElement,f=!lb&&me(c.fa)?c.fa.documentElement:c.fa.body;a=ze(a);)if((!J||0!=a.clientWidth)&&(!lb||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=we(a,"overflow")){var g=Be(a),h;h=a;if(kb&&!Bb("1.9")){var m=parseFloat(ve(h,"borderLeftWidth"));if(Ce(h))var j=h.offsetWidth-h.clientWidth-m-parseFloat(ve(h,"borderRightWidth")),m=m+j;h=new de(m,parseFloat(ve(h,"borderTopWidth")))}else h=new de(h.clientLeft,h.clientTop);
g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(c.fa.parentWindow||c.fa.defaultView||window).document;c=me(c)?c.documentElement:c.body;c=new be(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?
b:t}
function Be(a){var b,c=he(a),d=we(a,"position"),e=kb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new de(0,0),g=xe(c);if(a==g)return f;if(a.getBoundingClientRect)b=ye(a),a=re(fe(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(lb&&"fixed"==we(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(ib||lb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=ze(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!ib||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function De(a){var b=new de;if(1==a.nodeType){if(a.getBoundingClientRect){var c=ye(a);b.x=c.left;b.y=c.top}else{var c=re(fe(a)),d=Be(a);b.x=d.x-c.x;b.y=d.y-c.y}if(kb&&!Bb(12)){var e;J?e="-ms-transform":lb?e="-webkit-transform":ib?e="-o-transform":kb&&(e="-moz-transform");var f;e&&(f=we(a,e));f||(f=we(a,"transform"));f?(a=f.match(Ee),a=!a?new de(0,0):new de(parseFloat(a[1]),parseFloat(a[2]))):a=new de(0,0);b=new de(b.x+a.x,b.y+a.y)}}else e=na(a.ui),f=a,a.targetTouches?f=a.targetTouches[0]:e&&a.lb.targetTouches&&
(f=a.lb.targetTouches[0]),b.x=f.clientX,b.y=f.clientY;return b}function Fe(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function Ge(a){if("none"!=we(a,"display"))return He(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=He(a);b.display=c;b.position=e;b.visibility=d;return a}
function He(a){var b=a.offsetWidth,c=a.offsetHeight,d=lb&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=ye(a),new be(a.right-a.left,a.bottom-a.top)):new be(b,c)}function Ie(a,b){a.style.display=b?"":"none"}function Ce(a){return"rtl"==we(a,"direction")}function Je(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}
function Ke(a,b){var c=a.currentStyle?a.currentStyle[b]:t;return c?Je(a,c):0}var Le={thin:2,medium:4,thick:6};function Me(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:t))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:t;return c in Le?Le[c]:Je(a,c)}var Ee=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Ne(a,b){hc.call(this);this.F=a;var c=oa(this.F)&&1==this.F.nodeType?this.F:this.F?this.F.body:t;this.Ni=!!c&&Ce(c);this.cl=N(this.F,kb?"DOMMouseScroll":"mousewheel",this,b)}C(Ne,hc);
Ne.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.lb;if("mousewheel"==a.type){c=1;if(J||lb&&(bb||Bb("532.0")))c=40;d=Oe(-a.wheelDelta,c);ia(a.wheelDeltaX)?(b=Oe(-a.wheelDeltaX,c),c=Oe(-a.wheelDeltaY,c)):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;x(this.Ug)&&(b=Math.min(Math.max(b,-this.Ug),this.Ug));x(this.Vg)&&(c=Math.min(Math.max(c,-this.Vg),this.Vg));this.Ni&&(b=-b);b=new Pe(d,a,b,c);this.dispatchEvent(b)};
function Oe(a,b){return lb&&(ab||cb)&&0!=a%b?a:a/b}function Pe(a,b,c,d){b&&this.wa(b,p);this.type="mousewheel";this.detail=a;this.Yk=c;this.Lc=d}C(Pe,Sb);J||lb&&Bb("525");function Qe(a){O.call(this);this.g="interactor";this.La=a;this.Me=this.kg=this.jg=this.lg=this.ig=this.mg=t;this.Ud=q;this.Xb=this.Qb=this.pb=u;this.pa=[0,0];this.He=new D.m(0,0,0);this.Sc=new D.m(0,0,0);this.Rg=0;this.tg=this.Qd=t;this.sg=u;this.P={MOUSEWHEEL_ENABLED:q,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:u,TOUCH_ENABLED:q,TOUCH_BOUNCING_ENABLED:u}}C(Qe,O);Qe.prototype.__defineGetter__("config",v("P"));Qe.prototype.__defineGetter__("leftButtonDown",v("pb"));
Qe.prototype.__defineGetter__("middleButtonDown",v("Qb"));Qe.prototype.__defineGetter__("rightButtonDown",v("Xb"));
Qe.prototype.wa=function(){this.P.MOUSEWHEEL_ENABLED?(this.Me=new Ne(this.La),this.mg=N(this.Me,"mousewheel",this.zd.bind(this))):(ac(this.mg),this.Me=t);this.P.MOUSECLICKS_ENABLED?(this.ig=N(this.La,"mousedown",this.$i.bind(this)),this.lg=N(this.La,"mouseup",this.ej.bind(this))):(ac(this.ig),ac(this.lg));this.La.oncontextmenu=this.P.CONTEXTMENU_ENABLED?t:function(){return u};window.onkeydown=this.P.KEYBOARD_ENABLED?this.ah.bind(this):t;this.P.TOUCH_ENABLED?(this.P.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},u),this.Uh=N(this.La,"touchstart",this.tj.bind(this)),this.Th=N(this.La,"touchmove",this.rj.bind(this)),this.Sh=N(this.La,"touchend",this.nj.bind(this))):(ac(this.Uh),ac(this.Th),ac(this.Sh));ac(this.jg);ac(this.kg);this.jg=N(this.La,"mousemove",this.bj.bind(this));this.kg=N(this.La,"mouseout",this.cj.bind(this))};
Qe.prototype.$i=function(a){0==a.button?this.pb=q:1==a.button?this.Qb=q:2==a.button&&(this.Xb=q);eval("this.onMouseDown("+this.pb+","+this.Qb+","+this.Xb+")");Re(this);a.preventDefault()};Qe.prototype.Zi=da();Qe.prototype.ej=function(a){0==a.button?this.pb=u:1==a.button?this.Qb=u:2==a.button&&(this.Xb=u);eval("this.onMouseUp("+this.pb+","+this.Qb+","+this.Xb+")");Re(this);a.preventDefault()};Qe.prototype.__defineGetter__("mousePosition",v("pa"));w=Qe.prototype;w.dj=da();
w.cj=function(a){this.Ud=u;this.P.KEYBOARD_ENABLED&&(window.onkeydown=t);this.Xb=this.Qb=this.pb=u;Re(this);this.He=new D.m(0,0,0);a.preventDefault()};w.aj=da();w.tj=function(a){a.preventDefault();a.wa(a.lb.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Sc=new D.m(a.clientX,a.clientY,0);this.tg=setTimeout(this.pj.bind(this,a),500)};w.sj=da();
w.pj=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new Hd;a.ob=q;a.ab=this instanceof Se;this.dispatchEvent(a);this.Yd=q};w.oj=da();function Ve(a){clearTimeout(a.tg);if(a.Yd){var b=new Hd;b.ob=u;b.ab=a instanceof Se;a.dispatchEvent(b)}a.Yd=u}w.nj=function(a){a.preventDefault();eval("this.onTouchEnd()");Ve(this)};w.mj=da();
w.rj=function(a){a.preventDefault();this.Yd||Ve(this);this.touchmoveEvent=a=a.lb;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new D.m(c[0],c[1],0);var b=c[0]>3*this.La.clientWidth/4,d=c[0]<this.La.clientWidth/4,e=c[1]<this.La.clientHeight/4,c=c[1]>3*this.La.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.Sc.Ea(a);this.Sc=a.l();if(this.Yd)a=new Fd,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.sa=e,this.dispatchEvent(a);
else if(this instanceof We&&(b||d))a=new Id,a.aa=0>e.y,this.dispatchEvent(a);else if(this instanceof Se||c)e.scale(3),a=new Gd,a.sa=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new D.m(a[0],a[1],0),b=new D.m(b[0],b[1],0),e=Ec(a,b),b=e-this.Rg,this.Rg=e,this.Sc.Ea(a),this.Sc=a.l(),10<Math.abs(b)&&(a=new Hd,a.ob=0<b,a.ab=this instanceof Se,this.dispatchEvent(a)))};w.qj=da();
w.bj=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Ud=q;this.P.KEYBOARD_ENABLED&&window.onkeydown==t&&(window.onkeydown=this.ah.bind(this));a.preventDefault();var b=a.shiftKey;this.sg=b;this.pa=[a.offsetX,a.offsetY];var c=new D.m(this.pa[0],this.pa[1],0);a=this.He.Ea(c);this.He=c.l();this.P.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.Qb||this.pb||this.Xb)&&Re(this),this.Qd=setTimeout(function(){Re(this);var a=new Jd;a.ae=c.x;a.be=c.y;this.dispatchEvent(a);
this.Qd=t}.bind(this),300));0!=a.Eb()&&(this.pb&&!b?(b=new Gd,a.scale(3),b.sa=a,this.dispatchEvent(b)):this.Qb||this.pb&&b?(b=new Fd,b.sa=a,this.dispatchEvent(b)):this.Xb&&(b=new Hd,b.ob=0<a.y,b.ab=u,this.dispatchEvent(b)))};function Re(a){a.Qd&&clearTimeout(a.Qd);a.dispatchEvent(new Kd)}w.fj=da();w.zd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");Re(this);a.preventDefault()};w.Xi=da();
w.ah=function(a){if(this.Ud){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");Re(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Ld,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Fd:b?a=new Hd:(a=new Gd,this instanceof We&&(a=new Id)),a&&(c=new D.m(0,0,0),37==f?(c.x=5,a.aa=u,b&&(a.aa=q,a.ob=q,a.ab=u)):39==f?(c.x=-5,a.aa=q,b&&(a.ob=u,a.ab=u)):38==f?(c.y=5,a.aa=q,b&&(a.ob=q,a.ab=q)):40==f&&(c.y=-5,a.aa=u,b&&
(a.ob=u,a.ab=q)),a.sa=c,this.dispatchEvent(a)))}};B("X.interactor",Qe);B("X.interactor.prototype.init",Qe.prototype.wa);B("X.interactor.prototype.onMouseDown",Qe.prototype.Zi);B("X.interactor.prototype.onMouseUp",Qe.prototype.dj);B("X.interactor.prototype.onMouseMove",Qe.prototype.aj);B("X.interactor.prototype.onMouseWheel",Qe.prototype.fj);B("X.interactor.prototype.onKey",Qe.prototype.Xi);B("X.interactor.prototype.onTouchStart",Qe.prototype.sj);B("X.interactor.prototype.onTouchMove",Qe.prototype.qj);
B("X.interactor.prototype.onTouchEnd",Qe.prototype.mj);B("X.interactor.prototype.onTouchHover",Qe.prototype.oj);function We(a){Qe.call(this,a);this.g="interactor2D"}C(We,Qe);We.prototype.zd=function(a){We.A.zd.call(this,a);var b=new Id;a.Lc==t&&(a.Lc=0);b.aa=0>a.Lc;this.dispatchEvent(b)};function Wd(a){W.call(this);this.g="slice";this.B=[0,0,0];this.vc=[0,0,1];this.aa=[0,1,0];this.Xd=[1,0,0];this.w=this.I=10;this.Hc=[0,1,0,0,1,1,1,1,1,0,0,0];this.e=this.Cb=t;this.xb=q;this.rc=[1,1,1];a!=t&&this.ic(a)}C(Wd,W);Wd.prototype.ic=function(a){this.B=a.B.slice();this.vc=a.vc.slice();this.aa=a.aa.slice();this.I=a.I;this.w=a.w;this.Cb=a.Cb;this.e=a.e;this.xb=a.xb;this.rc=a.rc;this.Oh=a.Oh;Wd.A.ic.call(this,a)};Wd.prototype.__defineSetter__("height",ea("w"));
Wd.prototype.__defineSetter__("width",ea("I"));Wd.prototype.create=function(){this.jc()};
Wd.prototype.jc=function(){var a=(new U(this.vc[0],this.vc[1],this.vc[2])).normalize(),b=new U(this.aa[0],this.aa[1],this.aa[2]),c=new U(this.Xd[0],this.Xd[1],this.Xd[2]),d=new U(this.B[0],this.B[1],this.B[2]),e=Fc(c.l().W().scale(this.I/2),b.l().W().scale(this.w/2)),f=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Fc(c.l().W().scale(this.I/2),b.l().scale(this.w/2)),g=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Fc(c.l().scale(this.I/2),b.l().W().scale(this.w/2)),h=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Fc(c.l().scale(this.I/2),
b.l().scale(this.w/2)),b=new U(e.x+d.x,e.y+d.y,e.d+d.d);this.h=new V(18);this.q=new V(18);this.h.add(f.x,f.y,f.d);this.h.add(g.x,g.y,g.d);this.h.add(h.x,h.y,h.d);this.h.add(h.x,h.y,h.d);this.h.add(b.x,b.y,b.d);this.h.add(g.x,g.y,g.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.xb&&(a=new W,a.h=new V(24),a.q=new V(24),a.h.add(f.x,f.y,f.d),a.h.add(g.x,g.y,g.d),a.h.add(g.x,g.y,g.d),a.h.add(b.x,b.y,
b.d),a.h.add(b.x,b.y,b.d),a.h.add(h.x,h.y,h.d),a.h.add(h.x,h.y,h.d),a.h.add(f.x,f.y,f.d),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.u=[this.rc[0],this.rc[1],this.rc[2]],a.Da="LINES",a.Bc=2,this.c.push(a))};B("X.slice",Wd);B("X.slice.prototype.create",Wd.prototype.create);function Q(a){W.call(this);this.g="volume";this.B=[0,0,0];this.T=[10,10,10];this.ma=[1,1,1];this.ed=[10,10,10];this.md=[1,1,1];this.Mb=[];this.zc=this.Ab=this.yc=this.zb=this.xc=this.yb=0;this.jd=new W;this.kd=new W;this.ld=new W;this.$d=this.Na=u;this.V=-1;this.ug=[];this.e=t;this.xb=q;this.ka=Infinity;this.ja=-Infinity;this.rg=q;this.oa=0;this.Q=t;Fa(this,new vc);Fa(this,new hd);a!=t&&this.ic(a)}C(Q,W);
Q.prototype.ic=function(a){this.B=a.B.slice();this.T=a.T.slice();this.md=a.md.slice();this.yb=a.yb;this.xc=a.xc;this.zb=a.zb;this.yc=a.yc;this.Ab=a.Ab;this.zc=a.zc;this.$f=a.$f.slice();this.jd=new W(a.jd);this.kd=new W(a.kd);this.ld=new W(a.ld);this.oa=a.oa;this.Q=a.Q;this.Na=a.Na;this.$d=a.$d;this.V=a.V;this.e=a.e;this.xb=a.xb;Q.A.ic.call(this,a)};
Q.prototype.jc=function(a){this.c.length=0;this.jd.c.length=0;this.kd.c.length=0;this.ld.c.length=0;this.c.push(this.jd);this.c.push(this.kd);this.c.push(this.ld);this.ya=a.Id;this.De=a.Jd;this.wb=a.Hd;this.qc=a.Ib;this.Hh=a.Jb;this.Rk=a.sh;this.Sk=a.Sa;this.Ga=a.orientation;this.oa=a.max;this.Q=a.data;this.j=q};
Q.prototype.p=function(a){a="undefined"!==typeof a?a:q;if(0<this.c.length){this.Na!=this.$d&&(!this.Na&&-1!=this.V&&(this.c[this.V].visible=u),this.j=q,this.$d=this.Na);if(!this.M)return;for(var b=0,b=0;3>b;b++){var c=this.c[b],d=0,e=0;0==b?(d=this.yb,e=this.xc,this.xc=this.yb):1==b?(d=this.zb,e=this.yc,this.yc=this.zb):2==b&&(d=this.Ab,e=this.zc,this.zc=this.Ab);if(this.c[b].c[parseInt(d,10)]==t){var f=Kc();f[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*parseInt(d,10);f[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*
parseInt(d,10);f[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*parseInt(d,10);if(this.J){var g=Vd(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.e.da,this.e,this.e.J,this.e.Aa.Fa);this.e.c[b].c[parseInt(d,10)]=g;this.e.c[b].p(q)}f=Vd(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.da,this,q,t);this.J&&(f.e=f.D,f.e=this.e.c[b].c[parseInt(d,10)].D);c.c[parseInt(d,10)]=f;this.c[b].p(q)}e=c.c[parseInt(e,10)];this.Na||(e.visible=u);c=c.c[parseInt(d,10)];c.visible=q;c.qa=1;this.Na&&(c.c[0].M=u,b!=this.V&&
(c.visible=u,c.qa=0))}this.Na&&-1!=this.V&&Xe(this,this.V)}a&&Q.A.p.call(this)};Q.prototype.__defineGetter__("dimensions",v("T"));Q.prototype.__defineGetter__("bbox",v("ma"));Q.prototype.__defineGetter__("range",v("ed"));Q.prototype.__defineGetter__("dimensionsRAS",v("$f"));Q.prototype.__defineGetter__("volumeRendering",v("Na"));Q.prototype.__defineSetter__("volumeRendering",function(a){this.Na=a;this.p(u)});Q.prototype.__defineGetter__("visible",v("M"));
Q.prototype.__defineSetter__("visible",function(a){if(a)this.M=a,this.p(u);else{for(var b=this.c,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.M=a;this.j=q}});Q.prototype.__defineGetter__("center",v("B"));Q.prototype.__defineSetter__("center",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid center."));this.B=a});Q.prototype.__defineGetter__("image",v("Mb"));Q.prototype.__defineGetter__("labelmap",function(){this.e||(this.e=new Ye(this));return this.e});
Q.prototype.__defineGetter__("indexX",v("yb"));Q.prototype.__defineSetter__("indexX",function(a){x(a)&&(0<=a&&a<this.jd.c.length)&&(this.yb=a,this.p(u))});Q.prototype.__defineGetter__("indexY",v("zb"));Q.prototype.__defineSetter__("indexY",function(a){x(a)&&(0<=a&&a<this.kd.c.length)&&(this.zb=a,this.p(u))});Q.prototype.__defineGetter__("indexZ",v("Ab"));Q.prototype.__defineSetter__("indexZ",function(a){x(a)&&(0<=a&&a<this.ld.c.length)&&(this.Ab=a,this.p(u))});
Q.prototype.__defineGetter__("windowLow",v("ka"));Q.prototype.__defineSetter__("windowLow",ea("ka"));Q.prototype.__defineGetter__("windowHigh",v("ja"));Q.prototype.__defineSetter__("windowHigh",ea("ja"));Q.prototype.__defineGetter__("borders",v("xb"));Q.prototype.__defineSetter__("borders",ea("xb"));Q.prototype.__defineGetter__("reslicing",v("rg"));Q.prototype.__defineSetter__("reslicing",ea("rg"));Q.prototype.__defineSetter__("xNormX",function(a){this.b[0].i[0]=a});
Q.prototype.__defineGetter__("xNormX",function(){return this.b[0].i[0]});Q.prototype.__defineSetter__("xNormY",function(a){this.b[0].i[1]=a});Q.prototype.__defineGetter__("xNormY",function(){return this.b[0].i[1]});Q.prototype.__defineSetter__("xNormZ",function(a){this.b[0].i[2]=a});Q.prototype.__defineGetter__("xNormZ",function(){return this.b[0].i[2]});Q.prototype.__defineSetter__("xColor",function(a){this.b[0].u=a});Q.prototype.__defineGetter__("xColor",function(){return this.b[0].u});
Q.prototype.__defineSetter__("yNormX",function(a){this.b[1].i[0]=a});Q.prototype.__defineGetter__("yNormX",function(){return this.b[1].i[0]});Q.prototype.__defineSetter__("yNormY",function(a){this.b[1].i[1]=a});Q.prototype.__defineGetter__("yNormY",function(){return this.b[1].i[1]});Q.prototype.__defineSetter__("yNormZ",function(a){this.b[1].i[2]=a});Q.prototype.__defineGetter__("yNormZ",function(){return this.b[1].i[2]});Q.prototype.__defineSetter__("yColor",function(a){this.b[1].u=a});
Q.prototype.__defineGetter__("yColor",function(){return this.b[1].u});Q.prototype.__defineSetter__("zNormX",function(a){this.b[2].i[0]=a});Q.prototype.__defineGetter__("zNormX",function(){return this.b[2].i[0]});Q.prototype.__defineSetter__("zNormY",function(a){this.b[2].i[1]=a});Q.prototype.__defineGetter__("zNormY",function(){return this.b[2].i[1]});Q.prototype.__defineSetter__("zNormZ",function(a){this.b[2].i[2]=a});Q.prototype.__defineGetter__("zNormZ",function(){return this.b[2].i[2]});
Q.prototype.__defineSetter__("zColor",function(a){this.b[2].u=a});Q.prototype.__defineGetter__("zColor",function(){return this.b[2].u});
Q.prototype.Kj=function(a){this.c[a].visible=u;for(var b=0;b<this.c[a].c.length;b++)"undefined"!=typeof this.c[a].c[b]&&(this.J&&(this.e.c[a].c[b].remove(),this.e.c[a].c[b]=t),this.c[a].c[b].remove(),this.c[a].c[b]=t);Nc(this.b[a].i,this.b[a].i);Xd(a,this.b[a].gd,this.b[a].i,this);this.c[a].c=[];this.c[a].c=Array(this.b[a].o);this.J&&(b=Vd(this.b[a].gd,this.b[a].Ca,this.b[a].i,this.b[a].u,this.ma,this.e.da,this.e,this.e.J,this.e.Aa.Fa),this.e.c[a].c=[],this.e.c[a].c=Array(this.b[a].o),this.e.c[a].c[Math.round(this.b[a].o/
2)]=b,this.e.c[a].p());b=Vd(this.b[a].gd,this.b[a].Ca,this.b[a].i,this.b[a].u,this.ma,this.da,this,q,t);this.J&&(b.e=b.D,b.e=this.e.c[a].c[Math.round(this.b[a].o/2)].D);this.c[a].c[Math.round(this.b[a].o/2)]=b;0==a?(this.yb=Math.round(this.b[a].o/2),this.xc=Math.round(this.b[a].o/2)):1==a?(this.zb=Math.round(this.b[a].o/2),this.yc=Math.round(this.b[a].o/2)):(this.Ab=Math.round(this.b[a].o/2),this.zc=Math.round(this.b[a].o/2));this.c[a].p();this.c[a].c[Math.round(this.b[a].o/2)].M=q};
function Xe(a,b){if(!a.Md)if(!a.Na||!a.j&&b==a.V)a.V=b;else if(-1==a.ug.indexOf(b)){a.ug.push(b);a.Md=q;var c=new Nd;c.L=a;a.dispatchEvent(c);a.onComputing(b);setTimeout(function(){var a=t;0<=this.V&&(a=this.c[this.V],a.visible=u);var a=this.c[b],c=a.c.length,e=Math.floor(c/4),d;for(d=0;d<1*e;d++){if(a.c[d]==t){var j=Kc();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*d;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*d;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*d;if(this.J){var k=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,
this.ma,this.e.da,this.e,this.e.J,this.e.Aa.Fa);this.e.c[b].c[d]=k;this.e.c[b].p(q)}j=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.da,this,q,t);j.c[0].M=u;this.J&&(j.e=j.D,j.e=this.e.c[b].c[d].D);a.c[d]=j}a.c[d].M=q}Ze(this,0.25);setTimeout(function(){for(;d<2*e;d++){if(a.c[d]==t){var j=Kc();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*d;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*d;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*d;if(this.J){var k=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.e.da,
this.e,this.e.J,this.e.Aa.Fa);this.e.c[b].c[d]=k;this.e.c[b].p(q)}j=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.da,this,q,t);j.c[0].M=u;this.J&&(j.e=j.D,j.e=this.e.c[b].c[d].D);a.c[d]=j}a.c[d].M=q}Ze(this,0.5);setTimeout(function(){for(;d<3*e;d++){if(a.c[d]==t){var j=Kc();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*d;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*d;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*d;if(this.J){var k=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.e.da,this.e,this.e.J,
this.e.Aa.Fa);this.e.c[b].c[d]=k;this.e.c[b].p(q)}j=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.da,this,q,t);j.c[0].M=u;this.J&&(j.e=j.D,j.e=this.e.c[b].c[d].D);a.c[d]=j}a.c[d].M=q}Ze(this,0.75);setTimeout(function(){for(d=3*e;d<c;d++){if(a.c[d]==t){var j=Kc();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*d;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*d;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*d;if(this.J){var k=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.e.da,this.e,this.e.J,this.e.Aa.Fa);
this.e.c[b].c[d]=k;this.e.c[b].p(q)}j=Vd(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ma,this.da,this,q,t);j.c[0].M=u;this.J&&(j.e=j.D,j.e=this.e.c[b].c[d].D);a.c[d]=j}a.c[d].M=q}Ze(this,1);setTimeout(function(){this.Md&&this.c[b].p(q);this.V=b;this.j=u;if(this.Md){var a=new Pd;a.L=this;this.dispatchEvent(a);this.onComputingEnd(b)}this.Md=u}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(a),10)}else{c=a.c[a.V];c.visible=u;var c=a.c[b],d=c.c.length,e;for(e=0;e<d;e++)c.c[e].M=q;
a.V=b;a.j=u}}function Ze(a,b){var c=new Od;c.qd=b;a.dispatchEvent(c);a.onComputingProgress(100*b)}Q.prototype.wf=da();Q.prototype.yf=da();Q.prototype.xf=da();B("X.volume",Q);B("X.volume.prototype.modified",Q.prototype.p);B("X.volume.prototype.sliceInfoChanged",Q.prototype.Kj);B("X.volume.prototype.onComputing",Q.prototype.wf);B("X.volume.prototype.onComputingProgress",Q.prototype.yf);B("X.volume.prototype.onComputingEnd",Q.prototype.xf);function $e(){Qd.call(this);this.g="parserSTL"}C($e,Qd);
$e.prototype.parse=function(a,b,c){D.$a(this.g+".parse");this.Q=c;var d=b.h,e=b.q;if("solid"==Sd(Y(this,"uchar",5))){b.h=d=new V(c.byteLength);b.q=e=new V(c.byteLength);var f=d,d=e,e=Y(this,"uchar",c.byteLength-5);c=e.length;var g=u,h=u,m=0,j;for(j=0;j<c;j++)if(10==e[j]){if(g||h){var k=Sd(e,m,j).split(" "),h=parseFloat(k[0]),l=parseFloat(k[1]),k=parseFloat(k[2]);g?(d.add(h,l,k),d.add(h,l,k),d.add(h,l,k)):f.add(h,l,k);h=g=u}}else 32==e[j-1]&&(102==e[j]?(m=j+=13,g=q):118==e[j]&&(m=j+=7,h=q))}else{this.S=
80;f=Y(this,"uint");b.h=d=new V(9*f);b.q=e=new V(9*f);for(c=c=0;c<f;c++)g=Y(this,"float",12),m=g[0],j=g[1],h=g[2],e.add(m,j,h),e.add(m,j,h),e.add(m,j,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.S+=2}D.Wa(this.g+".parse");f=new jd;f.L=b;f.C=a;this.dispatchEvent(f)};B("X.parserSTL",$e);B("X.parserSTL.prototype.parse",$e.prototype.parse);function af(){Qd.call(this);this.g="parserDCM"}C(af,Qd);
af.prototype.parse=function(a,b,c){c=this.Bd(c,b);if(c.pe==c.rb){var d=c.Nf.length,e,f=0;for(e=0;e<d;e++){var g=c.Nf[d-1-e];g!==p&&(g*=c.vb,c.data.set(c.td.subarray(g,g+c.vb),f*c.vb),f++)}b.T=[c.Ia[0],c.Ia[1],c.Ia[2]];Infinity==c.v[2]&&(1<c.location.length?(c.location.sort(function(a,b){return a-b}),c.v[2]=Math.abs(c.location[0]-c.location[1])):c.v[2]=1);d=[c.v[0],c.v[1],c.v[2]];b.md=d;f=Rd(c.data);e=f[0];f=f[1];c.min=b.fb=b.ka=e;c.max=b.oa=b.ja=f;-Infinity==b.ha&&(b.ha=e);Infinity==b.ia&&(b.ia=f);
e=0;f=c.Cd[0];for(g=0;++e<c.Cd.length;)c.Cd[e]>f&&(g=e,f=c.Cd[e]);f=c.gh[g].split("\\");g=Gc(new U(c.Sa[0],c.Sa[1],c.Sa[2]),new U(c.Sa[3],c.Sa[4],c.Sa[5]));e=Qc();Vc(e,0,-c.Sa[0]*c.v[0],-c.Sa[3]*c.v[1],-g.x*c.v[2],-f[0]);Vc(e,1,-c.Sa[1]*c.v[0],-c.Sa[4]*c.v[1],-g.y*c.v[2],-f[1]);Vc(e,2,c.Sa[2]*c.v[0],c.Sa[5]*c.v[1],g.d*c.v[2],f[2]);Vc(e,3,0,0,0,1);c.Ib=e;c.Jb=Qc();Zc(c.Ib,c.Jb);g=Pc(0,0,0,1);f=Oc();ad(e,g,f);g=Pc(d[0],d[1],d[2],1);d=Oc();ad(e,g,d);e=Td(e,[0,b.T[0],b.T[1],b.T[2]]);c.Jd=[d[0]-f[0],d[1]-
f[1],d[2]-f[2]];c.Hd=[e[1]-e[0],e[3]-e[2],e[5]-e[4]];c.Id=[e[0],e[2],e[4]];b.jc(c);b.Mb=Yd(this,b)}c=new jd;c.L=b;c.C=a;this.dispatchEvent(c)};
af.prototype.Bd=function(a,b){this.Q=a;var c=0;if(b.pc!=t){d=b.pc;e=Y(this,"ushort",this.Q.byteLength-2*d.vb);f=0;for(m=3;0<m;)if(g=e[f++],32==g)if(h=e[f++],19==h){f++;g=e[f++];for(h=0;h<g/2;h++)j=e[f++],k=j&255,j=(j&65280)>>8,c+=String.fromCharCode(k),c+=String.fromCharCode(j),c=parseInt(c,10);d.Cd.push(c);m--}else if(50==h){f++;g=e[f++];l="";for(h=0;h<g/2;h++)j=e[f++],k=j&255,j=(j&65280)>>8,l+=String.fromCharCode(k),l+=String.fromCharCode(j);d.gh.push(l);m--}else if(4161==h){f++;g=e[f++];l="";for(h=
0;h<g/2;h++)j=e[f++],k=j&255,j=(j&65280)>>8,l+=String.fromCharCode(k),l+=String.fromCharCode(j);d.location.push(l);m--}d.Ia[2]++}else{var d={rows:0,cols:0,v:t,$e:0,ai:0,rb:1,Vi:1,bl:t,pe:0,vb:0,td:t,Gf:0,Nf:[],data:t,min:Infinity,max:-Infinity,location:[],gh:[],Cd:[]};d.rb=b.r.length;d.rb==t&&(d.rb=1);for(var e=Y(this,"ushort",this.Q.byteLength),f=66,g=t,h=t,g=t,m=9;0<m;)if(g=e[f++],40==g)switch(h=e[f++],f++,g=e[f++],h){case 16:d.rows=e[f++];m--;break;case 17:d.cols=e[f++];m--;break;case 256:d.$e=
e[f++];m--;break;case 257:d.ai=e[f++];m--;break;case 2:d.Vi=e[f++];m--;break;case 48:l="";for(h=h=0;h<g/2;h++)var j=e[f++],k=j&255,j=(j&65280)>>8,l=l+String.fromCharCode(k),l=l+String.fromCharCode(j);l=l.split("\\");d.v=[parseFloat(l[0]),parseFloat(l[1]),Infinity];m--}else if(32==g)switch(h=e[f++],f++,g=e[f++],h){case 19:for(h=0;h<g/2;h++)j=e[f++],k=j&255,j=(j&65280)>>8,c+=String.fromCharCode(k),c+=String.fromCharCode(j),c=parseInt(c,10);m--;break;case 50:for(var l="",h=0;h<g/2;h++)j=e[f++],k=j&255,
j=(j&65280)>>8,l+=String.fromCharCode(k),l+=String.fromCharCode(j);l=l.split("\\");d.origin=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])];m--;break;case 55:l="";for(h=0;h<g/2;h++)j=e[f++],k=j&255,j=(j&65280)>>8,l+=String.fromCharCode(k),l+=String.fromCharCode(j);l=l.split("\\");d.Sa=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]),parseFloat(l[4]),parseFloat(l[5])];m--}else if(16==g)switch(h=e[f++],f++,g=e[f++],h){case 8720:for(h=0;h<g/2;h++)f++}b.pc=d;d.Ia=[d.cols,d.rows,
1];d.vb=d.rows*d.cols;switch(d.$e){case 8:d.td=new Uint8Array(d.cols*d.rows*d.rb);d.data=new Uint8Array(d.cols*d.rows*d.rb);break;case 16:d.td=new Uint16Array(d.cols*d.rows*d.rb);d.data=new Uint16Array(d.cols*d.rows*d.rb);break;case 32:d.td=new Uint32Array(d.cols*d.rows*d.rb),d.data=new Uint32Array(d.cols*d.rows*d.rb)}}this.S=this.Q.byteLength-2*d.vb;e=t;switch(d.$e){case 8:e=Y(this,"uchar",d.vb);break;case 16:e=Y(this,"ushort",d.vb);break;case 32:e=Y(this,"uint",d.vb)}d.Nf[c]=d.Gf;d.td.set(e,d.Gf*
d.vb);d.Gf++;++d.pe;return d};B("X.parserDCM",af);B("X.parserDCM.prototype.parse",af.prototype.parse);function bf(){Qd.call(this);this.g="parserVTK"}C(bf,Qd);
bf.prototype.parse=function(a,b,c){D.$a(this.g+".parse");var d=b.h,e=b.q,f=new Uint8Array(c),g="";b.h=d=new V(c.byteLength);b.q=e=new V(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=Sd(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.od=this.pd=t;this.dc=[];this.Ma=gd;this.Ne=this.Tb=this.Lb=this.Ub=u;c=0;for(h=g%8;h--;)cf(this,f[c]),c++;for(h=0.125*g^0;h--;)cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,
cf(this,f[c]),c++;c=this.pd;var f=this.od,g=f.length,m=h=this.dc.length;do{var j=this.dc[h-m],k=j.length,l;for(l=0;l<k&&!("LINES"==this.Ma&&l+1>=k);l++){var s=parseInt(j[l],10),r=c.get(s);d.add(r[0],r[1],r[2]);var z=s,y=r;"LINES"==this.Ma?(z=parseInt(j[l+1],10),y=c.get(z),d.add(y[0],y[1],y[2])):"TRIANGLE_STRIPS"==this.Ma&&(0==l||l==k-1)&&d.add(r[0],r[1],r[2]);s<g?(y=f.get(s),e.add(y[0],y[1],y[2]),"LINES"==this.Ma?(z=f.get(z),e.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.Ma&&(0==l||l==k-1)&&e.add(y[0],
y[1],y[2])):(z=new U(r[0],r[1],r[2]),z.normalize(),e.add(z.x,z.y,z.d),"LINES"==this.Ma?(z=new U(y[0],y[1],y[2]),z.normalize(),e.add(z.x,z.y,z.d)):"TRIANGLE_STRIPS"==this.Ma&&(0==l||l==k-1)&&e.add(z.x,z.y,z.d))}m--}while(0<m);b.Da=this.Ma;D.Wa(this.g+".parse");d=new jd;d.L=b;d.C=a;this.dispatchEvent(d)};
function cf(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.Ub=q;a.Lb=u;a.Tb=u;c=parseInt(c[1],10);a.pd=new V(3*c);a.od=new V(3*c);return;case "VERTICES":a.Lb=q;a.Ub=u;a.Tb=u;c=parseInt(c[1],10);3<=c?a.Ma=gd:1==c?a.Ma="POINTS":n(Error("This VTK file is not supported!"));a.dc=[];return;case "TRIANGLE_STRIPS":a.Lb=q;a.Ub=u;a.Tb=u;a.Ma="TRIANGLE_STRIPS";a.dc=[];return;case "LINES":a.Lb=q;a.Ub=u;a.Tb=u;a.Ma="LINES";a.dc=[];return;case "POLYGONS":a.Lb=q;
a.Ub=u;a.Tb=u;a.Ma="POLYGONS";a.dc=[];return;case "POINT_DATA":a.Tb=q;a.Ub=u;a.Lb=u;return}if(a.Ub)if(1==d||isNaN(parseFloat(e)))a.Ub=u;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.pd.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.pd.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.pd.add(d,e,c))}else a.Lb?1==d||isNaN(parseFloat(e))?a.Lb=u:(c=c.slice(1),a.dc.push(c)):a.Tb&&("NORMALS"==e?a.Ne=q:1==d||isNaN(parseFloat(e))?
(a.Tb=u,a.Ne=u):a.Ne&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.od.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.od.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.od.add(d,e,c))))}B("X.parserVTK",bf);B("X.parserVTK.prototype.parse",bf.prototype.parse);function df(){Qd.call(this);this.g="parserFSM";this.Sd=u}C(df,Qd);
df.prototype.parse=function(a,b,c){D.$a(this.g+".parse");this.Q=c;var d=b.h,e=b.q;b.Cc=[];var f=b.Cc;c=0;var g;do g=Y(this,"uchar"),c++;while(200>c&&10!=g);Y(this,"uchar");e=Y(this,"uint");c=Y(this,"uint");var h=Y(this,"float",3*e);g=Y(this,"uint",3*c);var m=new Uint32Array(e),j=new Float32Array(9*c);b.h=d=new V(9*c);b.q=e=new V(9*c);var k;for(k=0;k<c;k++){var l=3*k,s=g[l],r=g[l+1],z=g[l+2];f.push(s);f.push(r);f.push(z);m[s]+=1;m[r]+=1;m[z]+=1;var l=3*s,y=3*r,E=3*z,F=h[l],K=h[l+1],A=h[l+2],r=h[y],
z=h[y+1],s=h[y+2],G=h[E],I=h[E+1],H=h[E+2];d.add(F,K,A);d.add(r,z,s);d.add(G,I,H);F=new U(F,K,A);G=new U(G,I,H);r=(new U(r,z,s)).l().Ea(F);z=G.l().Ea(F);r=Gc(r,z).normalize();j[l]+=r.x;j[l+1]+=r.y;j[l+2]+=r.d;j[y]+=r.x;j[y+1]+=r.y;j[y+2]+=r.d;j[E]+=r.x;j[E+1]+=r.y;j[E+2]+=r.d}for(k=0;k<c;k++)l=3*k,s=g[l],r=g[l+1],z=g[l+2],l=3*s,y=3*r,E=3*z,f=new U(j[y],j[y+1],j[y+2]),h=new U(j[E],j[E+1],j[E+2]),l=(new U(j[l],j[l+1],j[l+2])).scale(1/m[s]).normalize(),f=f.scale(1/m[r]).normalize(),h=h.scale(1/m[z]).normalize(),
e.add(l.x,l.y,l.d),e.add(f.x,f.y,f.d),e.add(h.x,h.y,h.d);c=Y(this,"uchar",this.Q.byteLength-this.S);g=t;for(l=0;l<c.length;l++)if(99==c[l]&&114==c[l+1]&&97==c[l+2]&&115==c[l+3]){for(e=g=l+9;10!=c[l]&&l<c.length;)e++,l++;g=Sd(c.subarray(g,e)).split(" ");break}g&&(b.ea.wh(parseFloat(g[0])),b.ea.xh(parseFloat(g[1])),b.ea.yh(parseFloat(g[2])));b.Da=gd;D.Wa(this.g+".parse");c=new jd;c.L=b;c.C=a;this.dispatchEvent(c)};B("X.parserFSM",df);B("X.parserFSM.prototype.parse",df.prototype.parse);var ef={df:function(a,b,c){return ef.update(a,0,b,c)},update:function(a,b,c,d){var e=ef.Dh,f="number"===typeof c?c:c=0;d="number"===typeof d?d:a.length;b^=4294967295;for(f=d&7;f--;++c)b=b>>>8^e[(b^a[c])&255];for(f=d>>3;f--;c+=8)b=b>>>8^e[(b^a[c])&255],b=b>>>8^e[(b^a[c+1])&255],b=b>>>8^e[(b^a[c+2])&255],b=b>>>8^e[(b^a[c+3])&255],b=b>>>8^e[(b^a[c+4])&255],b=b>>>8^e[(b^a[c+5])&255],b=b>>>8^e[(b^a[c+6])&255],b=b>>>8^e[(b^a[c+7])&255];return(b^4294967295)>>>0}};
ef.Dh=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function ff(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,m,j,k,l,s;for(l=0;l<b;++l)a[l]>c&&(c=a[l]),a[l]<d&&(d=a[l]);e=1<<c;f=new Uint32Array(e);g=1;h=0;for(m=2;g<=c;){for(l=0;l<b;++l)if(a[l]===g){j=0;k=h;for(s=0;s<g;++s)j=j<<1|k&1,k>>=1;for(s=j;s<e;s+=m)f[s]=g<<16|l;++h}++g;h<<=1;m<<=1}return[f,c,d]};function gf(a,b){this.af=[];this.bf=32768;this.kb=this.rd=this.xa=this.Rf=0;this.input=new Uint8Array(a);this.wg=u;this.cf=hf;this.Fb=u;if(b||!(b={}))b.index&&(this.xa=b.index),b.bufferSize&&(this.bf=b.bufferSize),b.bufferType&&(this.cf=b.bufferType),b.resize&&(this.Fb=b.resize);switch(this.cf){case jf:this.ga=32768;this.Pa=new Uint8Array(32768+this.bf+258);break;case hf:this.ga=0;this.Pa=new Uint8Array(this.bf);this.lc=this.ni;this.zg=this.di;this.kf=this.hi;break;default:n(Error("invalid inflate mode"))}}
var jf=0,hf=1;
gf.prototype.ud=function(){for(;!this.wg;){var a=kf(this,3);a&1&&(this.wg=q);a>>>=1;switch(a){case 0:var a=this.input,b=this.xa,c=this.Pa,d=this.ga,e=p,f=p,g=p,h=c.length,e=p;this.kb=this.rd=0;e=a[b++];e===p&&n(Error("invalid uncompressed block header: LEN (first byte)"));f=e;e=a[b++];e===p&&n(Error("invalid uncompressed block header: LEN (second byte)"));f|=e<<8;e=a[b++];e===p&&n(Error("invalid uncompressed block header: NLEN (first byte)"));g=e;e=a[b++];e===p&&n(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
e<<8;f===~g&&n(Error("invalid uncompressed block header: length verify"));b+f>a.length&&n(Error("input buffer is broken"));switch(this.cf){case jf:for(;d+f>c.length;)e=h-d,f-=e,c.set(a.subarray(b,b+e),d),d+=e,b+=e,this.ga=d,c=this.lc(),d=this.ga;break;case hf:for(;d+f>c.length;)c=this.lc({Fg:2});break;default:n(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),d);d+=f;this.xa=b+=f;this.ga=d;this.Pa=c;break;case 1:this.kf(lf,mf);break;case 2:nf(this);break;default:n(Error("unknown BTYPE: "+a))}}return this.zg()};
var of=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),qf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),rf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),sf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),tf=new Uint8Array(288),
uf,vf;uf=0;for(vf=tf.length;uf<vf;++uf)tf[uf]=143>=uf?8:255>=uf?9:279>=uf?7:8;var lf=ff(tf),wf=new Uint8Array(30),xf,yf;xf=0;for(yf=wf.length;xf<yf;++xf)wf[xf]=5;var mf=ff(wf);function kf(a,b){for(var c=a.rd,d=a.kb,e=a.input,f=a.xa,g;d<b;)g=e[f++],g===p&&n(Error("input buffer is broken")),c|=g<<d,d+=8;g=c&(1<<b)-1;a.rd=c>>>b;a.kb=d-b;a.xa=f;return g}
function zf(a,b){for(var c=a.rd,d=a.kb,e=a.input,f=a.xa,g=b[0],h=b[1],m;d<h;)m=e[f++],m===p&&n(Error("input buffer is broken")),c|=m<<d,d+=8;e=g[c&(1<<h)-1];g=e>>>16;a.rd=c>>g;a.kb=d-g;a.xa=f;return e&65535}
function nf(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=zf(this,b),d){case 16:for(d=3+kf(this,2);d--;)c[f++]=e;break;case 17:for(d=3+kf(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+kf(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=kf(a,5)+257,d=kf(a,5)+1,e=kf(a,4)+4,f=new Uint8Array(of.length),g;for(g=0;g<e;++g)f[of[g]]=kf(a,3);e=ff(f);f=new Uint8Array(c);g=new Uint8Array(d);a.kf(ff(b.call(a,c,e,f)),ff(b.call(a,d,e,g)))}w=gf.prototype;
w.kf=function(a,b){var c=this.Pa,d=this.ga;this.Cg=a;for(var e=c.length-258,f,g,h;256!==(f=zf(this,a));)if(256>f)d>=e&&(this.ga=d,c=this.lc(),d=this.ga),c[d++]=f;else{f-=257;h=pf[f];0<qf[f]&&(h+=kf(this,qf[f]));f=zf(this,b);g=rf[f];0<sf[f]&&(g+=kf(this,sf[f]));d>=e&&(this.ga=d,c=this.lc(),d=this.ga);for(;h--;)c[d]=c[d++-g]}for(;8<=this.kb;)this.kb-=8,this.xa--;this.ga=d};
w.hi=function(a,b){var c=this.Pa,d=this.ga;this.Cg=a;for(var e=c.length,f,g,h;256!==(f=zf(this,a));)if(256>f)d>=e&&(c=this.lc(),e=c.length),c[d++]=f;else{f-=257;h=pf[f];0<qf[f]&&(h+=kf(this,qf[f]));f=zf(this,b);g=rf[f];0<sf[f]&&(g+=kf(this,sf[f]));d+h>e&&(c=this.lc(),e=c.length);for(;h--;)c[d]=c[d++-g]}for(;8<=this.kb;)this.kb-=8,this.xa--;this.ga=d};
w.lc=function(){var a=new Uint8Array(this.ga-32768),b=this.ga-32768,c=this.Pa;a.set(c.subarray(32768,a.length));this.af.push(a);this.Rf+=a.length;c.set(c.subarray(b,b+32768));this.ga=32768;return c};w.ni=function(a){var b=this.input.length/this.xa+1|0,c=this.input,d=this.Pa;a&&("number"===typeof a.Fg&&(b=a.Fg),"number"===typeof a.Xh&&(b+=a.Xh));2>b?(a=(c.length-this.xa)/this.Cg[2],a=258*(a/2)|0,a=a<d.length?d.length+a:d.length<<1):a=d.length*b;a=new Uint8Array(a);a.set(d);return this.Pa=a};
w.zg=function(){var a=0,b=this.Pa,c=this.af,d,e=new Uint8Array(this.Rf+(this.ga-32768)),f,g,h,m;if(0===c.length)return this.Pa.subarray(32768,this.ga);f=0;for(g=c.length;f<g;++f){d=c[f];h=0;for(m=d.length;h<m;++h)e[a++]=d[h]}f=32768;for(g=this.ga;f<g;++f)e[a++]=b[f];this.af=[];return this.buffer=e};w.di=function(){var a,b=this.ga;this.Fb?(a=new Uint8Array(b),a.set(this.Pa.subarray(0,b))):a=this.Pa.subarray(0,b);return this.buffer=a};new Uint8Array(256);var Af;for(Af=0;256>Af;++Af)for(var Bf=Af,Cf=7,Bf=Bf>>>1;Bf;Bf>>>=1)--Cf;var Df=[],Ef;for(Ef=0;288>Ef;Ef++)switch(q){case 143>=Ef:Df.push([Ef+48,8]);break;case 255>=Ef:Df.push([Ef-144+400,9]);break;case 279>=Ef:Df.push([Ef-256+0,7]);break;case 287>=Ef:Df.push([Ef-280+192,8]);break;default:n("invalid literal: "+Ef)}
function Ff(){var a=Gf;switch(q){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:n("invalid length: "+a)}}var Hf=[],Gf,If;
for(Gf=3;258>=Gf;Gf++)If=Ff(),Hf[Gf]=If[2]<<24|If[1]<<16|If[0];new Uint32Array(Hf);function Jf(){};function Kf(a){this.input=a;this.xa=0;this.member=[]}
Kf.prototype.ud=function(){for(var a=this.input.length;this.xa<a;){var b=new Jf,c=p,d=p,e=p,f=c=e=p,g=p,c=c=p,h=this.input,d=this.xa;b.Lg=h[d++];b.Mg=h[d++];(31!==b.Lg||139!==b.Mg)&&n(Error("invalid file signature:",b.Lg,b.Mg));b.yg=h[d++];switch(b.yg){case 8:break;default:n(Error("unknown compression method: "+b.yg))}b.he=h[d++];c=h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24;b.el=new Date(1E3*c);b.il=h[d++];b.fl=h[d++];0<(b.he&4)&&(b.Uj=h[d++]|h[d++]<<8,d+=b.Uj);if(0<(b.he&8)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.he&16)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.he&2)&&(b.ei=ef.df(h,0,d)&65535,b.ei!==(h[d++]|h[d++]<<8)&&n(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-d-4-4<512*c&&(e=c);d=new gf(h,{index:d,bufferSize:e});b.data=e=d.ud();d=d.xa;b.Wk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;ef.df(e)!==c&&n(Error("invalid CRC-32 checksum: 0x"+ef.df(e).toString(16)+
" / 0x"+c.toString(16)));b.al=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;(e.length&4294967295)!==c&&n(Error("invalid input size: "+(e.length&4294967295)+" / "+c));this.member.push(b);this.xa=d}a=this.member;b=e=d=0;for(h=a.length;b<h;++b)e+=a[b].data.length;e=new Uint8Array(e);for(b=0;b<h;++b)e.set(a[b].data,d),d+=a[b].data.length;return e};function Lf(){Qd.call(this);this.g="parserMGZ";this.Sd=u}C(Lf,Qd);
Lf.prototype.parse=function(a,b,c,d){D.$a(this.g+".parse");d&&(c=(new Kf(new Uint8Array(c))).ud(),c=c.buffer);d=this.Bd(c);var e=[d.sf,d.tf,d.uf];b.T=e;c=d.zh;b.md=c;var f=d.min,g=d.max;b.fb=b.ka=f;b.oa=b.ja=g;-Infinity==b.ha&&(b.ha=f);Infinity==b.ia&&(b.ia=g);f=Qc();Vc(f,0,d.Za[0][0],d.Za[1][0],d.Za[2][0],0);Vc(f,1,d.Za[0][1],d.Za[1][1],d.Za[2][1],0);Vc(f,2,d.Za[0][2],d.Za[1][2],d.Za[2][2],0);Vc(f,3,0,0,0,1);for(var g=e[0]/2,h=e[1]/2,m=e[2]/2,e=[0,0,0],j=0;3>j;++j)e[j]=d.Za[3][j]-(f[j+0]*c[0]*g+
f[j+4]*c[1]*h+f[j+8]*c[2]*m);g=e[1];h=e[2];f[12]=e[0];f[13]=g;f[14]=h;f[15]=1;d.Ib=f;d.Jb=Qc();Zc(d.Ib,d.Jb);g=Pc(0,0,0,1);e=Oc();ad(f,g,e);g=Pc(c[0],c[1],c[2],1);c=Oc();ad(f,g,c);f=Td(f,[0,b.T[0],b.T[1],b.T[2]]);d.Jd=[c[0]-e[0],c[1]-e[1],c[2]-e[2]];d.Hd=[f[1]-f[0],f[3]-f[2],f[5]-f[4]];d.Id=[f[0],f[2],f[4]];b.jc(d);D.Wa(this.g+".parse");b.Mb=Yd(this,b);d=new jd;d.L=b;d.C=a;this.dispatchEvent(d)};
Lf.prototype.Bd=function(a){this.Q=a;a={version:0,Gh:0,Eh:0,ti:0,Fh:0,sf:0,tf:0,uf:0,Ui:0,type:0,li:0,ph:0,$j:t,Za:t,zh:t,data:t,min:Infinity,max:-Infinity};a.version=Y(this,"uint");a.sf=Y(this,"uint");a.tf=Y(this,"uint");a.uf=Y(this,"uint");a.Ui=Y(this,"uint");a.type=Y(this,"uint");a.li=Y(this,"uint");a.ph=Y(this,"ushort");if(0<a.ph){a.zh=Y(this,"float",3);var b=[];b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));a.Za=b}this.S=284;b=a.sf*a.tf*
a.uf;switch(a.type){case 0:a.data=Y(this,"uchar",b);break;case 1:a.data=Y(this,"uint",b);break;case 3:a.data=Y(this,"float",b);break;case 4:a.data=Y(this,"ushort",b);break;default:n(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Rd(a.data);a.min=b[0];a.max=b[1];this.S+16<this.Q.byteLength&&(a.Gh=Y(this,"float"),a.ti=Y(this,"float"),a.Eh=Y(this,"float"),a.Fh=Y(this,"float"));return a};B("X.parserMGZ",Lf);B("X.parserMGZ.prototype.parse",Lf.prototype.parse);function Mf(){Qd.call(this);this.g="parserCRV";this.Sd=u}C(Mf,Qd);
Mf.prototype.parse=function(a,b,c){D.$a(this.g+".parse");var d=b.Cc;0==d.length&&n(Error("No _pointIndices defined on the X.object."));this.Q=c;this.S=3;var e=Y(this,"uint");Y(this,"uint");Y(this,"uint");var f=0,g=0,h=0,m=0,j=0,k=0,l=0,s=0,r=0,z=0,y=0;c=Array(2);var E=Array(2),F=Y(this,"float",e),K;for(K=0;K<e;K++){var A=F[K];0==K&&(c[0]=E[0]=A);0<=A?(f++,m+=A):(g++,h+=A);r+=A;y++;E[0]=Math.max(A,E[0]);c[0]=Math.min(A,c[0]);F[K]=A}0!=f&&(j=m/f);0!=g&&(k=h/g);0!=y&&(z=r/y);for(y=r=h=m=0;y<e;y++)A=
F[y],K=0,0<=A?(K=Math.pow(A-j,2),m+=K):(K=Math.pow(A-k,2),h+=K),K=Math.pow(A-z,2),r+=K;1<f&&(l=Math.sqrt(m/(f-1)));1<g&&(s=Math.sqrt(h/(g-1)));c[1]=k-2.5*s;E[1]=j+2.5*l;e=d.length;f=new Float32Array(3*e);for(y=0;y<e;y++)g=F[d[y]],h=3*y,f[h]=g,f[h+1]=g,f[h+2]=g;b.H.fb=c[1];b.H.oa=E[1];-Infinity==b.H.ha&&(b.H.ha=c[1]);Infinity==b.H.ia&&(b.H.ia=E[1]);b.H.G=F;b.H.Rc=f;b.H.j=q;D.Wa(this.g+".parse");d=new jd;d.L=b;d.C=a;this.dispatchEvent(d)};B("X.parserCRV",Mf);B("X.parserCRV.prototype.parse",Mf.prototype.parse);function Nf(){Qd.call(this);this.g="parserTRK"}C(Nf,Qd);
Nf.prototype.parse=function(a,b,c){D.$a(this.g+".parse");var d=b.h,e=b.q,f=b.na;this.Q=c;Y(this,"uchar",6);Y(this,"ushort",3);var g=Y(this,"float",3);Y(this,"float",3);var h=Y(this,"ushort");Y(this,"uchar",200);Y(this,"ushort");Y(this,"uchar",200);c=Y(this,"float",16);Y(this,"uchar",444);Y(this,"uchar",4);Y(this,"uchar",4);Y(this,"float",6);Y(this,"uchar",2);Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");var m=Y(this,"uint");Y(this,"uint");var j=Y(this,
"uint"),k=[],l=[],s=Infinity,r=-Infinity,z=t,y=t,E=t,F=t,e=d=t,K=Y(this,"uint",(this.Q.byteLength-1E3)/4);this.S=j;for(var A=Y(this,"float",(this.Q.byteLength-1E3)/4),G=0,j=f=0;j<m;j++){for(var I=K[G],H=new V(3*I),R=0,M=0;M<I;M++){var S=A[G+3*M+M*h+1],aa=A[G+3*M+M*h+2],Z=A[G+3*M+M*h+3],S=S/g[0],aa=aa/g[1],Z=Z/g[2];H.add(S,aa,Z);if(0<M)var ba=H.get(M-1),R=R+Math.sqrt(Math.pow(S-ba[0],2)+Math.pow(aa-ba[1],2)+Math.pow(Z-ba[2],2));M<I-1&&(f+=6)}G+=3*I+I*h+1;M=H.gb;I=H.bb;S=H.hb;aa=H.cb;Z=H.ib;ba=H.eb;
if(!z||M<z)z=M;if(!y||I>y)y=I;if(!E||S<E)E=S;if(!F||aa>F)F=aa;if(!d||Z<d)d=Z;if(!e||ba>e)e=ba;k.push(H);l.push(R)}g=(z+y)/2;E=(E+F)/2;h=(d+e)/2;F=new Float32Array(f);b.h=d=new V(f);b.q=e=new V(f);b.na=f=new V(f);for(j=z=0;j<m;j++){y=k[j];K=y.count;R=l[j];s=Math.min(s,R);r=Math.max(r,R);for(M=0;M<K-1;M++){G=y.get(M);A=y.get(M+1);d.add(G[0],G[1],G[2]);d.add(A[0],A[1],A[2]);var H=G[0]-g,I=G[1]-E,S=G[2]-h,aa=Math.sqrt(H*H+I*I+S*S),Z=A[0]-g,ba=A[1]-E,L=A[2]-h,T=Math.sqrt(Z*Z+ba*ba+L*L);e.add(H/aa,I/aa,
S/aa);e.add(Z/T,ba/T,L/T);A=[Math.abs(A[0]-G[0]),Math.abs(A[1]-G[1]),Math.abs(A[2]-G[2])];G=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]);A[0]/=G;A[1]/=G;A[2]/=G;f.add(A[0],A[1],A[2]);f.add(A[0],A[1],A[2]);F[z++]=R;F[z++]=R;F[z++]=R;F[z++]=R;F[z++]=R;F[z++]=R}}b.Da="LINES";m=new id;m.fb=s;m.oa=r;m.ha=s;m.ia=r;m.Rc=F;m.qg=u;m.j=q;b.H=m;D.Wa(this.g+".parse");D.f.Sf(c,b.ea.O);c=new jd;c.L=b;c.C=a;this.dispatchEvent(c)};B("X.parserTRK",Nf);B("X.parserTRK.prototype.parse",Nf.prototype.parse);function Of(){Qd.call(this);this.g="parserIMAGE"}C(Of,Qd);Of.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||n(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;Zb(f,"load",this.yj.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Of.prototype.yj=function(a,b,c){b.Mb=a;b.Wb=t;a=new jd;a.L=c;a.C=b;this.dispatchEvent(a)};B("X.parserIMAGE",Of);B("X.parserIMAGE.prototype.parse",Of.prototype.parse);function Pf(){Qd.call(this);this.g="parserLUT"}C(Pf,Qd);
Pf.prototype.parse=function(a,b,c){D.$a(this.g+".parse");this.Q=c;c=Y(this,"uchar",c.byteLength);var d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=Sd(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}D.Wa(this.g+".parse");c=new jd;c.L=b;c.C=a;this.dispatchEvent(c)};
B("X.parserLUT",Pf);B("X.parserLUT.prototype.parse",Pf.prototype.parse);function Qf(){Qd.call(this);this.g="parserNRRD"}C(Qf,Qd);
Qf.prototype.parse=function(a,b,c){D.$a(this.g+".parse");this.Q=c;c=Y(this,"uchar",c.byteLength);var d=c.length,e=t,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=Sd(c,0,g-2);f=g+1;break}var h,m,j,k,d=e.split(/\r?\n/),e=0;for(g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Mi=q;else if(!h.match(/^#/)&&(k=h.match(/(.*):(.*)/)))m=k[1].trim(),h=k[2].trim(),(j=this.pi[m])?j.call(this,h):this[m]=h;this.Mi||n(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
n(Error("Only raw or gz/gzip encoding is allowed"));if(!this.ca&&(this.ca=[new U(1,0,0),new U(0,1,0),new U(0,0,1)],this.Pf)){d=[];for(k=0;2>=k;k++)d.push(!isNaN(this.Pf[k])?this.ca[k].scale(this.Pf[k]):p)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new Kf(new Uint8Array(f))).ud();f=f.buffer;c={data:t,min:Infinity,max:-Infinity};c.data=new this.Kb(f);f=Rd(c.data);e=c.min=f[0];g=c.max=f[1];b.fb=b.ka=e;b.oa=b.ja=g;b.T=[this.Lf[0],this.Lf[1],this.Lf[2]];f=(new U(this.ca[0][0],this.ca[0][1],
this.ca[0][2])).Eb();k=(new U(this.ca[1][0],this.ca[1][1],this.ca[1][2])).Eb();d=(new U(this.ca[2][0],this.ca[2][1],this.ca[2][2])).Eb();b.md=[f,k,d];-Infinity==b.ha&&(b.ha=e);Infinity==b.ia&&(b.ia=g);h=g=1;"left-posterior-superior"==this.sh&&(h=g=-1);e=Rc();Vc(e,0,g*this.ca[0][0],g*this.ca[1][0],g*this.ca[2][0],g*this.Of[0]);Vc(e,1,h*this.ca[0][1],h*this.ca[1][1],h*this.ca[2][1],h*this.Of[1]);Vc(e,2,1*this.ca[0][2],1*this.ca[1][2],1*this.ca[2][2],1*this.Of[2]);Vc(e,3,0,0,0,1);c.Ib=e;c.Jb=Qc();Zc(c.Ib,
c.Jb);h=Pc(0,0,0,1);g=Oc();ad(e,h,g);k=Pc(f,k,d,1);f=Oc();ad(e,k,f);k=Td(e,[0,b.T[0],b.T[1],b.T[2]]);c.Jd=[f[0]-g[0],f[1]-g[1],f[2]-g[2]];c.Hd=[k[1]-k[0],k[3]-k[2],k[5]-k[4]];c.Id=[k[0],k[2],k[4]];b.jc(c);D.Wa(this.g+".parse");b.Mb=Yd(this,b);c=new jd;c.L=b;c.C=a;this.dispatchEvent(c)};
Qf.prototype.pi={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Kb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Kb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Kb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Kb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Kb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Kb=Uint32Array;break;case "float":this.Kb=Float32Array;break;case "double":this.Kb=Float64Array;break;default:n(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.Zk=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.Ia=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));
return this.Lf=e},space:function(a){return this.sh=a},"space origin":function(a){return this.Of=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.ca=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];c=0;for(d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));
return this.Pf=e}};B("X.parserNRRD",Qf);B("X.parserNRRD.prototype.parse",Qf.prototype.parse);function Rf(){Qd.call(this);this.g="parserNII"}C(Rf,Qd);
Rf.prototype.parse=function(a,b,c){var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,q);348!=e&&(d=(new Kf(new Uint8Array(d))).ud(),d=d.buffer);c=this.Bd(d);d=c.min;e=c.max;b.fb=b.ka=d;b.oa=b.ja=e;-Infinity==b.ha&&(b.ha=d);Infinity==b.ia&&(b.ia=e);d=Qc();Vc(d,3,0,0,0,1);if(0==c.Hf)Vc(d,0,c.v[1],0,0,0),Vc(d,0,0,c.v[2],0,0),Vc(d,0,0,0,c.v[3],0);else if(0<c.Hf){var e=0,f=c.mh,g=c.nh,h=c.oh,m=1,j=1,k=1,l=c.jh,s=c.kh,r=c.lh,e=1-(f*f+g*g+h*h);1E-7>e?(e=
1/Math.sqrt(f*f+g*g+h*h),f*=e,g*=e,h*=e,e=0):e=Math.sqrt(e);0<c.v[1]&&(m=c.v[1]);0<c.v[2]&&(j=c.v[2]);0<c.v[2]&&(k=c.v[3]);0>c.v[0]&&(k=-k);Vc(d,0,(e*e+f*f-g*g-h*h)*m,2*(f*g-e*h)*j,2*(f*h+e*g)*k,l);Vc(d,1,2*(f*g+e*h)*m,(e*e+g*g-f*f-h*h)*j,2*(g*h-e*f)*k,s);Vc(d,2,2*(f*h-e*g)*m,2*(g*h+e*f)*j,(e*e+h*h-g*g-f*f)*k,r)}else 0<c.qh?(e=c.th,f=c.uh,g=c.vh,Vc(d,0,e[0],e[1],e[2],e[3]),Vc(d,1,f[0],f[1],f[2],f[3]),Vc(d,2,g[0],g[1],g[2],g[3])):window.console.log("UNKNOWN METHOD IN PARSER NII");c.Ib=d;c.Jb=Qc();
Zc(c.Ib,c.Jb);f=Pc(0,0,0,1);e=Oc();ad(d,f,e);g=Pc(c.v[1],c.v[2],c.v[3],1);f=Oc();ad(d,g,f);d=Td(d,c.Ia);c.Jd=[f[0]-e[0],f[1]-e[1],f[2]-e[2]];c.Hd=[d[1]-d[0],d[3]-d[2],d[5]-d[4]];c.Id=[d[0],d[2],d[4]];b.T=[c.Ia[1],c.Ia[2],c.Ia[3]];b.jc(c);b.Mb=Yd(this,b);c=new jd;c.L=b;c.C=a;this.dispatchEvent(c)};
Rf.prototype.Bd=function(a){this.Q=a;a={Jj:0,fi:t,gi:t,oi:0,Hj:0,Cj:0,ki:t,Ia:t,Ii:0,Ji:0,Ki:0,Gi:0,jf:0,$h:0,Oj:0,v:t,Ah:0,Gj:0,Fj:0,Nj:0,Lj:t,Vj:t,bi:0,ci:0,Mj:0,Sj:0,vi:0,wi:0,ii:t,Zh:t,Hf:0,qh:0,mh:0,nh:0,oh:0,jh:0,kh:0,lh:0,th:t,uh:t,vh:t,Hi:t,Oi:t,data:t,min:Infinity,max:-Infinity};a.Jj=Y(this,"uint");a.fi=Y(this,"uchar",10);a.gi=Y(this,"uchar",18);a.oi=Y(this,"uint");a.Hj=Y(this,"ushort");a.Cj=Y(this,"uchar");a.ki=Y(this,"uchar");a.Ia=Y(this,"ushort",8);a.Ii=Y(this,"float");a.Ji=Y(this,"float");
a.Ki=Y(this,"float");a.Gi=Y(this,"ushort");a.jf=Y(this,"ushort");a.$h=Y(this,"ushort");a.Oj=Y(this,"ushort");a.v=Y(this,"float",8);a.Ah=Y(this,"float");a.Gj=Y(this,"float");a.Fj=Y(this,"float");a.Nj=Y(this,"ushort");a.Lj=Y(this,"uchar");a.Vj=Y(this,"uchar");a.bi=Y(this,"float");a.ci=Y(this,"float");a.Mj=Y(this,"float");a.Sj=Y(this,"float");a.vi=Y(this,"uint",1);a.wi=Y(this,"uint",1);a.ii=Y(this,"uchar",80);a.Zh=Y(this,"uchar",24);a.Hf=Y(this,"ushort");a.qh=Y(this,"ushort");a.mh=Y(this,"float");a.nh=
Y(this,"float");a.oh=Y(this,"float");a.jh=Y(this,"float");a.kh=Y(this,"float");a.lh=Y(this,"float");a.th=Y(this,"float",4);a.uh=Y(this,"float",4);a.vh=Y(this,"float",4);a.Hi=Y(this,"uchar",16);a.Oi=Y(this,"uchar",4);this.S=parseInt(a.Ah,10);var b=a.Ia[1]*a.Ia[2]*a.Ia[3];switch(a.jf){case 2:a.data=Y(this,"uchar",b);break;case 4:a.data=Y(this,"sshort",b);break;case 8:a.data=Y(this,"sint",b);break;case 16:a.data=Y(this,"float",b);break;case 32:a.data=Y(this,"complex",b);break;case 64:a.data=Y(this,"double",
b);break;case 256:a.data=Y(this,"schar",b);break;case 512:a.data=Y(this,"ushort",b);break;case 768:a.data=Y(this,"uint",b);break;default:n(Error("Unsupported NII data type: "+a.jf))}b=Rd(a.data);a.min=b[0];a.max=b[1];return a};B("X.parserNII",Rf);B("X.parserNII.prototype.parse",Rf.prototype.parse);function Sf(){Qd.call(this);this.g="parserOBJ"}C(Sf,Qd);
Sf.prototype.parse=function(a,b,c){D.$a(this.g+".parse");this.Q=c;c=c.byteLength;var d=Y(this,"uchar",c),e=[];b.h=new V(c);b.q=new V(c);var f=b.h,g=b.q,h=0,m;for(m=0;m<c;++m)if(10==d[m]){var j=Sd(d,h,m).replace(/\s{2,}/g," ").split(" ");if("v"==j[0])e.push([parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3])]);else if("f"==j[0]){var k=e[parseInt(j[1],10)-1],h=e[parseInt(j[2],10)-1],j=e[parseInt(j[3],10)-1];f.add(k[0],k[1],k[2]);f.add(h[0],h[1],h[2]);f.add(j[0],j[1],j[2]);k=new U(k[0],k[1],k[2]);j=
new U(j[0],j[1],j[2]);h=Gc((new U(h[0],h[1],h[2])).Ea(k),j.Ea(k));h.normalize();g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d)}h=m+1}D.Wa(this.g+".parse");c=new jd;c.L=b;c.C=a;this.dispatchEvent(c)};B("X.parserOBJ",Sf);B("X.parserOBJ.prototype.parse",Sf.prototype.parse);function Tf(){O.call(this);this.g="loader";this.Ac=new xc;this.dd=0}C(Tf,O);function Uf(a,b){a.dd+=b/a.Ac.ie()/3;a.dd=Math.min(1,a.dd);var c=new Md;c.qd=a.dd;a.dispatchEvent(c)}function Vf(a){a=a.r.Wd;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Wf||n(Error("The "+b+" file format is not supported."));return[a,b,Wf[b][0],Wf[b][1],Wf[b][2]]}
Tf.prototype.load=function(a,b){(!a||!b)&&n(Error("No container or object to load."));if(!Ac(this.Ac.ba,a.ta)||this.Ac.get(a.ta)){this.Ac.set(a.ta,u);var c=Vf(a)[0];if(a.nb!=t)this.parse(t,a,b);else{var d=new XMLHttpRequest;N(d,"abort",this.Eg.bind(this,d,a,b));N(d,"error",this.Eg.bind(this,d,a,b));N(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,q);d.responseType="arraybuffer";d.send(t)}}};
Tf.prototype.parse=function(a,b,c){Uf(this,1);setTimeout(function(){var d=Vf(b),e=d[3],d=new d[2];Zb(d,wd,this.complete.bind(this));var f=b.nb;f==t&&(f=a.response,b.nb=f);d.parse(b,c,f,e)}.bind(this),100)};Tf.prototype.complete=function(a){Uf(this,1);setTimeout(function(){var b=a.C,c=a.L;b.r.j=u;b.j=q;c.p();this.Ac.set(b.ta,q)}.bind(this),100)};Tf.prototype.Eg=function(a,b,c){n(Error("Loading failed: ",b,c))};
var Wf={OBJ:[Sf,t],STL:[$e,t],VTK:[bf,t],TRK:[Nf,t],FSM:[df,t],INFLATED:[df,t],SMOOTHWM:[df,t],SPHERE:[df,t],PIAL:[df,t],ORIG:[df,t],NRRD:[Qf,t],NII:[Rf,t],GZ:[Rf,t],DCM:[af,t],DICOM:[af,t],"":[af,t],CRV:[Mf,t],LABEL:[Zd,t],MGH:[Lf,u],MGZ:[Lf,q],TXT:[Pf,t],LUT:[Pf,t],PNG:[Of,"png"],JPG:[Of,"jpeg"],JPEG:[Of,"jpeg"],GIF:[Of,"gif"]};function Xf(a,b){(!x(a)||!x(b))&&n(Error("A camera needs valid width and height values."));O.call(this);this.g="camera";this.ec=new D.m(0,100,0);this.uc=new D.m(0,0,0);this.aa=new D.m(0,0,1);this.I=a;this.w=b;this.n=this.re(this.ec,this.uc)}C(Xf,O);Xf.prototype.observe=function(a){(a==t||!(a instanceof Qe))&&n(Error("Could not observe the interactor."));N(a,rd,this.jj.bind(this));N(a,qd,this.gj.bind(this));N(a,sd,this.wj.bind(this))};
Xf.prototype.jj=function(a){a instanceof Gd||n(Error("Received no valid rotate event."));this.rotate(a.sa)};Xf.prototype.wj=function(a){a instanceof Hd||n(Error("Received no valid zoom event."));a.ob?this.Wf(a.ab):this.Xf(a.ab)};Xf.prototype.gj=function(a){a instanceof Fd||n(Error("Received no valid pan event."));this.Df(a.sa)};Xf.prototype.__defineGetter__("view",v("n"));
Xf.prototype.__defineSetter__("view",function(a){(a==t||!(a instanceof Float32Array))&&n(Error("Invalid view matrix."));this.n=a});Xf.prototype.__defineGetter__("position",function(){return[this.ec.x,this.ec.y,this.ec.d]});Xf.prototype.__defineSetter__("position",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid position."));this.ec=new D.m(a[0],a[1],a[2]);this.reset()});Xf.prototype.__defineGetter__("focus",function(){return[this.uc.x,this.uc.y,this.uc.d]});
Xf.prototype.__defineSetter__("focus",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid focus"));this.uc=new D.m(a[0],a[1],a[2]);this.reset()});Xf.prototype.__defineGetter__("up",function(){return[this.aa.x,this.aa.y,this.aa.d]});Xf.prototype.__defineSetter__("up",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid up vector."));this.aa=new D.m(a[0],a[1],a[2]);this.reset()});w=Xf.prototype;w.reset=function(){this.n=this.re(this.ec,this.uc)};
w.rotate=function(a){ja(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||n(Error("Invalid distance vector for rotate operation."));return a};w.Df=function(a){ja(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||n(Error("Invalid distance vector for pan operation."));this.n[12]-=a.x;this.n[13]+=a.y};w.Wf=function(a){var b=20;a!=t&&!a&&(b=1);this.n[14]+=b};w.Xf=function(a){var b=20;a!=t&&!a&&(b=1);this.n[14]-=b};
w.re=function(a,b){(!(a instanceof D.m)||!(b instanceof D.m))&&n(Error("3D vectors required for calculating the view."));return D.f.wd()};B("X.camera",Xf);B("X.camera.prototype.pan",Xf.prototype.Df);B("X.camera.prototype.rotate",Xf.prototype.rotate);B("X.camera.prototype.zoomIn",Xf.prototype.Wf);B("X.camera.prototype.zoomOut",Xf.prototype.Xf);function Yf(a){function b(a,b,d){b=2*b*Math.PI;b=ya(Aa(m,Math.cos(b)),Aa(j,Math.sin(b)));a=ya(ya(c,Aa(e,a)),Aa(b,f));d=ya(Aa(b,1-Math.abs(d)),Aa(g,d));return new ic(a,d)}this.X=[];a=a||{};var c=new xa(a.start||[0,-1,0]),d=new xa(a.end||[0,1,0]),e=Ba(d,c),f=a.sb||1;a=a.Mf||16;for(var g=Ca(e),h=0.5<Math.abs(g.y()),m=Ca((new xa(h,!h,0)).kc(g)),j=Ca(m.kc(g)),h=new ic(c,Da(g)),d=new ic(d,Ca(g)),k=[],l=0;l<a;l++){var s=l/a,r=(l+1)/a;k.push(new kc([h,b(0,s,-1),b(0,r,-1)]));k.push(new kc([b(0,r,0),b(0,s,
0),b(1,s,0),b(1,r,0)]));k.push(new kc([d,b(1,r,1),b(1,s,1)]))}return sc(k)}C(Yf,rc);function Zf(){W.call(this);this.g="cylinder";this.We=[-10,-10,-10];this.Fe=[10,10,10];this.fc=10;this.Ya=32;Fa(this,new md)}C(Zf,W);Zf.prototype.__defineGetter__("start",v("We"));Zf.prototype.__defineSetter__("start",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid start"));this.We=a});Zf.prototype.__defineGetter__("end",v("Fe"));Zf.prototype.__defineSetter__("end",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid end"));this.Fe=a});Zf.prototype.__defineGetter__("radius",v("fc"));
Zf.prototype.__defineSetter__("radius",function(a){x(a)||n(Error("Invalid radius."));this.fc=a});Zf.prototype.p=function(){od(this,new Yf({start:this.We,end:this.Fe,sb:this.fc,Mf:this.Ya}));Zf.A.p.call(this)};B("X.cylinder",Zf);B("X.cylinder.prototype.modified",Zf.prototype.p);function $f(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var e=new xa(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new ic(ya(c,Aa(e,d)),e))}this.X=[];a=a||{};var c=new xa(a.ef||[0,0,0]),d=a.sb||1,e=a.Mf||16;a=a.Pj||8;for(var f=[],g=[],h=0;h<e;h++)for(var m=0;m<a;m++)g=[],b(h/e,m/a),0<m&&b((h+1)/e,m/a),m<a-1&&b((h+1)/e,(m+1)/a),b(h/e,(m+1)/a),f.push(new kc(g));return sc(f)}C($f,rc);function ag(){W.call(this);this.g="sphere";this.B=[0,0,0];this.fc=5;this.Ya=32;this.Rh=16;Fa(this,new md)}C(ag,W);ag.prototype.__defineGetter__("center",v("B"));ag.prototype.__defineSetter__("center",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid center"));this.B=a});ag.prototype.__defineGetter__("radius",v("fc"));ag.prototype.__defineSetter__("radius",function(a){x(a)||n(Error("Invalid radius."));this.fc=a});
ag.prototype.p=function(){od(this,new $f({ef:this.B,sb:this.fc,Mf:this.Ya,Pj:this.Rh}));ag.A.p.call(this)};B("X.sphere",ag);B("X.sphere.prototype.modified",ag.prototype.p);function Ye(a){Q.call(this);this.g="labelmap";this.Cb=a;this.Ve=new Float32Array([-255,-255,-255,-255])}C(Ye,Q);Ye.prototype.p=function(){var a=new jd;a.L=this;this.dispatchEvent(a);this.Cb.p()};Ye.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];a!=t&&(ja(a)&&4==a.length?b=a:(this.Aa||n(Error("No colortable assigned.")),b=this.Aa.Fa.get(a).slice(1,5)));this.Ve=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])});
B("X.labelmap",Ye);function bg(a){this.X=[];a=a||{};var b=new xa(a.ef||[0,0,0]),c=!a.sb?[1,1,1]:a.sb.length?a.sb:[a.sb,a.sb,a.sb];return sc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new kc(a[0].map(function(e){e=new xa(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.d()+c[2]*(2*!!(e&4)-1));return new ic(e,new xa(a[1]))}))}))}C(bg,rc);function cg(){W.call(this);this.g="cube";this.B=[0,0,0];this.Ke=this.Je=this.Ie=20;this.Hc=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Fa(this,new md)}C(cg,W);cg.prototype.__defineGetter__("center",v("B"));cg.prototype.__defineSetter__("center",function(a){(a==t||!ja(a)||3!=a.length)&&n(Error("Invalid center"));this.B=a});cg.prototype.__defineGetter__("lengthX",v("Ie"));
cg.prototype.__defineSetter__("lengthX",function(a){x(a)||n(Error("Invalid lengthX."));this.Ie=a});cg.prototype.__defineGetter__("lengthY",v("Je"));cg.prototype.__defineSetter__("lengthY",function(a){x(a)||n(Error("Invalid lengthY."));this.Je=a});cg.prototype.__defineGetter__("lengthZ",v("Ke"));cg.prototype.__defineSetter__("lengthZ",function(a){x(a)||n(Error("Invalid lengthZ."));this.Ke=a});cg.prototype.p=function(){od(this,new bg({ef:this.B,sb:[this.Ie/2,this.Je/2,this.Ke/2]}));cg.A.p.call(this)};
B("X.cube",cg);B("X.cube.prototype.modified",cg.prototype.p);function Se(a){Qe.call(this,a);this.g="interactor3D";this.Lk=u}C(Se,Qe);Se.prototype.zd=function(a){Se.A.zd.call(this,a);var b=new Hd;a.Lc==t&&(a.Lc=0);b.ob=0>a.Lc;b.ab=q;this.dispatchEvent(b)};function dg(a){O.call(this);this.g="array";this.G=[];this.Yf=a}C(dg,O);function eg(a,b,c){for(var d=0;4>d;d++)if(a[d+0]!==b[d+c])return u;return q}dg.prototype.add=function(a){this.G.push(a);return q};dg.prototype.remove=function(a){a=this.G.indexOf(a);-1<a&&this.G.splice(a,1);return q};dg.prototype.clear=function(){this.G.length=0};
function fg(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);fg(a,b,d);for(fg(a,d,c);b<d;++b)if(0<a.Yf(a.G[b],a.G[d])){var e=a.G[b];a.G[b]=a.G[d];for(var f=a,g=d,h=c;g+1<h&&0>f.Yf(f.G[g+1],e);){var m=f,j=g+1,k=m.G[g];m.G[g]=m.G[j];m.G[j]=k;++g}f.G[g]=e}}}dg.prototype.sort=function(){fg(this,0,this.G.length)};function gg(a,b){Xf.call(this,a,b);this.g="camera2D"}C(gg,Xf);gg.prototype.rotate=function(a){a=gg.A.rotate.call(this,a);var b=new Ed;0<a.x?b.Ye--:0>a.x&&b.Ye++;0<a.y?b.Le++:0>a.y&&b.Le--;this.dispatchEvent(b)};gg.prototype.Wf=function(a){var b=20;a!=t&&!a&&(b=0.02);this.n[14]+=b};gg.prototype.Xf=function(a){var b=20;a!=t&&!a&&(b=0.02);this.n[14]-=b};
gg.prototype.Df=function(a){ja(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||n(Error("Invalid distance vector for pan operation."));this.n[12]-=a.x/this.n[14];this.n[13]+=a.y/this.n[14]};function hg(a,b){Xf.call(this,a,b);this.g="camera3D";this.ag=45;this.Qe=D.f.qf(D.f.wd(),this.ag,a/b,1,1E4)}C(hg,Xf);hg.prototype.rotate=function(a){a=hg.A.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new D.m(this.n[1],this.n[5],this.n[9]),d=new D.m(this.n[0],this.n[4],this.n[8]);c.normalize();d.normalize();D.f.rotate(this.n,b,c.x,c.y,c.d);D.f.rotate(this.n,a,d.x,d.y,d.d)};hg.prototype.re=function(a,b){var c=hg.A.re.call(this,a,b);D.f.Tg(c,a,b,this.aa);return c};
function ig(a,b,c,d){var e=new Float32Array(4),f=new Float32Array(4),g=new Float32Array(16),h=new Float32Array(16);new Float32Array(16);D.f.multiply(a.Qe,a.n,h);D.f.W(h,g);e[0]=b;e[1]=c;e[2]=2*d-1;e[3]=1;D.f.Xg(g,e,f);f[3]=1/f[3];f[0]*=f[3];f[1]*=f[3];f[2]*=f[3];return f}B("X.camera3D",hg);function jg(a){Ob.call(this);this.Db=a;this.R=[]}C(jg,Ob);var kg=[];function lg(a,b,c,d,e){ja(c)||(kg[0]=c,c=kg);for(var f=0;f<c.length;f++){var g=N(b,c[f],d||a,e||u,a.Db||a);a.R.push(g)}}jg.prototype.If=function(){Ib(this.R,ac);this.R.length=0};jg.prototype.handleEvent=function(){n(Error("EventHandler.handleEvent not implemented"))};function mg(){}mg.Gg=function(){return mg.Og?mg.Og:mg.Og=new mg};mg.prototype.Ti=0;mg.Gg();function ng(a){hc.call(this);this.Yb=a||fe();this.Ej=og}C(ng,hc);ng.prototype.Ei=mg.Gg();var og=t;w=ng.prototype;w.Ng=t;w.Nc=u;w.F=t;w.Ej=t;w.Ad=t;w.sd=t;w.ff=t;w.s=v("F");w.Kf=function(a){this.Ad&&this.Ad!=a&&n(Error("Method not supported"));ng.A.Kf.call(this,a)};w.je=v("Yb");w.Kc=function(){this.F=this.Yb.createElement("div")};w.ac=function(a){this.bc(a)};
w.bc=function(a,b){this.Nc&&n(Error("Component already rendered"));this.F||this.Kc();a?a.insertBefore(this.F,b||t):this.Yb.fa.body.appendChild(this.F);(!this.Ad||this.Ad.Nc)&&this.fe()};w.fe=function(){function a(a){!a.Nc&&a.s()&&a.fe()}this.Nc=q;this.sd&&Ib(this.sd,a,p)};w.ge=function(){function a(a){a.Nc&&a.ge()}this.sd&&Ib(this.sd,a,p);this.xi&&this.xi.If();this.Nc=u};
w.removeChild=function(a,b){if(a){var c=ma(a)?a:a.Ng||(a.Ng=":"+(a.Ei.Ti++).toString(36)),d;this.ff&&c?(d=this.ff,d=(c in d?d[c]:p)||t):d=t;a=d;c&&a&&(d=this.ff,c in d&&delete d[c],Mb(this.sd,a),b&&(a.ge(),a.F&&ne(a.F)),c=a,c==t&&n(Error("Unable to set parent component")),c.Ad=t,ng.A.Kf.call(c,t))}a||n(Error("Child is not in parent component"));return a};function pg(){hc.call(this)}C(pg,hc);w=pg.prototype;w.Uf=0;w.yd=0;w.rf=100;w.Dg=0;w.Qf=1;w.Li=u;w.Si=u;w.Fd=function(a){a=qg(this,a);this.Uf!=a&&(this.Uf=a+this.Dg>this.rf?this.rf-this.Dg:a<this.yd?this.yd:a,!this.Li&&!this.Si&&this.dispatchEvent("change"))};w.me=function(){return qg(this,this.Uf)};w.le=function(){return qg(this,this.yd)};w.ke=function(){return qg(this,this.rf)};function qg(a,b){return a.Qf==t?b:a.yd+Math.round((b-a.yd)/a.Qf)*a.Qf};function rg(a){ng.call(this,a);this.Dd=new pg;N(this.Dd,"change",this.yi,u,this)}C(rg,ng);var sg={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=rg.prototype;w.Kc=function(){this.tb=this.je().Kc("div","progress-bar-thumb");var a=sg[this.fh];this.F=this.je().Kc("div",a,this.tb);ug(this);a=this.le();this.s().setAttribute("aria-valuemin",a);a=this.ke();this.s().setAttribute("aria-valuemax",a)};
w.fe=function(){rg.A.fe.call(this);J&&7>ub&&N(this.s(),"resize",this.Be,u,this);this.Be();var a=this.s();a.setAttribute("role","progressbar");a.setAttribute("aria-live","polite")};w.ge=function(){rg.A.ge.call(this);J&&7>ub&&$b(this.s(),"resize",this.Be,u,this)};w.me=function(){return this.Dd.me()};w.Fd=function(a){this.Dd.Fd(a);this.s()&&ug(this)};function ug(a){var b=a.me();a.s().setAttribute("aria-valuenow",b)}w.le=function(){return this.Dd.le()};w.ke=function(){return this.Dd.ke()};w.fh="horizontal";
w.yi=function(){this.Be();this.dispatchEvent("change")};w.Be=function(){if(this.tb){var a=this.le(),b=this.ke(),a=(this.me()-a)/(b-a),b=Math.round(100*a);"vertical"==this.fh?J&&7>ub?(this.tb.style.top=0,this.tb.style.height="100%",b=this.tb.offsetHeight,a=Math.round(a*b),this.tb.style.top=b-a+"px",this.tb.style.height=a+"px"):(this.tb.style.top=100-b+"%",this.tb.style.height=b+"%"):this.tb.style.width=b+"%"}};function vg(a,b){a==t&&n(Error("No valid parent element."));b==t&&n(Error("Invalid initial value."));rg.call(this);this.g="progressbar";this.Xa=a;this.Pe="";this.Nd=this.Bb=t;this.cc=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
d+="  overflow: hidden;\n";d+="  width: 0%;\n";d+="  height: 100%;\n";d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.cc=[c,d,e];this.Fd(b);this.nf()}C(vg,rg);
vg.prototype.nf=function(){var a=ve(this.Xa,"position");if("static"==a||""==a)this.Pe=this.Xa.style.position,this.Xa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ke("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.cc[0])),d=document.createTextNode(String(this.cc[1])),e=document.createTextNode(String(this.cc[2]));a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.Bb=b;this.ac(this.Xa);a=this.s();a.style.position=
"absolute";a.style.top=(this.Xa.clientHeight-5)/2+"px";a.style.left=(this.Xa.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function wg(a){var b=a.s().style.top,c=a.s().style.left;ne(a.s());var d=new vg(a.Xa,100),e=d.s();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=p?e.firstElementChild:oe(e.firstChild)).classList.add("progress-bar-thumb-done");a.Nd=d}
vg.prototype.xd=function(){this.Bb&&ne(this.Bb);this.s()&&ne(this.s());this.Nd&&ne(this.Nd.s());this.Nd=this.Bb=t;this.Pe&&(this.Xa.style.position=this.Pe)};function xg(a,b,c){na(a)?c&&(a=ua(a,c)):a&&"function"==typeof a.handleEvent?a=ua(a.handleEvent,a):n(Error("Invalid listener argument"));return 2147483647<b?-1:fa.setTimeout(a,b||0)};function yg(){O.call(this);this.g="renderer";this.C=window.document.body;this.I=this.C.clientWidth;this.w=this.C.clientHeight;this.U=this.K=this.za=t;this.qb=new dg(ld);this.jb=[];this.Y=t;this.Vd=this.Tc=this.Td=u;this.a=this.Vb=this.Ha=t;this.P={PROGRESSBAR_ENABLED:q,INTERMEDIATE_RENDERING:u,SLICENAVIGATORS:q};this.Ce=-1;window.console.log("XTK release 10 -- 2013-10-04 14:30:14 -- http://www.goXTK.com -- @goXTK")}C(yg,O);w=yg.prototype;
w.wf=function(){window.cancelAnimationFrame(this.Ce);this.P.PROGRESSBAR_ENABLED&&(this.Vb=new vg(this.C,3))};w.xf=function(){this.P.PROGRESSBAR_ENABLED&&this.Vb&&(wg(this.Vb),this.Kd=xg(function(){this.Kd=t;this.Vb&&(this.Vb.xd(),this.Vb=t);this.Tc=this.Vd=q;this.ac()}.bind(this),700))};w.yf=function(a){this.Vb&&this.Vb.Fd(100*a.qd)};w.hj=function(a){this.Ha&&this.Ha.Fd(100*a.qd)};w.Yi=function(a){a!=t&&a instanceof jd&&a.L&&this.ub(a.L)};w.ij=function(a){a!=t&&a instanceof kd&&a.L&&this.remove(a.L)};
w.Af=function(a){(a==t||!(a instanceof Jd))&&n(Error("Invalid hover event."))};w.Bf=function(){var a=ie(this.C);this.I=a.clientWidth;this.w=a.clientHeight;a=ie(this.za);a.width=this.I;a.height=this.w;"renderer3D"==this.g&&(this.a.viewport(0,0,this.I,this.w),this.K.Qe=D.f.qf(D.f.wd(),this.K.ag,this.za.width/this.za.height,1,1E4))};w.Cf=function(a){(a==t||!(a instanceof Id))&&n(Error("Invalid scroll event."))};yg.prototype.__defineGetter__("config",v("P"));
yg.prototype.__defineGetter__("interactor",v("U"));yg.prototype.__defineGetter__("camera",v("K"));yg.prototype.__defineGetter__("loadingCompleted",v("Tc"));yg.prototype.__defineGetter__("container",v("C"));yg.prototype.__defineSetter__("container",function(a){a==t&&n(Error("An ID to a valid container (<div>..) is required."));var b=a;ma(b)&&(b=ie(a));oa(b)&&1==b.nodeType||n(Error("Could not find the given container."));this.C=b});w=yg.prototype;w.Ed=function(){this.K.reset()};
w.wa=function(a){var b=ke("canvas");this.C.appendChild(b);this.I=this.C.clientWidth;this.w=this.C.clientHeight;b.width=this.I;b.height=this.w;try{var c=b.getContext(a);c||n(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.C.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
n(Error(e))}this.Y=new Tf;N(this.Y,yd,this.hj.bind(this));this.za=b;this.a=c;b=new Se(this.za);"2d"==a&&(b=new We(this.za));b.wa();N(b,ud,this.Ed.bind(this));N(b,zd,this.Af.bind(this));N(b,td,this.Cf.bind(this));this.U=b;b=new hg(this.I,this.w);"2d"==a&&(b=new gg(this.I,this.w));b.observe(this.U);this.K=b;N(window,"resize",this.Bf,u,this)};w.add=function(a){(a instanceof cg||a instanceof ag||a instanceof Zf)&&a.p();this.jb.push(a);this.ub(a)};
w.remove=function(a){(!this.za||!this.a)&&n(Error("The renderer was not initialized properly."));if(a!=t){var b=0;if(a!=t){if(a=pa(a),Vb[a]){a=Vb[a];for(var c=a.length-1;0<=c;c--)ac(a[c].key),b++}}else Ma(Tb,function(a,c){ac(c);b++})}return u};
w.ub=function(a){(!this.za||!this.a)&&n(Error("The renderer was not initialized properly."));a!=t&&(cc(a,wd)||N(a,wd,this.Yi.bind(this)),cc(a,xd)||N(a,xd,this.ij.bind(this)),cc(a,Bd)||N(a,Bd,this.wf.bind(this)),cc(a,Dd)||N(a,Dd,this.yf.bind(this)),cc(a,Cd)||N(a,Cd,this.xf.bind(this)))};w.get=function(a){a==t&&n(Error("Invalid object id."));for(var b=this.qb.G,c=b.length,d=0,d=0;d<c;d++)if(b[d].ta==a)return b[d];return t};
w.ac=function(){(!this.za||!this.a)&&n(Error("The renderer was not initialized properly."));if(this.pg==t){if(zc(this.Y.Ac)){if(this.P.PROGRESSBAR_ENABLED&&!this.Ha&&(this.Ha=new vg(this.C,3)),this.Vd=this.Tc=u,this.pg=xg(function(){this.pg=t;this.ac()}.bind(this),100),!this.P.INTERMEDIATE_RENDERING)return}else if(!this.Tc&&!this.Vd&&(this.Vd=q,eval("this.onShowtime()"),this.Tc=q),this.Ha){this.P.PROGRESSBAR_ENABLED&&(this.Ha&&!this.Kd)&&(wg(this.Ha),this.Kd=xg(function(){this.Kd=t;this.Ha&&(this.Ha.xd(),
this.Ha=t);this.ac()}.bind(this),700));return}this.Ce=window.requestAnimationFrame(this.ac.bind(this));eval("this.onRender()");this.bc(u,q)}};w.eh=da();w.bh=da();w.bc=da();w.de=function(){window.cancelAnimationFrame(this.Ce);this.Y&&(delete this.Y,this.Y=t);this.Ha&&(this.Ha.xd(),delete this.Ha,this.Ha=t);this.qb.clear();delete this.qb;this.jb.length=0;delete this.jb;delete this.Y;this.Y=t;delete this.K;this.K=t;delete this.U;this.U=t;delete this.a;this.a=t;ne(this.za);delete this.za;this.za=t};function zg(){O.call(this);this.g="shaders";this.Zd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.Zd=a+="}\n";this.Od="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform vec4 labelmapColor;\n";a+="uniform float volumeLowerThreshold;\n";
a+="uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";
a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";
a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="         if (labelmapColor.a != -255.0) {\n";
a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n";a+="             if (labelmapOpacity < 1.0) {\n";a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="             } else {\n";a+="               textureSum = texture2;\n";a+="             }\n";a+="           }\n";a+="         } else {\n";a+="           if (labelmapOpacity < 1.0) {\n";a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="           } else {\n";
a+="             textureSum = texture2;\n";a+="           }\n";a+="         }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold ||\n";a+="         texture1.a == 0.0 ) {\n";a+="       discard;\n";a+="     };\n";a+="   };\n";
a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";
a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.Od=a+="}\n"}
C(zg,O);
var Ag={xk:"vertexPosition",wk:"vertexNormal",vk:"vertexColor",zk:"vertexTexturePos",yk:"vertexScalar"},Bg={Ak:"view",ek:"perspective",Wj:"center",dk:"objectTransform",rk:"useObjectColor",bk:"objectColor",tk:"useScalars",nk:"scalarsReplaceMode",kk:"scalarsMin",hk:"scalarsMax",lk:"scalarsMinColor",ik:"scalarsMaxColor",mk:"scalarsMinThreshold",jk:"scalarsMaxThreshold",gk:"scalarsInterpolation",fk:"pointSize",ck:"objectOpacity",ak:"normal",sk:"usePicking",uk:"useTexture",qk:"useLabelMapTexture",Zj:"labelmapOpacity",
Yj:"labelmapColor",ok:"textureSampler",pk:"textureSampler2",Bk:"volumeLowerThreshold",Hk:"volumeUpperThreshold",Ek:"volumeScalarMin",Ck:"volumeScalarMax",Fk:"volumeScalarMinColor",Dk:"volumeScalarMaxColor",Jk:"volumeWindowLow",Ik:"volumeWindowHigh",Gk:"volumeTexture"};function Cg(a,b,c){a==t&&n(Error("Invalid GL Buffer."));b==t&&n(Error("Invalid number of items."));c==t&&n(Error("Invalid item size."));O.call(this);this.g="buffer";this.N=a;this.Nb=b;this.Ob=c}C(Cg,O);function Dg(a,b,c,d,e,f,g,h){var m,j;if(m=c.offsetParent){var k="HTML"==m.tagName||"BODY"==m.tagName;if(!k||"static"!=we(m,"position"))j=Be(m),k||(k=(k=Ce(m))&&kb?-m.scrollLeft:k&&(!J||!Bb("8"))&&"visible"!=we(m,"overflowX")?m.scrollWidth-m.clientWidth-m.scrollLeft:m.scrollLeft,j=ee(j,new de(k,m.scrollTop)))}m=j||new de;j=Be(a);k=Ge(a);j=new te(j.x,j.y,k.width,k.height);(k=Ae(a))&&j.Pg(new te(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=fe(a),l=fe(c);if(k.fa!=l.fa){var s=k.fa.body,l=l.fa.parentWindow||
l.fa.defaultView,r=new de(0,0),z=he(s)?he(s).parentWindow||he(s).defaultView:window,y=s;do{var E=z==l?Be(y):De(y);r.x+=E.x;r.y+=E.y}while(z&&z!=l&&(y=z.frameElement)&&(z=z.parent));s=ee(r,Be(s));J&&!qe(k)&&(s=ee(s,re(k)));j.left+=s.x;j.top+=s.y}a=(b&4&&Ce(a)?b^2:b)&-5;b=new de(a&2?j.left+j.width:j.left,a&1?j.top+j.height:j.top);b=ee(b,m);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var F;if(g&&(F=Ae(c)))F.top-=m.y,F.right-=m.x,F.bottom-=m.y,F.left-=m.x;return Eg(b,c,d,f,F,g,h)}
function Eg(a,b,c,d,e,f,g){a=a.l();var h=0,m=(c&4&&Ce(b)?c^2:c)&-5;c=Ge(b);g=g?g.l():c.l();if(d||0!=m)m&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),m&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&(h.x+g.width>e.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y<=e.top&&(h.y+g.height<e.bottom&&f&32)&&(g.height=Math.max(g.height-(e.top-h.y),0),h.y=0,d|=8);h.y>=e.top&&(h.y+g.height>e.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=kb&&(ab||pb)&&Bb("1.9");f instanceof
de?(a=f.x,f=f.y):(a=f,f=p);b.style.left=Fe(a,e);b.style.top=Fe(f,e);if(!(c==g||(!c||!g?0:c.width==g.width&&c.height==g.height)))a=qe(fe(he(b))),J&&(!a||!Bb("8"))?(c=b.style,a?(J?(a=Ke(b,"paddingLeft"),e=Ke(b,"paddingRight"),f=Ke(b,"paddingTop"),d=Ke(b,"paddingBottom"),a=new se(f,e,d,a)):(a=ve(b,"paddingLeft"),e=ve(b,"paddingRight"),f=ve(b,"paddingTop"),d=ve(b,"paddingBottom"),a=new se(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),J?(e=Me(b,"borderLeft"),f=Me(b,"borderRight"),d=Me(b,"borderTop"),
b=Me(b,"borderBottom"),b=new se(d,f,b,e)):(e=ve(b,"borderLeftWidth"),f=ve(b,"borderRightWidth"),d=ve(b,"borderTopWidth"),b=ve(b,"borderBottomWidth"),b=new se(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,kb?b.MozBoxSizing="border-box":lb?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",
b.height=Math.max(g.height,0)+"px");return h};function Fg(){}Fg.prototype.mb=da();function Gg(a,b){this.gf=a instanceof de?a:new de(a,b)}C(Gg,Fg);Gg.prototype.mb=function(a,b,c,d){Dg(xe(a),0,a,b,this.gf,c,t,d)};function Hg(a,b,c){this.element=a;this.Bg=b;this.xj=c}C(Hg,Fg);Hg.prototype.mb=function(a,b,c){Dg(this.element,this.Bg,a,b,p,c,this.xj)};function Ig(a,b){hc.call(this);this.Db=new jg(this);this.Jf(a||t);b&&(this.Oc=b)}C(Ig,hc);w=Ig.prototype;w.F=t;w.Yh=q;w.vg=t;w.Ja=u;w.Ij=u;w.pf=-1;w.Sg=-1;w.Di=u;w.mi=q;w.Oc="toggle_display";w.s=v("F");w.Jf=function(a){this.Ja&&n(Error("Can not change this state of the popup while showing."));this.F=a};
function Jg(a,b){a.Ae&&a.Ae.stop();a.ne&&a.ne.stop();if(b){if(!a.Ja&&a.vf()){a.F||n(Error("Caller must call setElement before trying to show the popup"));a.mb();var c=he(a.F);a.Di&&lg(a.Db,c,"keydown",a.Wi,q);if(a.Yh)if(lg(a.Db,c,"mousedown",a.$g,q),J){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}lg(a.Db,c,"mousedown",a.$g,q);lg(a.Db,c,"deactivate",a.Zg)}else lg(a.Db,c,"blur",a.Zg);"toggle_display"==
a.Oc?(a.F.style.visibility="visible",Ie(a.F,q)):"move_offscreen"==a.Oc&&a.mb();a.Ja=q;a.Ae?(Zb(a.Ae,"end",a.dh,u,a),a.Ae.play()):a.dh()}}else Kg(a)}w.mb=ga;function Kg(a,b){if(!a.Ja||!a.dispatchEvent({type:"beforehide",target:b}))return u;a.Db&&a.Db.If();a.Ja=u;a.Sg=wa();a.ne?(Zb(a.ne,"end",va(a.Ag,b),u,a),a.ne.play()):a.Ag(b);return q}w.Ag=function(a){"toggle_display"==this.Oc?this.Ij?xg(this.Kg,0,this):this.Kg():"move_offscreen"==this.Oc&&(this.F.style.top="-10000px");this.zf(a)};
w.Kg=function(){this.F.style.visibility="hidden";Ie(this.F,u)};w.vf=function(){return this.dispatchEvent("beforeshow")};w.dh=function(){this.pf=wa();this.Sg=-1;this.dispatchEvent("show")};w.zf=function(a){this.dispatchEvent({type:"hide",target:a})};w.$g=function(a){a=a.target;!pe(this.F,a)&&((!this.vg||pe(this.vg,a))&&!(150>wa()-this.pf))&&Kg(this,a)};w.Wi=function(a){27==a.keyCode&&Kg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
w.Zg=function(a){if(this.mi){var b=he(this.F);if(J||ib){if(a=b.activeElement,!a||pe(this.F,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>wa()-this.pf||Kg(this)}};function Lg(a,b){this.Bj=4;this.se=b||p;Ig.call(this,a)}C(Lg,Ig);Lg.prototype.mb=function(){if(this.se){var a=!this.Ja&&"move_offscreen"!=this.Oc,b=this.s();a&&(b.style.visibility="hidden",Ie(b,q));this.se.mb(b,this.Bj,this.dl);a&&Ie(b,u)}};function Mg(a){this.ba=new xc;a&&this.Ze(a)}function Ng(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+pa(a):b.substr(0,1)+a}w=Mg.prototype;w.ie=function(){return this.ba.ie()};w.add=function(a){this.ba.set(Ng(a),a)};w.Ze=function(a){a=wc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};w.If=function(a){a=wc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};w.remove=function(a){return this.ba.remove(Ng(a))};w.clear=function(){this.ba.clear()};
w.contains=function(a){a=Ng(a);return Ac(this.ba.ba,a)};w.Pg=function(a){var b=new Mg;a=wc(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};w.vd=function(){return this.ba.vd()};w.l=function(){return new Mg(this)};function Og(a,b,c){this.Yb=c||(a?fe(ie(a)):fe());Lg.call(this,this.Yb.Kc("div",{style:"position:absolute;display:none;"}));this.hf=new de(1,1);this.ee=new Mg;a&&Pg(this,a);if(b!=t)if(a=this.s(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(he(a).createTextNode(String(b)))}}C(Og,Lg);var Qg=[];w=Og.prototype;w.Oa=t;w.className="goog-tooltip";
w.rh=500;w.Ci=0;w.je=v("Yb");function Pg(a,b){b=ie(b);a.ee.add(b);N(b,"mouseover",a.Bi,u,a);N(b,"mouseout",a.Hg,u,a);N(b,"mousemove",a.Ai,u,a);N(b,"focus",a.zi,u,a);N(b,"blur",a.Hg,u,a)}w.Jf=function(a){var b=this.s();b&&ne(b);Og.A.Jf.call(this,a);a&&(b=this.Yb.fa.body,b.insertBefore(a,b.lastChild))};
w.vf=function(){if(!Ig.prototype.vf.call(this))return u;if(this.anchor)for(var a,b=0;a=Qg[b];b++)pe(a.s(),this.anchor)||Jg(a,u);0<=Hb(Qg,this)||Qg.push(this);a=this.s();a.className=this.className;Rg(this);N(a,"mouseover",this.Jg,u,this);N(a,"mouseout",this.Ig,u,this);Sg(this);return q};
w.zf=function(){Mb(Qg,this);for(var a=this.s(),b,c=0;b=Qg[c];c++)b.anchor&&pe(a,b.anchor)&&Jg(b,u);this.hh&&Tg(this.hh);$b(a,"mouseover",this.Jg,u,this);$b(a,"mouseout",this.Ig,u,this);this.anchor=p;if(0==(this.Gb?this.Ja?4:1:this.Mc?3:this.Ja?2:0))this.xe=u;Ig.prototype.zf.call(this)};w.Wg=function(a,b){this.anchor==a&&this.ee.contains(this.anchor)&&(this.xe||!this.hl?(Jg(this,u),this.Ja||(this.anchor=a,this.se=b||Ug(this,0)||p,this.Ja&&this.mb(),Jg(this,q))):this.anchor=p);this.Gb=p};
w.Ri=function(a){this.Mc=p;a==this.anchor&&(this.Oa==t||this.Oa!=this.s()&&!this.ee.contains(this.Oa))&&(!this.xg||!this.xg.Oa)&&Jg(this,u)};function Vg(a,b){var c=re(a.Yb);a.hf.x=b.clientX+c.x;a.hf.y=b.clientY+c.y}w.Bi=function(a){var b=Wg(this,a.target);this.Oa=b;Rg(this);b!=this.anchor&&(this.anchor=b,this.Gb||(this.Gb=xg(ua(this.Wg,this,b,p),this.rh)),Xg(this),Vg(this,a))};function Wg(a,b){try{for(;b&&!a.ee.contains(b);)b=b.parentNode;return b}catch(c){return t}}
w.Ai=function(a){Vg(this,a);this.xe=q};w.zi=function(a){this.Oa=a=Wg(this,a.target);this.xe=q;if(this.anchor!=a){this.anchor=a;var b=Ug(this,1);Rg(this);this.Gb||(this.Gb=xg(ua(this.Wg,this,a,b),this.rh));Xg(this)}};function Ug(a,b){if(0==b){var c=a.hf.l();return new Yg(c)}return new Zg(a.Oa)}function Xg(a){if(a.anchor)for(var b,c=0;b=Qg[c];c++)pe(b.s(),a.anchor)&&(b.xg=a,a.hh=b)}
w.Hg=function(a){var b=Wg(this,a.target),c=Wg(this,a.relatedTarget);b!=c&&(b==this.Oa&&(this.Oa=t),Sg(this),this.xe=u,this.Ja&&(!a.relatedTarget||!pe(this.s(),a.relatedTarget))?Tg(this):this.anchor=p)};w.Jg=function(){var a=this.s();this.Oa!=a&&(Rg(this),this.Oa=a)};w.Ig=function(a){var b=this.s();if(this.Oa==b&&(!a.relatedTarget||!pe(b,a.relatedTarget)))this.Oa=t,Tg(this)};function Sg(a){a.Gb&&(fa.clearTimeout(a.Gb),a.Gb=p)}
function Tg(a){if(2==(a.Gb?a.Ja?4:1:a.Mc?3:a.Ja?2:0))a.Mc=xg(ua(a.Ri,a,a.anchor),a.Ci)}function Rg(a){a.Mc&&(fa.clearTimeout(a.Mc),a.Mc=p)}function Yg(a,b){Gg.call(this,a,b)}C(Yg,Gg);Yg.prototype.mb=function(a,b,c){b=xe(a);b=Ae(b);c=c?new se(c.top+10,c.right,c.bottom,c.left+10):new se(10,0,0,10);Eg(this.gf,a,4,c,b,9)&496&&Eg(this.gf,a,4,c,b,5)};function Zg(a){Hg.call(this,a,3)}C(Zg,Hg);
Zg.prototype.mb=function(a,b,c){var d=new de(10,0);Dg(this.element,this.Bg,a,b,d,c,9)&496&&Dg(this.element,2,a,1,d,c,5)};function $g(a,b,c,d){a==t&&n(Error("No valid parent element."));(!x(b)||!x(c))&&n(Error("Invalid coordinates."));(d==t||!(d instanceof Qe))&&n(Error("Invalid interactor."));Og.call(this);this.g="caption";this.Xa=a;this.ae=b;this.be=c;this.U=d;this.Bb=t;this.cc=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.cc=[a];Zb(d,Ad,this.xd.bind(this));this.nf()}C($g,Og);
$g.prototype.nf=function(){var a=ve(this.Xa,"position");if("static"==a||""==a)this.Xa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ke("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.cc[0]));a.appendChild(b);b.appendChild(c);this.Bb=b;this.se=new Gg(this.ae,this.be)||p;this.Ja&&this.mb();Jg(this,q);Pg(this,this.Xa);this.s().classList.add("x-tooltip")};
$g.prototype.xd=function(){Jg(this,u);this.Bb&&ne(this.Bb);this.s()&&ne(this.s());this.Bb=t};function ah(){yg.call(this);this.g="renderer3D";this.Xc=this.$c=this.Wc=this.Zc=this.Vc=this.Yc=this.Te=this.Ue=t;this.B=[0,0,0];this.Pc=[0,0,0];this.ng=t;this.Ee=new xc;this.nd=new xc;this.hc=new xc;this.ad=new xc;this.tc=new xc;this.Dc=new xc;this.gc=new xc;this.Ic=new xc;this.P={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:u,INTERMEDIATE_RENDERING:u}}C(ah,yg);ah.prototype.__defineGetter__("config",v("P"));w=ah.prototype;
w.Dj=function(){this.Xc=this.$c=this.Wc=this.Zc=this.Vc=this.Yc=t;this.B=[0,0,0]};w.Af=function(a){ah.A.Af.call(this,a);var b=a.ae;a=a.be;var c=this.Ff(b,a);if(c=this.get(c))if(c=c.sc){var d=De(this.C);(new $g(this.C,d.x+b+10,d.y+a+10,this.U)).s().innerHTML=c}};
w.wa=function(){ah.A.wa.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.I,this.w),this.a.clearColor(this.Pc[0],this.Pc[1],this.Pc[2],0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.P.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();
this.a.bindTexture(this.a.TEXTURE_2D,c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.I,this.w,0,this.a.RGB,this.a.UNSIGNED_BYTE,t);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST);this.a.bindFramebuffer(this.a.FRAMEBUFFER,
a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.I,this.w);this.a.bindRenderbuffer(this.a.RENDERBUFFER,t);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);this.ng=a}}catch(d){n(Error("Exception while accessing GL Context!\n"+d))}a=new zg;
(this.za==t||this.a==t||this.K==t)&&n(Error("Renderer was not initialized properly."));(a==t||!(a instanceof zg))&&n(Error("Could not add shaders."));b=Object.keys(Bg);Object.keys(Ag).every(function(a){a=Ag[a];return-1!=this.Zd.search(a)||-1!=this.Od.search(a)}.bind(a))||n(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Bg[a];return-1!=this.Zd.search(a)||-1!=this.Od.search(a)}.bind(a))||n(Error("Could not find all uniforms in the shader sources."));b=this.a.createShader(this.a.FRAGMENT_SHADER);
c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.Od);this.a.shaderSource(c,a.Zd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||n(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||n(Error("Vertex Shader compilation failed!\n"+this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c);this.a.attachShader(e,b);this.a.linkProgram(e);
this.a.getProgramParameter(e,this.a.LINK_STATUS)||n(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e)));this.a.useProgram(e);this.Te=e;Object.keys(Ag).forEach(function(a){a=Ag[a];this.Ee.set(a,this.a.getAttribLocation(this.Te,a));this.a.enableVertexAttribArray(this.Ee.get(a))}.bind(this));Object.keys(Bg).forEach(function(a){a=Bg[a];this.nd.set(a,this.a.getUniformLocation(this.Te,a))}.bind(this));this.Ue=a};
w.ub=function(a){ah.A.ub.call(this,a);var b=u;if(a!=t){this.get(a.ta)&&(b=q);var c=a.ta,d=a.h,e=a.q,f=a.na,g=a.D,h=a.r,m=a.ea,j=a.Aa,k=a.e,l=a.H;if(k!=t&&k.r!=t&&k.r.j)this.ub(k);else if(k!=t&&k.j&&this.ub(k),j!=t&&j.r!=t&&j.r.j)this.Y.load(j,a);else if(g!=t&&g.r!=t&&g.r.j)this.Y.load(g,a);else{if(h!=t&&ja(h))if(a.pc!=t){if(a.pc.pe!=h.length||!a.j)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.Y.load(h[b],a);return}else{if(h!=t&&h.j){this.Y.load(a,a);return}if(l!=t&&l.r!=t&&l.r.j){this.Y.load(l,
a);return}}if(0<a.c.length){h=a.c;j=h.length;for(k=k=0;k<j;k++)this.ub(h[k])}if(d){for(h=0;this.Td;)h++,window.console.log("Possible thread lock avoided: "+h);this.Td=q;j=a instanceof Wd&&a.Cb instanceof Ye;b&&(g!=t&&g.j)&&(h=this.gc.get(c),h!=t&&this.a.isBuffer(h.N)&&this.a.deleteBuffer(h.N));h=t;g!=t&&(!b||g.j?(h=a.Hc,h==t&&n(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=u,g.Wb&&(k=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),
k=this.a.createTexture(),k.Fi=g.Mb,this.Ic.set(g.ta,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.Wb?(k=this.a.RGBA,g.dg&&(k=this.a.LUMINANCE,this.a.pixelStorei(this.a.UNPACK_ALIGNMENT,1)),this.a.texImage2D(this.a.TEXTURE_2D,0,k,g.Se,g.Re,0,k,this.a.UNSIGNED_BYTE,g.Wb)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.Fi),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,
this.a.CLAMP_TO_EDGE),j?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,t),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),
this.a.STATIC_DRAW),h=new Cg(k,h.length,2),this.gc.set(c,h),g.j=u):h=this.gc.get(c));Uf(this.Y,0.1);if(j)this.Td=u,D.Wa(this.g+".update"),Uf(this.Y,0.9);else{if(!b||d.j||m.j){j=m.O;g=D.f.Z(j,d.gb,d.hb,d.ib);j=D.f.Z(j,d.bb,d.cb,d.eb);if(this.Yc===t||g.x<this.Yc)this.Yc=g.x;if(this.Vc===t||j.x>this.Vc)this.Vc=j.x;if(this.Zc===t||g.y<this.Zc)this.Zc=g.y;if(this.Wc===t||j.y>this.Wc)this.Wc=j.y;if(this.$c===t||g.d<this.$c)this.$c=g.d;if(this.Xc===t||j.d>this.Xc)this.Xc=j.d;this.B=[(this.Yc+this.Vc)/2,
(this.Zc+this.Wc)/2,(this.$c+this.Xc)/2];m.j=u}b&&d.j&&(m=this.hc.get(c),m!=t&&this.a.isBuffer(m.N)&&this.a.deleteBuffer(m.N));m=t;!b||d.j?(m=this.a.createBuffer(),d.Fb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,m),this.a.bufferData(this.a.ARRAY_BUFFER,d.$,this.a.STATIC_DRAW),m=new Cg(m,d.count,3),d.j=u):m=this.hc.get(c);Uf(this.Y,0.3);b&&e.j&&(g=this.hc.get(c),g!=t&&this.a.isBuffer(g.N)&&this.a.deleteBuffer(g.N));g=t;!b||e.j?(g=this.a.createBuffer(),e.Fb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,
e.$,this.a.STATIC_DRAW),g=new Cg(g,e.count,3),e.j=u):g=this.ad.get(c);Uf(this.Y,0.3);b&&(f&&f.j)&&(e=this.tc.get(c),e!=t&&this.a.isBuffer(e.N)&&this.a.deleteBuffer(e.N));e=t;f&&(!b||f.j?(f.length!=d.length&&n(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.Fb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.$,this.a.STATIC_DRAW),e=new Cg(e,f.count,3),f.j=u):e=this.tc.get(c));Uf(this.Y,0.2);b&&(l&&l.j)&&(f=this.Dc.get(c),f!=t&&this.a.isBuffer(f.N)&&
this.a.deleteBuffer(f.N));f=t;l&&(f=l.Rc,!b||l.j?(f.length!=d.length&&n(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Cg(d,f.length,3),l.j=u):f=this.Dc.get(c));Uf(this.Y,0.1);b||this.qb.add(a);this.hc.set(c,m);this.ad.set(c,g);this.tc.set(c,e);this.gc.set(c,h);this.Dc.set(c,f);this.Td=a.j=u}}else a.j=u}}};
w.Ff=function(a,b){if(this.P.PICKING_ENABLED){this.bc(q,u);var c=new Uint8Array(4);this.a.readPixels(a,this.w-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
w.bc=function(a,b){ah.A.bc.call(this,a,b);this.a.viewport(0,0,this.I,this.w);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.qb.G,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.ng):this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);var e=this.K.Qe,f=this.K.n;this.a.uniformMatrix4fv(this.nd.get("perspective"),u,e);this.a.uniformMatrix4fv(this.nd.get("view"),u,f);e=this.B;this.a.uniform3f(this.nd.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.jb.length;for(e=0;e<f;++e){var g=this.jb[e];if(g instanceof Q){var h=D.f.Z(this.K.n,g.t[0]+g.b[0].i[0],g.t[1]+g.b[0].i[1],g.t[2]+g.b[0].i[2]),m=D.f.Z(this.K.n,g.t[0]-g.b[0].i[0],g.t[1]-g.b[0].i[1],g.t[2]-g.b[0].i[2]),j=Math.abs(h.d-m.d),h=D.f.Z(this.K.n,g.t[0]+g.b[1].i[0],g.t[1]+g.b[1].i[1],g.t[2]+g.b[1].i[2]),m=D.f.Z(this.K.n,g.t[0]-g.b[1].i[0],g.t[1]-g.b[1].i[1],g.t[2]+-g.b[1].i[2]),k=Math.abs(h.d-m.d),h=D.f.Z(this.K.n,g.t[0]+g.b[2].i[0],g.t[1]+g.b[2].i[1],g.t[2]+g.b[2].i[2]),m=D.f.Z(this.K.n,
g.t[0]-g.b[2].i[0],g.t[1]-g.b[2].i[1],g.t[2]-g.b[2].i[2]),h=Math.max(j,k,Math.abs(h.d-m.d));h==j?Xe(g,0):h==k?Xe(g,1):Xe(g,2)}}if(this.P.ORDERING_ENABLED){j=u;f=this.jb;g=f.length-1;do if(e=f[g],e instanceof Q&&e.Na&&-1!=e.V){var j=e.c[e.V].c,k=e.V,h=D.f.Z(this.K.n,e.t[0]+e.b[k].z[0],e.t[1]+e.b[k].z[1],e.t[2]+e.b[k].z[2]),m=D.f.Z(this.K.n,e.t[0]-e.b[k].z[0],e.t[1]-e.b[k].z[1],e.t[2]-e.b[k].z[2]),h=h.d-m.d,m=Math.max(e.qc[e.V],Math.max(e.qc[e.V+4],e.qc[e.V+8])),l=Math.min(e.qc[e.V],Math.min(e.qc[e.V+
4],e.qc[e.V+8]));if(0>h*(m+l))for(h=h=0;h<e.ed[k]-1;h++)j[h]&&(j[h].qa=e.qa,j[h].sa=e.b[k].Fc*h);else for(h=e.ed[k]-1;0<=h;h--)j[h]&&(j[h].qa=e.qa,j[h].sa=(e.ed[k]-1)*e.b[k].Fc-e.b[k].Fc*h);j=q}while(g--);f=this.qb.G;g=f.length-1;do if(e=f[g],e.M&&!(1==e.qa||e instanceof Wd))j=e,k=e.h.Ld,e=D.f.Z(e.ea.O,k[0],k[1],k[2]),e=D.f.Z(this.K.n,e.x,e.y,e.d),e=D.m.lf(this.K.ec,e),e=Math.round(1E3*e)/1E3,j.sa=e,j=q;while(g--);j&&this.qb.sort()}if(f=!a&&b!=t&&b&&this.P.STATISTICS_ENABLED)var s=0,r=0,z=0,y=0;var e=
this.Ee,g=e.get("vertexPosition"),j=e.get("vertexNormal"),k=e.get("vertexColor"),h=e.get("vertexTexturePos"),m=e.get("vertexScalar"),e=this.nd,l=e.get("usePicking"),E=e.get("useObjectColor"),F=e.get("objectColor"),K=e.get("useScalars"),A=e.get("scalarsReplaceMode"),G=e.get("scalarsMin"),I=e.get("scalarsMax"),H=e.get("scalarsMinColor"),R=e.get("scalarsMaxColor"),M=e.get("scalarsInterpolation"),S=e.get("scalarsMinThreshold"),aa=e.get("scalarsMaxThreshold"),Z=e.get("objectOpacity"),ba=e.get("labelmapOpacity"),
L=e.get("labelmapColor"),T=e.get("useTexture"),P=e.get("useLabelMapTexture"),Ea=e.get("textureSampler"),qb=e.get("textureSampler2"),rb=e.get("volumeLowerThreshold"),sb=e.get("volumeUpperThreshold"),jb=e.get("volumeScalarMin"),Mc=e.get("volumeScalarMax"),eh=e.get("volumeWindowLow"),fh=e.get("volumeWindowHigh"),gh=e.get("volumeScalarMinColor"),hh=e.get("volumeScalarMaxColor"),tg=e.get("volumeTexture"),ih=e.get("objectTransform"),jh=e.get("pointSize"),e=d;do{var ca=c[d-e];if(ca){var ka=t;ca instanceof
Wd&&ca.Cb&&(ka=ca.Cb);if(ca.M&&(!ka||ka.M)&&(!a||ca.bd)){var za=ca.ta,db=ca.Uc,Qa=this.hc.get(za),nb=this.ad.get(za),Te=this.tc.get(za),Kb=this.Dc.get(za),Ue=this.gc.get(za);this.a.bindBuffer(this.a.ARRAY_BUFFER,Qa.N);this.a.vertexAttribPointer(g,Qa.Ob,this.a.FLOAT,u,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,nb.N);this.a.vertexAttribPointer(j,nb.Ob,this.a.FLOAT,u,0,0);a?this.a.uniform1i(l,q):this.a.uniform1i(l,u);Te&&!a&&!db?(this.a.uniform1i(E,u),this.a.bindBuffer(this.a.ARRAY_BUFFER,Te.N),this.a.vertexAttribPointer(k,
Te.Ob,this.a.FLOAT,u,0,0)):(nb=1,db&&!a&&(nb=0),this.a.uniform1i(E,nb),nb=ca.u,a&&(nb=[Math.floor(za%65025%255)/255,Math.floor(za%65025/255)/255,Math.floor(za/65025)/255]),this.a.uniform3f(F,parseFloat(nb[0]),parseFloat(nb[1]),parseFloat(nb[2])),this.a.vertexAttribPointer(k,Qa.Ob,this.a.FLOAT,u,0,0));Kb&&!a&&!db?(this.a.uniform1i(K,q),this.a.uniform1i(A,ca.H.qg),za=ca.H.Rb,db=ca.H.Pb,this.a.uniform3f(H,parseFloat(za[0]),parseFloat(za[1]),parseFloat(za[2])),this.a.uniform3f(R,parseFloat(db[0]),parseFloat(db[1]),
parseFloat(db[2])),this.a.uniform1f(S,parseFloat(ca.H.ha)),this.a.uniform1f(aa,parseFloat(ca.H.ia)),this.a.uniform1f(G,parseFloat(ca.H.fb)),this.a.uniform1f(I,parseFloat(ca.H.oa)),this.a.uniform1i(M,parseInt(ca.H.Ge,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Kb.N),this.a.vertexAttribPointer(m,Kb.Ob,this.a.FLOAT,u,0,0)):(this.a.uniform1i(K,u),this.a.vertexAttribPointer(m,Qa.Ob,this.a.FLOAT,u,0,0));this.a.uniform1f(Z,parseFloat(ca.qa));ca.D&&Ue&&!a?(this.a.uniform1i(T,q),this.a.activeTexture(this.a.TEXTURE0),
this.a.bindTexture(this.a.TEXTURE_2D,this.Ic.get(ca.D.ta)),this.a.uniform1i(Ea,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ue.N),this.a.vertexAttribPointer(h,Ue.Ob,this.a.FLOAT,u,0,0),this.a.uniform1i(tg,u)):(this.a.uniform1i(T,u),this.a.vertexAttribPointer(h,Qa.Ob,this.a.FLOAT,u,0,0));ka&&(this.a.uniform1i(tg,q),this.a.uniform1f(rb,ka.ha),this.a.uniform1f(sb,ka.ia),this.a.uniform1f(jb,ka.fb),this.a.uniform1f(Mc,ka.oa),za=ka.Rb,db=ka.Pb,this.a.uniform3f(gh,parseFloat(za[0]),parseFloat(za[1]),parseFloat(za[2])),
this.a.uniform3f(hh,parseFloat(db[0]),parseFloat(db[1]),parseFloat(db[2])),this.a.uniform1f(eh,ka.ka),this.a.uniform1f(fh,ka.ja),Kb=ka.e,this.a.uniform1i(P,u),ka.Na?this.a.uniform1f(Z,parseFloat(ka.qa)):Kb&&Kb.M&&(ka=ca.e.ta,this.a.uniform1i(P,q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Ic.get(ka)),this.a.uniform1i(qb,1),this.a.uniform1f(ba,Kb.qa),this.a.uniform4fv(L,Kb.Ve)));this.a.uniformMatrix4fv(ih,u,ca.ea.O);ka=1;"POINTS"==ca.Da&&(ka=ca.cd);this.a.uniform1f(jh,
ka);ka=-1;ca.Da==gd?(ka=this.a.TRIANGLES,f&&(r+=Qa.Nb/3)):"LINES"==ca.Da?(this.a.lineWidth(ca.Bc),ka=this.a.LINES,f&&(z+=Qa.Nb/2)):"POINTS"==ca.Da?(ka=this.a.POINTS,f&&(y+=Qa.Nb)):"TRIANGLE_STRIPS"==ca.Da?(ka=this.a.TRIANGLE_STRIP,f&&(r+=Qa.Nb/3)):"POLYGONS"==ca.Da&&(ka=0==Qa.Nb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(r+=Qa.Nb/3));f&&(s+=Qa.Nb);this.a.drawArrays(ka,0,Qa.Nb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+s+" | "),c+="Triangles: "+Math.round(r)+" | ",c+="Lines: "+z+" | ",c+=
"Points: "+y+" | ",c+="Textures: "+this.Ic.ie(),window.console.log(c))}};
w.remove=function(a){ah.A.remove.call(this,a);if(0<a.c.length)for(var b=a.c,c=b.length,d=0,d=0;d<c;d++)this.remove(b[d]);b=a.ta;c=this.gc.get(b);c!=t&&this.a.isBuffer(c.N)&&this.a.deleteBuffer(c.N);if(a.D&&(c=this.Ic.get(a.D.ta)))this.a.deleteTexture(c),this.Ic.remove(a.D.ta);c=this.hc.get(b);c!=t&&this.a.isBuffer(c.N)&&this.a.deleteBuffer(c.N);c=this.ad.get(b);c!=t&&this.a.isBuffer(c.N)&&this.a.deleteBuffer(c.N);c=this.tc.get(b);c!=t&&this.a.isBuffer(c.N)&&this.a.deleteBuffer(c.N);c=this.Dc.get(b);
c!=t&&this.a.isBuffer(c.N)&&this.a.deleteBuffer(c.N);this.hc.remove(b);this.ad.remove(b);this.tc.remove(b);this.gc.remove(b);this.Dc.remove(b);this.qb.remove(a);return q};w.de=function(){this.Ue=t;delete this.Ue;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);ah.A.de.call(this)};ah.prototype.__defineGetter__("bgColor",v("Pc"));ah.prototype.__defineSetter__("bgColor",ea("Pc"));
ah.prototype.zj=function(a,b,c,d,e){c!=t||(c=4);d!=t||(d=2);if(e==t){e=this.Ff(a,b);if(-1==e)return t;e=this.get(e);if(!e)return t}var f=ig(this.K,2*(a/this.I)-1,2*((this.w-b)/this.w)-1,0);a=ig(this.K,2*(a/this.I)-1,2*((this.w-b)/this.w)-1,1);f[0]+=this.B[0];f[1]+=this.B[1];f[2]+=this.B[2];a[0]+=this.B[0];a[1]+=this.B[1];a[2]+=this.B[2];b=[e.h.gb,e.h.hb,e.h.ib];var g=[e.h.bb,e.h.hb,e.h.ib],h=[e.h.bb,e.h.cb,e.h.ib],m=[e.h.gb,e.h.cb,e.h.ib],j=[e.h.gb,e.h.cb,e.h.eb],k=[e.h.gb,e.h.hb,e.h.eb],l=[e.h.bb,
e.h.cb,e.h.eb],s=[e.h.bb,e.h.hb,e.h.eb];b=[D.f.Z(e.ea.O,b[0],b[1],b[2]),D.f.Z(e.ea.O,g[0],g[1],g[2]),D.f.Z(e.ea.O,h[0],h[1],h[2]),D.f.Z(e.ea.O,m[0],m[1],m[2]),D.f.Z(e.ea.O,j[0],j[1],j[2]),D.f.Z(e.ea.O,k[0],k[1],k[2]),D.f.Z(e.ea.O,l[0],l[1],l[2]),D.f.Z(e.ea.O,s[0],s[1],s[2])];var g=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity],r;for(r in b)r=b[r],g=[Math.min(g[0],r.x),Math.max(g[1],r.x),Math.min(g[2],r.y),Math.max(g[3],r.y),Math.min(g[4],r.d),Math.max(g[5],r.d)];r=g;b=[];g=[];for(h=0;6>
h;h++){var m=Math.floor(h/2),j=(m+1)%3,k=(m+2)%3,s=(2+2*m)%6,z=(4+2*m)%6,y=(r[h]-f[m])*(1/a[m]);Infinity!=y&&-Infinity!=y&&(l=f[j]+a[j]*y,y=f[k]+a[k]*y,l>=r[s]&&l<=r[s+1]&&y>=r[z]&&y<=r[z+1]?(s=[],s[m]=r[h],s[j]=l,s[k]=y,b.push(s)):(s=[],s[m]=r[h],s[j]=l,s[k]=y,g.push(s)))}a=[b,g];a=a[0];if(0==a.length)return t;g=Array(2);for(r=0;2>r;r++)b=a[r],g[r]=Math.sqrt((b[0]-f[0])*(b[0]-f[0])+(b[1]-f[1])*(b[1]-f[1])+(b[2]-f[2])*(b[2]-f[2]));f=b=r=t;g[0]<g[1]?(r=a[0],b=a[1]):(r=a[1],b=a[0]);f=Math.sqrt((r[0]-
b[0])*(r[0]-b[0])+(r[1]-b[1])*(r[1]-b[1])+(r[2]-b[2])*(r[2]-b[2]));f/=c;a=r;r=[b[0]-r[0],b[1]-r[1],b[2]-r[2]];b=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);g=[r[0]/b,r[1]/b,r[2]/b];h=e.h.$;m=h.length;for(r=0;r<f;r+=c){a=[a[0]+c*g[0],a[1]+c*g[1],a[2]+c*g[2]];for(b=0;b<m;b+=3)if(j=h[b],k=h[b+1],l=h[b+2],s=new D.m(j,k,l),s=D.f.Z(e.ea.O,j,k,l),Math.sqrt((a[0]-s.x)*(a[0]-s.x)+(a[1]-s.y)*(a[1]-s.y)+(a[2]-s.d)*(a[2]-s.d))<=d)return[s.x,s.y,s.d]}return t};B("X.renderer3D",ah);
B("X.renderer3D.prototype.init",ah.prototype.wa);B("X.renderer3D.prototype.add",ah.prototype.add);B("X.renderer3D.prototype.onShowtime",ah.prototype.eh);B("X.renderer3D.prototype.onRender",ah.prototype.bh);B("X.renderer3D.prototype.get",ah.prototype.get);B("X.renderer3D.prototype.render",ah.prototype.ac);B("X.renderer3D.prototype.destroy",ah.prototype.de);B("X.renderer3D.prototype.remove",ah.prototype.remove);B("X.renderer3D.prototype.resetBoundingBox",ah.prototype.Dj);
B("X.renderer3D.prototype.resetViewAndRender",ah.prototype.Ed);B("X.renderer3D.prototype.pick",ah.prototype.Ff);B("X.renderer3D.prototype.pick3d",ah.prototype.zj);function bh(){W.call(this);this.g="fibers";Fa(this,new vc)}C(bh,W);B("X.fibers",bh);function ch(){yg.call(this);this.g="renderer2D";this.Ga=t;this.Ba=-1;this.Sb=[];this.gg=this.Rd=this.bg=this.Pd=t;this.Ec=this.Gc=this.fd=this.hd=0;this.ja=this.ka=this.ia=this.ha=this.Zf=-1;this.hg=new Float32Array([-255,-255,-255,-255]);this.og=q}C(ch,yg);ch.prototype.kj=da();ch.prototype.uj=da();ch.prototype.Cf=function(a){ch.A.Cf.call(this,a);var b=this.jb[0];if(b){var c="",c=0==this.Ba?"indexX":1==this.Ba?"indexY":"indexZ";b[c]=a.aa?b[c]+1:b[c]-1;eval("this.onScroll();")}};
ch.prototype.vj=function(a){var b=this.jb[0];if(b){var c=b.ja-b.ka,d=c/2,e=parseInt(c+c/15*-a.Ye,10);a=parseInt(d+d/15*a.Le,10);c==e&&e++;d==a&&a++;b.ka-=parseInt(d-a,10);b.ka-=parseInt(c-e,10);b.ka=Math.max(b.ka,b.fb);b.ja-=parseInt(d-a,10);b.ja+=parseInt(c-e,10);b.ja=Math.min(b.ja,b.oa);eval("this.onWindowLevel();")}};ch.prototype.__defineGetter__("orientation",v("Ga"));
ch.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"AXIAL"==a?(a="Z",this.Ba=2):"SAGITTAL"==a?(a="X",this.Ba=0):"CORONAL"==a&&(a="Y",this.Ba=1);"X"!=a&&("Y"!=a&&"Z"!=a)&&n(Error("Invalid orientation."));this.Ga=a});ch.prototype.__defineGetter__("radiological",v("og"));ch.prototype.__defineSetter__("radiological",ea("og"));w=ch.prototype;
w.wa=function(){this.Ga||n(Error("No 2D orientation set."));ch.A.wa.call(this,"2d");this.a.fillStyle="rgba(50,50,50,0)";this.a.fillRect(0,0,this.za.width,this.za.height);this.Pd=ke("canvas");this.Rd=ke("canvas");N(this.K,vd,this.vj.bind(this))};w.Bf=function(){ch.A.Bf.call(this);dh(this)};w.Ed=function(){ch.A.Ed.call(this);dh(this);var a=this.jb[0];a&&(a.ja=a.oa,a.ka=a.fb)};
w.ub=function(a){ch.A.ub.call(this,a);var b=u;this.get(a.ta)&&(b=q);if(a instanceof Q){var c=a.r,d=a.e,e=a.Aa;if(d!=t&&d.r!=t&&d.r.j)this.ub(d);else if(e!=t&&e.r!=t&&e.r.j)this.Y.load(e,a);else{if(c!=t&&ja(c))if(a.pc!=t){if(a.pc.pe!=c.length||b&&!a.j)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.Y.load(c[b],a);return}else if(c!=t&&c.j){this.Y.load(a,a);return}this.Ba="X"==this.Ga?0:"Y"==this.Ga?1:2;this.Ya=a.c[this.Ba].c;e=t;e=0==this.Ba?a.indexX:1==this.Ba?a.indexY:a.indexZ;c=a.c[this.Ba].c[e].fg;
d=a.c[this.Ba].c[e].eg;this.Gc=a.c[this.Ba].c[e].Jc;this.Ec=a.c[this.Ba].c[e].wc;this.hd=c;this.fd=d;e=this.Pd;e.width=c;e.height=d;var f=this.Rd;f.width=c;f.height=d;this.bg=e.getContext("2d");this.gg=f.getContext("2d");b||(this.qb.add(a),dh(this))}}};function dh(a){var b=Math.min(a.I/(a.hd*a.Gc),a.w/(a.fd*a.Ec));a.K.n[14]=b}w.lj=da();
w.Bh=function(a,b){var c=this.jb[0],d=this.K.n,e=t,f=this.hd,g=this.fd,h=t,m=t;if("Y"==this.Ga)e=this.Ya[parseInt(c.indexY,10)],h=e.Jc,m=e.wc,this.Sb[0]="red",this.Sb[1]="blue";else if("Z"==this.Ga)e=this.Ya[parseInt(c.indexZ,10)],h=e.Jc,m=e.wc,this.Sb[0]="red",this.Sb[1]="green";else{e=this.Ya[parseInt(c.indexX,10)];h=e.wc;m=e.Jc;this.Sb[0]="green";this.Sb[1]="blue";var j=f,f=g,g=j}var k=1*d[12],l=-1*d[13],j=Math.max(d[14],0.6),d=[this.I/2,this.w/2],h=f*h*j,m=g*m*j,s=d[0]-h/2,d=d[1]-m/2,s=s+k*j,
d=d+l*j;return a>s&&a<s+h&&b>d&&b<d+m?(k=(a-s)/h*f,l=(b-d)/m*g,m=e.Wh[4],"X"==this.Ga?(j=f-k,k=l,l=j):"Y"==this.Ga?k=f-k:"Z"==this.Ga&&(k=f-k,l=g-l),k=e.Vh+k*e.Jc,l=e.Ph+l*e.wc,k=Pc(k,l,m,1),f=Qc(),ad(e.Ih,k,f),g=Qc(),ad(e.Jh,k,g),e=Math.round((c.b[0].i[0]*g[0]+c.b[0].i[1]*g[1]+c.b[0].i[2]*g[2]+c.b[0].Oe)/c.b[0].Fc),e>=c.b[0].o?e=c.b[0].o-1:0>e&&(e=0),k=Math.round((c.b[1].i[0]*g[0]+c.b[1].i[1]*g[1]+c.b[1].i[2]*g[2]+c.b[1].Oe)/c.b[1].Fc),k>=c.b[1].o?k=c.b[1].o-1:0>k&&(k=0),l=Math.round((c.b[2].i[0]*
g[0]+c.b[2].i[1]*g[1]+c.b[2].i[2]*g[2]+c.b[2].Oe)/c.b[2].Fc),l>=c.b[2].o?l=c.b[2].o-1:0>l&&(l=0),[[e,k,l],[f[0],f[1],f[2]],[g[0],g[1],g[2]]]):t};
w.bc=function(a,b){ch.A.bc.call(this,a,b);if(0!=this.qb.G.length){var c=this.jb[0],d=t,d=0==this.Ba?c.indexX:1==this.Ba?c.indexY:c.indexZ,e=this.Ya[parseInt(d,10)].fg,f=this.Ya[parseInt(d,10)].eg;this.Gc=this.Ya[parseInt(d,10)].Jc;this.Ec=this.Ya[parseInt(d,10)].wc;this.hd=e;this.fd=f;var g=this.I,h=this.w,m=this.K.n;this.a.save();this.a.clearRect(-g,-h,2*g,2*h);this.a.restore();var j=Math.max(m[14],0.1);this.a.setTransform(j,0,0,j,0,0);var k=1*m[12],m=-1*m[13],l=t;c.e&&(l=c.e.Ve);var s=this.Ya[parseInt(d,
10)],r=s.D.Wb,s=s.e,z=t;s&&(z=s.Wb);var y=this.hd,E=this.fd,F=this.bg,K=this.gg,A=F.getImageData(0,0,y,E),G=K.getImageData(0,0,y,E),I=A.data,H=G.data,R=I.length,M=c.oa,S=c.ha,aa=c.ia,Z=c.ka/M,ba=c.ja/M;if(this.Zf!=d||this.ha!=S||this.ia!=aa||this.ka!=Z||this.ja!=ba||l&&!eg(l,this.hg,0)){var L=this.Pd;L.width=e;L.height=f;L=this.Rd;L.width=e;L.height=f;e=0;do{var L=[0,0,0,0],f=[0,0,0,0],T=r[e]/255*M,P=r[e],P=(P/255-Z)/(ba-Z),P=255*P;T>=S&&T<=aa&&(L=new U(c.Rb[0],c.Rb[1],c.Rb[2]),L=(new U(c.Pb[0],c.Pb[1],
c.Pb[2])).scale(P).add(L.scale(255-P)),L=[Math.floor(L.x),Math.floor(L.y),Math.floor(L.d),255],s&&(-255==l[3]?f=[z[e],z[e+1],z[e+2],z[e+3]]:eg(l,z,e)&&(f=[z[e],z[e+1],z[e+2],z[e+3]])));"X"==this.Ga?(I[e]=L[0],I[e+1]=L[1],I[e+2]=L[2],I[e+3]=L[3],H[e]=f[0],H[e+1]=f[1],H[e+2]=f[2],H[e+3]=f[3]):"Y"==this.Ga?(P=Math.floor(e/(4*y)),P=4*P*y+(4*(y-1)-(e-4*P*y)),I[P]=L[0],I[P+1]=L[1],I[P+2]=L[2],I[P+3]=L[3],H[P]=f[0],H[P+1]=f[1],H[P+2]=f[2],H[P+3]=f[3]):(P=R-1-e,I[P-3]=L[0],I[P-2]=L[1],I[P-1]=L[2],I[P]=L[3],
H[P-3]=f[0],H[P-2]=f[1],H[P-1]=f[2],H[P]=f[3]);e+=4}while(e<R);F.putImageData(A,0,0);K.putImageData(G,0,0);this.Zf=d;this.ha=S;this.ia=aa;this.ka=Z;this.ja=ba;s&&(this.hg=l)}this.a.globalAlpha=1;this.a.translate(g/2/j,h/2/j);"X"==this.Ga&&(this.a.rotate(0.5*Math.PI),d=k,k=m,m=-d);k=-y*this.Gc/2+k;m=-E*this.Ec/2+m;this.a.drawImage(this.Pd,k,m,y*this.Gc,E*this.Ec);s&&c.e.M&&(this.a.globalAlpha=c.e.qa,this.a.drawImage(this.Rd,k,m,y*this.Gc,E*this.Ec));if(this.P.SLICENAVIGATORS&&(this.U.Ud&&this.U.sg&&
!this.U.pb)&&(k=this.U.pa,k=this.Bh(k[0],k[1])))c.yb=k[0][0],c.zb=k[0][1],c.Ab=k[0][2],c.p(u),this.onSliceNavigation(),this.a.setTransform(1,0,0,1,0,0),this.a.lineWidth=1,this.a.beginPath(),this.a.moveTo(this.U.pa[0],0),this.a.lineTo(this.U.pa[0],this.U.pa[1]-10),this.a.moveTo(this.U.pa[0],this.U.pa[1]+10),this.a.lineTo(this.U.pa[0],this.w),this.a.strokeStyle=this.Sb[0],this.a.stroke(),this.a.closePath(),this.a.beginPath(),this.a.moveTo(0,this.U.pa[1]),this.a.lineTo(this.U.pa[0]-10,this.U.pa[1]),
this.a.moveTo(this.U.pa[0]+10,this.U.pa[1]+0.5),this.a.lineTo(this.I,this.U.pa[1]),this.a.strokeStyle=this.Sb[1],this.a.stroke(),this.a.closePath(),this.a.font="10pt Arial",this.a.textAlign="left",this.a.textBaseline="top",this.a.fillStyle="white",this.a.fillText("RAS: "+k[2][0].toFixed(2)+", "+k[2][1].toFixed(2)+", "+k[2][2].toFixed(2),0,0),y=s=m="undefined","undefined"!=typeof c.da[k[1][2].toFixed(0)]&&"undefined"!=typeof c.da[k[1][2].toFixed(0)][k[1][1].toFixed(0)]&&(m=c.da[k[1][2].toFixed(0)][k[1][1].toFixed(0)][k[1][0].toFixed(0)],
c.J&&(s=c.e.da[k[1][2].toFixed(0)][k[1][1].toFixed(0)][k[1][0].toFixed(0)],c.e.Qc&&(y=c.e.Qc.get(s),"undefined"!=typeof y&&(y=y[0])))),this.a.fillText("Background:  "+m+" ("+k[1][0].toFixed(0)+", "+k[1][1].toFixed(0)+", "+k[1][2].toFixed(0)+")",0,15),c.J&&this.a.fillText("Labelmap:  "+y+" ("+s+")",0,30)}};B("X.renderer2D",ch);B("X.renderer2D.prototype.init",ch.prototype.wa);B("X.renderer2D.prototype.add",ch.prototype.add);B("X.renderer2D.prototype.onShowtime",ch.prototype.eh);
B("X.renderer2D.prototype.onRender",ch.prototype.bh);B("X.renderer2D.prototype.onScroll",ch.prototype.kj);B("X.renderer2D.prototype.onWindowLevel",ch.prototype.uj);B("X.renderer2D.prototype.get",ch.prototype.get);B("X.renderer2D.prototype.resetViewAndRender",ch.prototype.Ed);B("X.renderer2D.prototype.xy2ijk",ch.prototype.Bh);B("X.renderer2D.prototype.render",ch.prototype.ac);B("X.renderer2D.prototype.destroy",ch.prototype.de);B("X.renderer2D.prototype.onSliceNavigation",ch.prototype.lj);function kh(){W.call(this);this.g="mesh";Fa(this,new vc)}C(kh,W);B("X.mesh",kh);
