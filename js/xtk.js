/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var m=void 0,n=!0,q=null,r=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}var t,ca=this;function ea(){}
function fa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ga(a){return a!==m}function y(a){return a!=q}function B(a){return"array"==fa(a)}function ha(a){var b=fa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ia(a){return"string"==typeof a}function D(a){return"number"==typeof a}function ja(a){return"function"==fa(a)}function ka(a){a=fa(a);return"object"==a||"array"==a||"function"==a}function la(a){return a[ma]||(a[ma]=++na)}
var ma="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),na=0;function oa(a,b,c){return a.call.apply(a.bind,arguments)}function pa(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function qa(a,b,c){qa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oa:pa;return qa.apply(q,arguments)}function ra(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var ta=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ga(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function G(a,b){function c(){}c.prototype=b.prototype;a.i=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ua(a,b,c){this.Aa=this.za=this.ya=0;3==arguments.length?(this.ya=Number(a),this.za=Number(b),this.Aa=Number(c)):a instanceof ua?(this.ya=Number(a.x()),this.za=Number(a.y()),this.Aa=Number(a.b())):(this.ya=Number(a[0]),this.za=Number(a[1]),this.Aa=Number(a[2]))}
ua.prototype={f:function(){return new ua(this.ya,this.za,this.Aa)},af:function(){return new ua(-this.ya,-this.za,-this.Aa)},wc:function(a){return new ua(this.ya+a.x(),this.za+a.y(),this.Aa+a.b())},fd:function(a){return new ua(this.ya-a.x(),this.za-a.y(),this.Aa-a.b())},Hb:function(a){return new ua(this.ya*a,this.za*a,this.Aa*a)},ph:function(a){return new ua(this.ya/a,this.za/a,this.Aa/a)},tc:function(a){return this.ya*a.x()+this.za*a.y()+this.Aa*a.b()},kg:function(a,b){return this.wc(a.fd(this).Hb(b))},
length:function(){return Math.sqrt(this.tc(this))},od:function(){return this.ph(this.length())},Ke:function(a){return new ua(this.za*a.b()-this.Aa*a.y(),this.Aa*a.x()-this.ya*a.b(),this.ya*a.y()-this.za*a.x())},x:s("ya"),y:s("za"),b:s("Aa")};var H=H||{};H.ej=n;H.Ha=function(a){eval("X.DEV === undefined")||window.console.time(a)};H.Ba=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Wg=0;this.aj=function(){return this.Wg++}};function va(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.kd;++c)window.kd=window[b[c]+"RequestAnimationFrame"],window.Kd=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.kd||(window.kd=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.Kd||(window.Kd=function(a){clearTimeout(a)})})();E("Function.prototype.bind",Function.prototype.bind);E("window.requestAnimationFrame",window.kd);
E("window.cancelAnimationFrame",window.Kd);function wa(a){if(!ya.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(za,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Da,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ea,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Fa,"&quot;"));return a}var za=/&/g,Da=/</g,Ea=/>/g,Fa=/\"/g,ya=/[&<>\"]/;var Ga,Ha,Ia,Ja,Ka,La,Ma;function Na(){return ca.navigator?ca.navigator.userAgent:q}function Oa(){return ca.navigator}Ka=Ja=Ia=Ha=Ga=r;var Pa;if(Pa=Na()){var Qa=Oa();Ga=0==Pa.indexOf("Opera");Ha=!Ga&&-1!=Pa.indexOf("MSIE");Ja=(Ia=!Ga&&-1!=Pa.indexOf("WebKit"))&&-1!=Pa.indexOf("Mobile");Ka=!Ga&&!Ia&&"Gecko"==Qa.product}var Sa=Ga,K=Ha,Ta=Ka,Ua=Ia,Va=Ja,Wa,Xa=Oa();Wa=Xa&&Xa.platform||"";La=-1!=Wa.indexOf("Mac");Ma=-1!=Wa.indexOf("Win");var Ya=!!Oa()&&-1!=(Oa().appVersion||"").indexOf("X11"),Za;
a:{var ab="",bb;if(Sa&&ca.opera)var cb=ca.opera.version,ab="function"==typeof cb?cb():cb;else if(Ta?bb=/rv\:([^\);]+)(\)|;)/:K?bb=/MSIE\s+([^\);]+)(\)|;)/:Ua&&(bb=/WebKit\/(\S+)/),bb)var db=bb.exec(Na()),ab=db?db[1]:"";if(K){var eb,fb=ca.document;eb=fb?fb.documentMode:m;if(eb>parseFloat(ab)){Za=""+eb;break a}}Za=ab}var ib={};
function jb(a){var b;if(!(b=ib[a])){b=0;for(var c=(""+Za).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var j=l.exec(g)||["","",""],o=k.exec(h)||["","",""];if(0==j[0].length&&0==o[0].length)break;b=((0==j[1].length?0:parseInt(j[1],10))<(0==o[1].length?0:parseInt(o[1],10))?-1:(0==j[1].length?0:parseInt(j[1],
10))>(0==o[1].length?0:parseInt(o[1],10))?1:0)||((0==j[2].length)<(0==o[2].length)?-1:(0==j[2].length)>(0==o[2].length)?1:0)||(j[2]<o[2]?-1:j[2]>o[2]?1:0)}while(0==b)}b=ib[a]=0<=b}return b}var kb={};function lb(a){return kb[a]||(kb[a]=K&&document.documentMode&&document.documentMode>=a)};function mb(a,b){for(var c in a)b.call(m,a[c],c,a)}function nb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function ob(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var rb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function sb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<rb.length;f++)c=rb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var tb=Array.prototype,ub=tb.indexOf?function(a,b,c){return tb.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(ia(a))return!ia(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},vb=tb.forEach?function(a,b,c){tb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},wb=tb.map?function(a,b,c){return tb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ia(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},xb=tb.some?function(a,b,c){return tb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return n;return r},yb=tb.every?function(a,b,c){return tb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return r;return n};function zb(a,b){var c=ub(a,b);0<=c&&tb.splice.call(a,c,1)}
function Ab(a){return tb.concat.apply(tb,arguments)}function Bb(a){if(B(a))return Ab(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Cb(a,b,c){return 2>=arguments.length?tb.slice.call(a,b):tb.slice.call(a,b,c)};function Db(a){if("function"==typeof a.Xa)a=a.Xa();else if(ha(a)||ia(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Eb(a){if("function"==typeof a.Oa)return a.Oa();if(ia(a))return a.split("");if(ha(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return nb(a)}
function Fb(a,b){if("function"==typeof a.every)return a.every(b,m);if(ha(a)||ia(a))return yb(a,b,m);var c;if("function"==typeof a.bd)c=a.bd();else if("function"!=typeof a.Oa)if(ha(a)||ia(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=ob(a);else c=m;for(var d=Eb(a),e=d.length,f=0;f<e;f++)if(!b.call(m,d[f],c&&c[f],a))return r;return n};var Gb="StopIteration"in ca?ca.StopIteration:Error("StopIteration");function Hb(){}Hb.prototype.next=function(){i(Gb)};Hb.prototype.Cc=function(){return this};function Lb(a){if(a instanceof Hb)return a;if("function"==typeof a.Cc)return a.Cc(r);if(ha(a)){var b=0,c=new Hb;c.next=function(){for(;;){b>=a.length&&i(Gb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Mb(a,b){if(ha(a))try{vb(a,b,m)}catch(c){c!==Gb&&i(c)}else{a=Lb(a);try{for(;;)b.call(m,a.next(),m,a)}catch(d){d!==Gb&&i(d)}}};function Nb(a,b){this.F={};this.v=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.De(a)}t=Nb.prototype;t.N=0;t.pd=0;t.Xa=s("N");t.Oa=function(){Ob(this);for(var a=[],b=0;b<this.v.length;b++)a.push(this.F[this.v[b]]);return a};t.bd=function(){Ob(this);return this.v.concat()};t.Ie=function(a){for(var b=0;b<this.v.length;b++){var c=this.v[b];if(Pb(this.F,c)&&this.F[c]==a)return n}return r};
t.Yc=function(a,b){if(this===a)return n;if(this.N!=a.Xa())return r;var c=b||Qb;Ob(this);for(var d,e=0;d=this.v[e];e++)if(!c(this.get(d),a.get(d)))return r;return n};function Qb(a,b){return a===b}t.clear=function(){this.F={};this.pd=this.N=this.v.length=0};t.remove=function(a){return Pb(this.F,a)?(delete this.F[a],this.N--,this.pd++,this.v.length>2*this.N&&Ob(this),n):r};
function Ob(a){if(a.N!=a.v.length){for(var b=0,c=0;b<a.v.length;){var d=a.v[b];Pb(a.F,d)&&(a.v[c++]=d);b++}a.v.length=c}if(a.N!=a.v.length){for(var e={},c=b=0;b<a.v.length;)d=a.v[b],Pb(e,d)||(a.v[c++]=d,e[d]=1),b++;a.v.length=c}}t.get=function(a,b){return Pb(this.F,a)?this.F[a]:b};t.set=function(a,b){Pb(this.F,a)||(this.N++,this.v.push(a),this.pd++);this.F[a]=b};t.De=function(a){var b;a instanceof Nb?(b=a.bd(),a=a.Oa()):(b=ob(a),a=nb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};t.f=function(){return new Nb(this)};
t.Cc=function(a){Ob(this);var b=0,c=this.v,d=this.F,e=this.pd,f=this,g=new Hb;g.next=function(){for(;;){e!=f.pd&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Gb);var g=c[b++];return a?g:d[g]}};return g};function Pb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Rb(a){this.F=new Nb;a&&this.De(a)}function Sb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+la(a):b.substr(0,1)+a}t=Rb.prototype;t.Xa=function(){return this.F.Xa()};t.add=function(a){this.F.set(Sb(a),a)};t.De=function(a){for(var a=Eb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};t.ae=function(a){for(var a=Eb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};t.remove=function(a){return this.F.remove(Sb(a))};t.clear=function(){this.F.clear()};
t.contains=function(a){a=Sb(a);return Pb(this.F.F,a)};t.ig=function(a){for(var b=new Rb,a=Eb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};t.Oa=function(){return this.F.Oa()};t.f=function(){return new Rb(this)};t.Yc=function(a){return this.Xa()==Db(a)&&Tb(this,a)};
function Tb(a,b){var c=Db(b);if(a.Xa()>c)return r;!(b instanceof Rb)&&5<c&&(b=new Rb(b));return Fb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Ie)a=b.Ie(a);else if(ha(b)||ia(b))a=0<=ub(b,a);else a:{for(var c in b)if(b[c]==a){a=n;break a}a=r}return a})}t.Cc=function(){return this.F.Cc(r)};function Ub(){}Ub.prototype.Vf=r;Ub.prototype.Na=function(){this.Vf||(this.Vf=n,this.O())};Ub.prototype.O=function(){this.mh&&Vb.apply(q,this.mh)};function Wb(a){a&&"function"==typeof a.Na&&a.Na()}function Vb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ha(d)?Vb.apply(q,d):Wb(d)}};function Xb(a,b){this.mg=b;this.ad=[];a>this.mg&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.ad.push(this.Md())}G(Xb,Ub);t=Xb.prototype;t.Sf=q;t.Uf=q;function Yb(a,b){a.ad.length<a.mg?a.ad.push(b):a.Ne(b)}t.Md=function(){return this.Sf?this.Sf():{}};t.Ne=function(a){if(this.Uf)this.Uf(a);else if(ka(a))if(ja(a.Na))a.Na();else for(var b in a)delete a[b]};t.O=function(){Xb.i.O.call(this);for(var a=this.ad;a.length;)this.Ne(a.pop());delete this.ad};function Zb(){this.Zc=[];this.gf=new Nb;this.Ig=this.Jg=this.Kg=this.Fg=0;this.nd=new Nb;this.Pf=this.Hg=0;this.bf=1;this.Oe=new Xb(0,4E3);this.Oe.Md=function(){return new $b};this.Gg=new Xb(0,50);this.Gg.Md=function(){return new ac};var a=this;this.Se=new Xb(0,2E3);this.Se.Md=function(){return""+a.bf++};this.Se.Ne=aa()}function ac(){this.uf=this.time=this.count=0}
ac.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.uf&&a.push(" [VarAlloc = ",this.uf,"]");return a.join("")};function $b(){}function bc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(cc(a.Wf-c));e.push(" ",dc(a.Wf-b));0==a.Pe?e.push(" Start        "):1==a.Pe?(e.push(" Done "),e.push(cc(a.Vj-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Xi&&e.push("[VarAlloc ",a.Xi,"] ");return e.join("")}
$b.prototype.toString=function(){return this.type==q?this.jh:"["+this.type+"] "+this.jh};Zb.prototype.reset=function(){for(var a=0;a<this.Zc.length;a++){var b=this.Oe.id;b&&Yb(this.Se,b);Yb(this.Oe,this.Zc[a])}this.Zc.length=0;this.gf.clear();this.Fg=ta();this.Pf=this.Hg=this.Ig=this.Jg=this.Kg=0;b=this.nd.bd();for(a=0;a<b.length;a++){var c=this.nd.get(b[a]);c.count=0;c.time=0;c.uf=0;Yb(this.Gg,c)}this.nd.clear()};
Zb.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Zc.length;d++){var e=this.Zc[d];1==e.Pe&&c.pop();a.push(" ",bc(e,this.Fg,b,c.join("")));b=e.Wf;a.push("\n");0==e.Pe&&c.push("|  ")}if(0!=this.gf.Xa()){var f=ta();a.push(" Unstopped timers:\n");Mb(this.gf,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",dc(b.startTime),")\n")})}b=this.nd.bd();for(d=0;d<b.length;d++)c=this.nd.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Hg,"\n","Total comments created ",
this.Pf,"\n","Overhead start: ",this.Kg," ms\n","Overhead end: ",this.Jg," ms\n","Overhead comment: ",this.Ig," ms\n");return a.join("")};function cc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function dc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new Zb;function ec(){}var fc=0;t=ec.prototype;t.key=0;t.yc=r;t.Fe=r;t.ha=function(a,b,c,d,e,f){ja(a)?this.jg=n:a&&a.handleEvent&&ja(a.handleEvent)?this.jg=r:i(Error("Invalid listener argument"));this.dd=a;this.Bg=b;this.src=c;this.type=d;this.capture=!!e;this.Qe=f;this.Fe=r;this.key=++fc;this.yc=r};t.handleEvent=function(a){return this.jg?this.dd.call(this.Qe||this.src,a):this.dd.handleEvent.call(this.dd,a)};!K||lb(9);var gc=!K||lb(9),hc=K&&!jb("8");!Ua||jb("528");Ta&&jb("1.9b")||K&&jb("8")||Sa&&jb("9.5")||Ua&&jb("528");!Ta||jb("8");function ic(a,b){this.type=a;this.currentTarget=this.target=b}G(ic,Ub);t=ic.prototype;t.O=function(){delete this.type;delete this.target;delete this.currentTarget};t.fc=r;t.ld=n;t.stopPropagation=function(){this.fc=n};t.preventDefault=function(){this.ld=r};function jc(a){jc[" "](a);return a}jc[" "]=ea;function kc(a,b){a&&this.ha(a,b)}G(kc,ic);t=kc.prototype;t.target=q;t.relatedTarget=q;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=r;t.altKey=r;t.shiftKey=r;t.metaKey=r;t.Da=q;
t.ha=function(a,b){var c=this.type=a.type;ic.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ta){var e;a:{try{jc(d.nodeName);e=n;break a}catch(f){}e=r}e||(d=q)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Ua||a.offsetX!==m?a.offsetX:a.layerX;this.offsetY=Ua||a.offsetY!==m?a.offsetY:a.layerY;this.clientX=a.clientX!==m?a.clientX:a.pageX;this.clientY=a.clientY!==m?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Da=a;delete this.ld;delete this.fc};t.stopPropagation=function(){kc.i.stopPropagation.call(this);this.Da.stopPropagation?this.Da.stopPropagation():this.Da.cancelBubble=n};
t.preventDefault=function(){kc.i.preventDefault.call(this);var a=this.Da;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,hc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.yh=s("Da");t.O=function(){kc.i.O.call(this);this.relatedTarget=this.currentTarget=this.target=this.Da=q};var lc={},mc={},nc={},oc={};
function L(a,b,c,d,e){if(b){if(B(b)){for(var f=0;f<b.length;f++)L(a,b[f],c,d,e);return q}var d=!!d,g=mc;b in g||(g[b]={N:0,Fa:0});g=g[b];d in g||(g[d]={N:0,Fa:0},g.N++);var g=g[d],h=la(a),l;g.Fa++;if(g[h]){l=g[h];for(f=0;f<l.length;f++)if(g=l[f],g.dd==c&&g.Qe==e){if(g.yc)break;return l[f].key}}else l=g[h]=[],g.N++;f=pc();f.src=a;g=new ec;g.ha(c,f,a,b,d,e);c=g.key;f.key=c;l.push(g);lc[c]=g;nc[h]||(nc[h]=[]);nc[h].push(g);a.addEventListener?(a==ca||!a.Tf)&&a.addEventListener(b,f,d):a.attachEvent(b in
oc?oc[b]:oc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function pc(){var a=qc,b=gc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function rc(a,b,c,d,e){if(B(b))for(var f=0;f<b.length;f++)rc(a,b[f],c,d,e);else a=L(a,b,c,d,e),lc[a].Fe=n}
function sc(a,b,c,d,e){if(B(b))for(var f=0;f<b.length;f++)sc(a,b[f],c,d,e);else{d=!!d;a:{f=mc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=la(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].dd==c&&a[f].capture==d&&a[f].Qe==e){tc(a[f].key);break}}}
function tc(a){if(!lc[a])return r;var b=lc[a];if(b.yc)return r;var c=b.src,d=b.type,e=b.Bg,f=b.capture;c.removeEventListener?(c==ca||!c.Tf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in oc?oc[d]:oc[d]="on"+d,e);c=la(c);e=mc[d][f][c];if(nc[c]){var g=nc[c];zb(g,b);0==g.length&&delete nc[c]}b.yc=n;e.qg=n;uc(d,f,c,e);delete lc[a];return n}
function uc(a,b,c,d){if(!d.Xd&&d.qg){for(var e=0,f=0;e<d.length;e++)d[e].yc?d[e].Bg.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.qg=r;0==f&&(delete mc[a][b][c],mc[a][b].N--,0==mc[a][b].N&&(delete mc[a][b],mc[a].N--),0==mc[a].N&&delete mc[a])}}function vc(a){var b,c=0,d=b==q;b=!!b;if(a==q)mb(nc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)tc(f.key),c++}});else if(a=la(a),nc[a])for(var a=nc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)tc(f.key),c++}}
function wc(a){var b=xc,a=la(a),c=nc[a];if(c){var d=ga(b),e=ga(m);return d&&e?(c=mc[b],!!c&&!!c[m]&&a in c[m]):!d&&!e?n:xb(c,function(a){return d&&a.type==b||e&&a.capture==m})}return r}function yc(a,b,c,d,e){var f=1,b=la(b);if(a[b]){a.Fa--;a=a[b];a.Xd?a.Xd++:a.Xd=1;try{for(var g=a.length,h=0;h<g;h++){var l=a[h];l&&!l.yc&&(f&=zc(l,e)!==r)}}finally{a.Xd--,uc(c,d,b,a)}}return Boolean(f)}function zc(a,b){var c=a.handleEvent(b);a.Fe&&tc(a.key);return c}
function qc(a,b){if(!lc[a])return n;var c=lc[a],d=c.type,e=mc;if(!(d in e))return n;var e=e[d],f,g;if(!gc){var h;if(!(h=b))a:{h=["window","event"];for(var l=ca;f=h.shift();)if(y(l[f]))l=l[f];else{h=q;break a}h=l}f=h;h=n in e;l=r in e;if(h){if(0>f.keyCode||f.returnValue!=m)return n;a:{var k=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(j){k=n}if(k||f.returnValue==m)f.returnValue=n}}k=new kc;k.ha(f,this);f=n;try{if(h){for(var o=[],v=k.currentTarget;v;v=v.parentNode)o.push(v);g=e[n];g.Fa=g.N;for(var p=
o.length-1;!k.fc&&0<=p&&g.Fa;p--)k.currentTarget=o[p],f&=yc(g,o[p],d,n,k);if(l){g=e[r];g.Fa=g.N;for(p=0;!k.fc&&p<o.length&&g.Fa;p++)k.currentTarget=o[p],f&=yc(g,o[p],d,r,k)}}else f=zc(c,k)}finally{o&&(o.length=0),k.Na()}return f}d=new kc(b,this);try{f=zc(c,d)}finally{d.Na()}return f}var Ac=0;function Bc(a){return a+"_"+Ac++};function Cc(){}G(Cc,Ub);t=Cc.prototype;t.Tf=n;t.Zd=q;t.kf=ba("Zd");t.addEventListener=function(a,b,c,d){L(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){sc(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=mc;if(b in c){if(ia(a))a=new ic(a,this);else if(a instanceof ic)a.target=a.target||this;else{var d=a,a=new ic(b,this);sb(a,d)}var d=1,e,c=c[b],b=n in c,f;if(b){e=[];for(f=this;f;f=f.Zd)e.push(f);f=c[n];f.Fa=f.N;for(var g=e.length-1;!a.fc&&0<=g&&f.Fa;g--)a.currentTarget=e[g],d&=yc(f,e[g],a.type,n,a)&&a.ld!=r}if(r in c)if(f=c[r],f.Fa=f.N,b)for(g=0;!a.fc&&g<e.length&&f.Fa;g++)a.currentTarget=e[g],d&=yc(f,e[g],a.type,r,a)&&a.ld!=r;else for(e=this;!a.fc&&e&&
f.Fa;e=e.Zd)a.currentTarget=e,d&=yc(f,e,a.type,r,a)&&a.ld!=r;a=Boolean(d)}else a=n;return a};t.O=function(){Cc.i.O.call(this);vc(this);this.Zd=q};function M(){this.c="base";this.pa=window["X.counter"].aj();this.e=r}G(M,Cc);M.prototype.__defineGetter__("classname",s("c"));M.prototype.__defineGetter__("id",s("pa"));E("X.base",M);function Gc(a,b){this.wa=new ua(a);this.$=new ua(b)}Gc.prototype={f:function(){return new Gc(this.wa.f(),this.$.f())},dc:function(){this.$=this.$.af()},Mh:function(a,b){return new Gc(this.wa.kg(a.wa,b),this.$.kg(a.$,b))}};function Hc(a,b){this.$=a;this.qd=b}Hc.prototype={f:function(){return new Hc(this.$.f(),this.qd)},dc:function(){this.$=this.$.af();this.qd=-this.qd}};function Ic(a,b){this.jb=a;this.ee=b;var c=a[0].wa,d=a[2].wa,d=a[1].wa.fd(c).Ke(d.fd(c)).od();this.va=new Hc(d,d.tc(c))}
Ic.prototype={f:function(){var a=this.jb.map(function(a){return a.f()});return new Ic(a,this.ee)},dc:function(){this.jb.reverse().map(function(a){a.dc()});this.va.dc()},Eg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.jb.length;h++){var l=a.$.tc(this.jb[h].wa)-a.qd,l=-1.0E-5>l?2:1.0E-5<l?1:0,f=f|l;g.push(l)}switch(f){case 0:(0<a.$.tc(this.va.$)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.jb.length;h++){var k=(h+1)%this.jb.length,l=g[h],
j=g[k],f=this.jb[h],k=this.jb[k];2!=l&&b.push(f);1!=l&&c.push(2!=l?f.f():f);3==(l|j)&&(l=(a.qd-a.$.tc(f.wa))/a.$.tc(k.wa.fd(f.wa)),l=f.Mh(k,l),b.push(l),c.push(l.f()))}3<=b.length&&d.push(new Ic(b,this.ee));3<=c.length&&e.push(new Ic(c,this.ee))}}};function Jc(a){this.fa=this.ga=this.va=q;this.B=[];a&&this.pc(a)}
Jc.prototype={f:function(){var a=new Jc;a.Ii(this.va&&this.va.f());a.Hi(this.ga&&this.ga.f());a.Gi(this.fa&&this.fa.f());a.ce(this.B.map(function(a){return a.f()}));return a},W:function(){for(var a=0;a<this.B.length;a++)this.B[a].dc();this.va.dc();this.ga&&this.ga.W();this.fa&&this.fa.W();a=this.ga;this.ga=this.fa;this.fa=a},He:function(a){if(!this.va)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Eg(this.va,b,c,b,c);this.ga&&(b=this.ga.He(b));c=this.fa?this.fa.He(c):[];return b.concat(c)},
Ma:function(a){this.B=a.He(this.B);this.ga&&this.ga.Ma(a);this.fa&&this.fa.Ma(a)},Eb:function(){var a=this.B.slice();this.ga&&(a=a.concat(this.ga.Eb()));this.fa&&(a=a.concat(this.fa.Eb()));return a},pc:function(a){if(a.length){this.va||(this.va=a[0].va.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Eg(this.va,this.B,this.B,b,c);b.length&&(this.ga||(this.ga=new Jc),this.ga.pc(b));c.length&&(this.fa||(this.fa=new Jc),this.fa.pc(c))}},Ii:ba("va"),Hi:ba("ga"),Gi:ba("fa"),ce:ba("B")};function Kc(){this.B=[]}function Lc(a){var b=new Kc;b.ce(a);return b}
Kc.prototype={f:function(){var a=new Kc;a.ce(this.B.map(function(a){return a.f()}));return a},rf:function(a){var b=new Jc(this.f().B),a=new Jc(a.f().B);b.Ma(a);a.Ma(b);a.W();a.Ma(b);a.W();b.pc(a.Eb());return Lc(b.Eb())},xa:function(a){var b=new Jc(this.f().B),a=new Jc(a.f().B);b.W();b.Ma(a);a.Ma(b);a.W();a.Ma(b);a.W();b.pc(a.Eb());b.W();return Lc(b.Eb())},Ue:function(a){var b=new Jc(this.f().B),a=new Jc(a.f().B);b.W();a.Ma(b);a.W();b.Ma(a);a.Ma(b);b.pc(a.Eb());b.W();return Lc(b.Eb())},inverse:function(){var a=
this.f();a.B.map(function(a){a.dc()});return a},ce:ba("B")};function Mc(){M.call(this);this.c="indexer";this.Be=[];this.tb={}}G(Mc,M);Mc.prototype.add=function(a){y(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.tb||(this.tb[b]=this.Be.length,this.Be.push(a));return this.tb[b]};Mc.prototype.unique=s("Be");function Nc(a){M.call(this);this.c="file";this.zd=a;this.e=n}G(Nc,M);function Oc(){this.Lb=this.p=q}Oc.prototype.__defineSetter__("file",function(a){this.p=!y(a)||B(a)&&0==a.length?q:B(a)?1==a.length?new Nc(a[0]):wb(a,function(a){var c=new O;c.p=new Nc(a);return c}):new Nc(a)});Oc.prototype.__defineGetter__("file",function(){return!this.p?"":B(this.p)?this.p.map(function(a){return a.p.zd}):this.p.zd});Oc.prototype.__defineGetter__("filedata",s("Lb"));
Oc.prototype.__defineSetter__("filedata",function(a){if(!y(a)||B(a)&&0==a.length)this.Lb=q;if(B(a))if(1==a.length)this.Lb=a[0];else{var b=this.p.length,c;for(c=0;c<b;c++)this.p[c].Lb=a[c]}else this.Lb=a});function Pc(){M.call(this);this.c="colortable";this.tb=new Nb;va(this,new Oc)}G(Pc,M);Pc.prototype.add=function(a,b,c,d,e,f){(!D(a)||!D(c)||!D(d)||!D(e)||!D(f))&&i(Error("Invalid color table entry."));this.tb.set(a,[b,c,d,e,f]);this.e=n};function Qc(a,b,c){this.x=ga(a)?a:0;this.y=ga(b)?b:0;this.b=ga(c)?c:0}Qc.prototype.f=function(){return new Qc(this.x,this.y,this.b)};Qc.prototype.qf=function(){return[this.x,this.y,this.b]};function P(a,b,c){this.x=a;this.y=b;this.b=c}G(P,Qc);t=P.prototype;t.f=function(){return new P(this.x,this.y,this.b)};t.Fb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};t.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};t.W=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};t.normalize=function(){return this.scale(1/this.Fb())};t.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
t.xa=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};t.Yc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Rc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Sc(a,b){return new P(a.x+b.x,a.y+b.y,a.b+b.b)}function Tc(a,b){return new P(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Uc(a,b){this.x=ga(a)?a:0;this.y=ga(b)?b:0}Uc.prototype.f=function(){return new Uc(this.x,this.y)};function Vc(a,b){return new Uc(a.x-b.x,a.y-b.y)};function Wc(a,b){this.x=a;this.y=b}G(Wc,Uc);t=Wc.prototype;t.f=function(){return new Wc(this.x,this.y)};t.Fb=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};t.scale=function(a){this.x*=a;this.y*=a;return this};t.W=function(){this.x=-this.x;this.y=-this.y;return this};t.normalize=function(){return this.scale(1/this.Fb())};t.add=function(a){this.x+=a.x;this.y+=a.y;return this};t.xa=function(a){this.x-=a.x;this.y-=a.y;return this};
t.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};t.Yc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Xc(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};function Yc(a,b){this.width=a;this.height=b}function Zc(a,b){return a==b?n:!a||!b?r:a.width==b.width&&a.height==b.height}Yc.prototype.f=function(){return new Yc(this.width,this.height)};Yc.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Yc.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};Yc.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function $c(a,b){if(a instanceof $c)this.S=a.qf();else{var c;if(c=ha(a))a:{for(var d=c=0;d<a.length;d++){if(!ha(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var e=0;e<a[d].length;e++)if(!D(a[d][e])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.S=Bb(a):a instanceof Yc?this.S=ad(a.height,a.width):D(a)&&D(b)&&0<a&&0<b?this.S=ad(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.G=new Yc(this.S[0].length,this.S.length)}
function bd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new $c(b)}function cd(a,b,c){for(var d=0;d<a.ua().height;d++)for(var e=0;e<a.ua().width;e++)b.call(c,a.S[d][e],d,e,a)}function dd(a,b){var c=new $c(a.ua());cd(a,function(d,e,f){c.S[e][f]=b.call(m,d,e,f,a)});return c}function ad(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}t=$c.prototype;
t.add=function(a){Zc(this.G,a.ua())||i(Error("Matrix summation is only supported on arrays of equal size"));return dd(this,function(b,c,d){return b+a.S[c][d]})};t.Yc=function(a,b){if(this.G.width!=a.G.width||this.G.height!=a.G.height)return r;for(var c=b||0,d=0;d<this.G.height;d++)for(var e=0;e<this.G.width;e++)if(!(Math.abs(this.S[d][e]-a.S[d][e])<=(c||1.0E-6)))return r;return n};t.ua=s("G");t.T=function(a,b){return!(0<=a&&a<this.G.height&&0<=b&&b<this.G.width)?q:this.S[a][b]};
t.k=function(a,b,c){0<=a&&a<this.G.height&&0<=b&&b<this.G.width||i(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.G.height+","+this.G.width+")"));this.S[a][b]=c};t.multiply=function(a){if(a instanceof $c)return this.G.width!=a.ua().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),ed(this,a);if(D(a))return fd(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
t.xa=function(a){Zc(this.G,a.ua())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return dd(this,function(b,c,d){return b-a.S[c][d]})};t.qf=s("S");function ed(a,b){var c=new $c(a.G.height,b.ua().width);cd(c,function(a,e,f){for(var g=a=0;g<this.G.width;g++)a+=this.T(e,g)*b.T(g,f);c.k(e,f,a)},a);return c}function fd(a,b){return dd(a,function(a){return a*b})};function gd(a,b){$c.call(this,a,b);this.c="matrix"}G(gd,$c);function hd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new gd(b)}t=gd.prototype;t.Ea=function(){var a=[],b=this.ua(),c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.T(c,d));return a};
t.translate=function(a){this.G.width!=this.G.height&&i(Error("Can not translate non-square matrix."));var b=this.ua(),c=bd(b.height);a instanceof Wc&&3==b.height?(c.k(0,2,a.x),c.k(1,2,a.y)):a instanceof P&&4==b.height?(c.k(0,3,a.x),c.k(1,3,a.y),c.k(2,3,a.b)):i(Error("Translation failed."));return new gd(this.multiply(c))};
t.rotate=function(a,b){(4!=this.ua().height||this.G.width!=this.G.height)&&i(Error("Only 4x4 matrices can be rotated."));(!y(b)||!(b instanceof P))&&i(Error("Invalid axis vector."));D(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=bd(4);f.k(0,0,d+c.x*c.x*(1-d));f.k(0,1,c.x*c.y*(1-d)-c.b*e);f.k(0,2,c.x*c.b*(1-d)+c.y*e);f.k(1,0,c.y*c.x*(1-d)+c.b*e);f.k(1,1,d+c.y*c.y*(1-d));f.k(1,2,c.y*c.b*(1-d)-c.x*e);f.k(2,0,c.b*c.x*(1-d)-c.y*e);f.k(2,1,c.b*c.y*(1-d)+c.x*e);f.k(2,
2,d+c.b*c.b*(1-d));return new gd(this.multiply(f))};t.Qa=function(a){var b=this.ua(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof P&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new $c(c));return new P(parseFloat(a.T(0,0)),parseFloat(a.T(1,0)),parseFloat(a.T(2,0)))};t.Vi=function(a,b){var c=this.S[a];this.S[a]=this.S[b];this.S[b]=c};
t.Ui=function(a,b){for(var c=this.ua(),d=0,d=0;d<c.height;d++){var e=this.T(d,a);e||(e=0);var f=this.T(d,b);f||(f=0);this.k(d,a,f);this.k(d,b,e)}};E("X.matrix",gd);E("X.matrix.createIdentityMatrix",hd);E("X.matrix.prototype.flatten",gd.prototype.Ea);E("X.matrix.prototype.translate",gd.prototype.translate);E("X.matrix.prototype.rotate",gd.prototype.rotate);E("X.matrix.prototype.toArray",gd.prototype.qf);E("X.matrix.prototype.getValueAt",gd.prototype.T);E("X.matrix.prototype.setValueAt",gd.prototype.k);
E("X.matrix.prototype.multiplyByVector",gd.prototype.Qa);E("X.matrix.prototype.swapRows",gd.prototype.Vi);E("X.matrix.prototype.swapCols",gd.prototype.Ui);function md(){M.call(this);this.c="transform";this.D=hd(4);this.Af=new Float32Array(this.D.Ea())}G(md,M);md.prototype.__defineGetter__("matrix",s("D"));md.prototype.__defineSetter__("matrix",function(a){(!y(a)||!(a instanceof gd))&&i(Error("Invalid matrix."));this.D=a;this.o()});t=md.prototype;t.Ai=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.D=this.D.rotate(a*Math.PI/180,new P(0,1,0));this.o()};
t.Bi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.D=this.D.rotate(a*Math.PI/180,new P(1,0,0));this.o()};t.Ci=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.D=this.D.rotate(a*Math.PI/180,new P(0,0,1));this.o()};t.Yi=function(a){D(a)||i(Error("Invalid distance."));this.D=this.D.translate(new P(a,0,0));this.o()};t.Zi=function(a){D(a)||i(Error("Invalid distance."));this.D=this.D.translate(new P(0,a,0));this.o()};
t.$i=function(a){D(a)||i(Error("Invalid distance."));this.D=this.D.translate(new P(0,0,a));this.o()};function nd(a,b,c){var d=a.D.T(b,c);d||(d=0);a.D.k(b,c,-1*d);a.o()}t.uh=function(){nd(this,0,0)};t.vh=function(){nd(this,1,1)};t.wh=function(){nd(this,2,2)};t.o=function(){this.Af=new Float32Array(this.D.Ea());this.e=n};E("X.transform",md);E("X.transform.prototype.rotateX",md.prototype.Ai);E("X.transform.prototype.rotateY",md.prototype.Bi);E("X.transform.prototype.rotateZ",md.prototype.Ci);
E("X.transform.prototype.translateX",md.prototype.Yi);E("X.transform.prototype.translateY",md.prototype.Zi);E("X.transform.prototype.translateZ",md.prototype.$i);E("X.transform.prototype.flipX",md.prototype.uh);E("X.transform.prototype.flipY",md.prototype.vh);E("X.transform.prototype.flipZ",md.prototype.wh);E("X.transform.prototype.modified",md.prototype.o);function od(){M.call(this);this.c="texture";this.sa=this.mb=this.p=q;this.Ab=this.Bb=0;va(this,new Oc)}G(od,M);E("X.texture",od);function R(a,b){M.call(this);this.c="triplets";this.Sb=Infinity;this.Pb=-Infinity;this.Tb=Infinity;this.Qb=-Infinity;this.Ub=Infinity;this.Rb=-Infinity;this.rd=[0,0,0];this.w=0;this.L=new Float32Array(a);y(b)&&(this.L=b.L.subarray(0,b.L.length),this.w=this.L.length,this.Sb=b.Sb,this.Pb=b.Pb,this.Tb=b.Tb,this.Qb=b.Qb,this.Ub=b.Ub,this.Rb=b.Rb,this.rd=b.rd.slice())}G(R,M);t=R.prototype;
t.add=function(a,b,c){this.Sb=Math.min(this.Sb,a);this.Pb=Math.max(this.Pb,a);this.Tb=Math.min(this.Tb,b);this.Qb=Math.max(this.Qb,b);this.Ub=Math.min(this.Ub,c);this.Rb=Math.max(this.Rb,c);this.rd=[(this.Sb+this.Pb)/2,(this.Tb+this.Qb)/2,(this.Ub+this.Rb)/2];this.e=n;this.L[this.w++]=a;this.L[this.w++]=b;this.L[this.w++]=c;return this.w/3};t.Ac=function(){if(this.w!=this.L.length){var a=new Float32Array(this.w);a.set(this.L.subarray(0,this.w));this.L=a}};
t.get=function(a){a*=3;return[this.L[a],this.L[a+1],this.L[a+2]]};t.remove=function(){i(Error("Not implemented."))};t.clear=function(){this.L=new Float32Array(this.L.length);this.e=n};R.prototype.__defineGetter__("count",function(){this.Ac();return this.L.length/3});R.prototype.__defineGetter__("length",function(){this.Ac();return this.L.length});E("X.triplets",R);E("X.triplets.prototype.add",R.prototype.add);E("X.triplets.prototype.resize",R.prototype.Ac);E("X.triplets.prototype.get",R.prototype.get);
E("X.triplets.prototype.remove",R.prototype.remove);E("X.triplets.prototype.clear",R.prototype.clear);function pd(){this.ka=qd;this.ac=new md;this.Jb=[1,1,1];this.Zb=this.A=this.U=this.h=this.g=q;this.oc=[];this.Ka=n;this.nc=this.Oc=1;this.jc=q;this.Hc=r;this.V=1;this.z=0}var qd="TRIANGLES";pd.prototype.__defineSetter__("type",function(a){return this.ka=a});pd.prototype.__defineGetter__("type",s("ka"));pd.prototype.__defineGetter__("texture",function(){this.A||(this.A=new od);return this.A});pd.prototype.__defineGetter__("transform",s("ac"));pd.prototype.__defineGetter__("points",s("g"));
pd.prototype.__defineSetter__("points",ba("g"));pd.prototype.__defineGetter__("normals",s("h"));pd.prototype.__defineSetter__("normals",ba("h"));pd.prototype.__defineGetter__("colors",s("U"));pd.prototype.__defineSetter__("colors",ba("U"));pd.prototype.__defineGetter__("color",s("Jb"));pd.prototype.__defineSetter__("color",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Jb=a;this.e=n});
pd.prototype.__defineGetter__("opacity",s("V"));pd.prototype.__defineSetter__("opacity",function(a){(!D(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.V=a;this.e=n});pd.prototype.__defineGetter__("caption",s("jc"));pd.prototype.__defineSetter__("caption",function(a){this.jc=a;this.e=n});pd.prototype.__defineGetter__("visible",s("Ka"));
pd.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.Ka=a;this.e=n});pd.prototype.__defineGetter__("pointsize",s("Oc"));pd.prototype.__defineSetter__("pointsize",function(a){D(a)||i(Error("Invalid point size."));this.Oc=a;this.e=n});pd.prototype.__defineGetter__("magicmode",s("Hc"));pd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.Hc=a;this.e=n});
pd.prototype.__defineGetter__("linewidth",s("nc"));pd.prototype.__defineSetter__("linewidth",function(a){D(a)||i(Error("Invalid line width."));this.nc=a;this.e=n});function rd(){this.Ja=Infinity;this.ba=this.Ca=-Infinity;this.ca=Infinity;this.wb=[0,0,0];this.ub=[1,1,1]}rd.prototype.__defineGetter__("lowerThreshold",s("ba"));rd.prototype.__defineSetter__("lowerThreshold",ba("ba"));rd.prototype.__defineGetter__("upperThreshold",s("ca"));rd.prototype.__defineSetter__("upperThreshold",ba("ca"));rd.prototype.__defineGetter__("min",s("Ja"));rd.prototype.__defineGetter__("max",s("Ca"));rd.prototype.__defineGetter__("minColor",s("wb"));
rd.prototype.__defineSetter__("minColor",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid min. color."));this.wb=a});rd.prototype.__defineGetter__("maxColor",s("ub"));rd.prototype.__defineSetter__("maxColor",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid max. color."));this.ub=a});function sd(){M.call(this);this.c="scalars";this.Dc=this.u=q;this.Lf=n;this.je=0;va(this,new Oc);va(this,new rd);this.wb=[0,1,0];this.ub=[1,0,0]}G(sd,M);sd.prototype.__defineGetter__("array",s("u"));sd.prototype.__defineSetter__("array",function(a){this.Dc=this.u=a;this.e=n});sd.prototype.__defineGetter__("interpolation",s("je"));sd.prototype.__defineSetter__("interpolation",ba("je"));E("X.scalars",sd);function T(a){M.call(this);this.c="object";this.d=[];this.t=this.X=q;va(this,new pd);y(a)&&this.bc(a)}G(T,M);
T.prototype.bc=function(a){this.ka=a.ka;this.ac=new md;this.ac.D=new gd(a.ac.D.S);this.Jb=a.Jb.slice();a.g&&(this.g=new R(a.g.length,a.g));a.h&&(this.h=new R(a.h.length,a.h));a.U&&(this.U=new R(a.U.length,a.U));this.A=a.A;this.Zb=a.Zb;a.p&&(this.p=new Nc((new String(a.p.zd)).toString()));this.V=a.V;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new H[b[d].c](b[d]));this.Ka=a.Ka;this.Oc=a.Oc;this.nc=a.nc;a.jc&&(this.jc=(new String(a.jc)).toString());this.Hc=a.Hc;this.oc=
a.oc.slice();this.e=n};T.prototype.__defineGetter__("colortable",function(){this.X||(this.X=new Pc);return this.X});T.prototype.__defineGetter__("scalars",function(){this.t||(this.t=new sd);return this.t});T.prototype.__defineGetter__("children",s("d"));T.prototype.o=function(){var a=new td;a.Z=this;this.dispatchEvent(a)};
function ud(a,b){(!y(a)||!y(b)||!(a instanceof T)||!(b instanceof T))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.V?-1:1==b.V?1:y(a.z)&&y(b.z)&&a.z>b.z?-1:1}E("X.object",T);E("X.object.prototype.modified",T.prototype.o);function vd(){}function wd(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),l=a.h.get(d+1),k=a.h.get(d+2),j=a.Jb;a.U&&0<a.U.length&&(j=a.U.get(d));var o=[];o.push(new Gc(e,h));o.push(new Gc(f,l));o.push(new Gc(g,k));c.push(new Ic(o,j))}return Lc(c)}
function xd(a,b){(!y(b)||!(b instanceof Kc))&&i(Error("Invalid CSG object."));var c=new Mc,d=[];wb(b.B,function(a){for(var b=[],g=a.ee,b=wb(a.jb,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Vg=wb(c.unique(),function(a){return[a.wa.x(),a.wa.y(),a.wa.b()]});a.Ug=wb(c.unique(),function(a){return[a.$.x(),a.$.y(),a.$.b()]});a.Tg=wb(c.unique(),function(a){return!a.color?q:[a.color[0],a.color[1],a.color[2]]});a.g=new R(9*d.length);a.h=new R(9*d.length);
a.U=new R(9*d.length);wb(d,function(a){var b=a[0],c=a[1],a=a[2],d=this.Vg,l=this.Ug,k=this.Tg;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(l[b][0],l[b][1],l[b][2]);this.h.add(l[c][0],l[c][1],l[c][2]);this.h.add(l[a][0],l[a][1],l[a][2]);k[b]&&this.U.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.U.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.U.add(k[a][0],k[a][1],k[a][2])}.bind(a));0==a.U.w&&(a.U=q);a.ka=qd}
vd.prototype.rf=function(a){(!y(a)||!(a instanceof Kc)&&!(a instanceof T))&&i(Error("Invalid object."));var b=a;a instanceof T&&(b=wd(b));a=new T;va(a,new vd);xd(a,wd(this).rf(b));return a};vd.prototype.xa=function(a){(!y(a)||!(a instanceof Kc)&&!(a instanceof T))&&i(Error("Invalid object."));var b=a;a instanceof T&&(b=wd(b));a=new T;va(a,new vd);xd(a,wd(this).xa(b));return a};
vd.prototype.Ue=function(a){(!y(a)||!(a instanceof Kc)&&!(a instanceof T))&&i(Error("Invalid object."));var b=a;a instanceof T&&(b=wd(b));a=new T;va(a,new vd);xd(a,wd(this).Ue(b));return a};vd.prototype.inverse=function(){var a=new T;va(a,new vd);xd(a,wd(this).inverse());return a};E("X.constructable",vd);E("X.constructable.prototype.intersect",vd.prototype.Ue);E("X.constructable.prototype.inverse",vd.prototype.inverse);E("X.constructable.prototype.subtract",vd.prototype.xa);
E("X.constructable.prototype.union",vd.prototype.rf);function yd(a){ic.call(this,a);this.c="event"}G(yd,ic);var zd=Bc("pan"),Ad=Bc("rotate"),Bd=Bc("zoom"),Cd=Bc("scroll");Bc("render");var Dd=Bc("resetview"),Ed=Bc("windowlevel"),xc=Bc("modified"),Fd=Bc("progress"),Gd=Bc("hover"),Hd=Bc("hover_end");function Id(){yd.call(this,Ed);this.qe=this.Ce=0}G(Id,yd);function Jd(){yd.call(this,zd);this.z=new Wc(0,0)}G(Jd,yd);function Ld(){yd.call(this,Ad);this.z=new Wc(0,0)}G(Ld,yd);function Md(){yd.call(this,Bd);this.Ua=this.ab=r}G(Md,yd);
function Nd(){yd.call(this,Cd);this.J=r}G(Nd,yd);function Od(){yd.call(this,Gd);this.Hd=this.Gd=0}G(Od,yd);function Pd(){yd.call(this,Hd)}G(Pd,yd);function Qd(){yd.call(this,Dd)}G(Qd,yd);function td(){yd.call(this,xc);this.s=this.Z=q}G(td,yd);function Rd(){yd.call(this,Fd);this.Mf=0}G(Rd,yd);function Y(){M.call(this);this.c="parser";this.aa=q;this.w=0;this.Yg=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.vd=n}G(Y,M);Y.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function Sd(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Z(a,b,c){y(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.aa.slice(a.w,a.w+=c*d));if(a.Yg!=a.vd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Td(a,b,c){H.Ha(a.c+".reslice");var d=b.Y,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],l=b.n!=q,k=h*d,j=Array(g),o=Array(g),v=0,p=q;b.X&&(p=b.X.tb);for(var w=0,u=0,z=0,C=0,x=4*k,w=0;w<g;w++){j[w]=Array(h);o[w]=Array(h);for(var A=f.subarray(w*k,(w+1)*k),F=new Uint8Array(x),u=C=0;u<h;u++){j[w][u]=new c.data.constructor(d);o[w][u]=new c.data.constructor(d);for(z=0;z<d;z++){var v=A[C],N=0,U=0,I=0,J=0;p?(J=p.get(Math.floor(v)),J||(N=p.Oa(),J=N[N.length-1]),N=255*J[1],U=255*J[2],I=255*J[3],J=255*J[4]):
(N=U=I=255*(v/e),J=255);var V=4*C;F[V]=N;F[++V]=U;F[++V]=I;F[++V]=J;j[w][u][z]=255*(v/e);o[w][u][z]=v;C++}}v=new od;v.sa=F;v.Bb=d;v.Ab=h;A=b.eb.d[w];A.A=v;l&&(A.n=b.n.eb.d[w].A)}d!=h?l?b.X?(Ud(g,d,h,o,b.X,b.R,b.n.R,n),Ud(g,h,d,o,b.X,b.Q,b.n.Q,r)):(Vd(g,d,h,j,b.R,b.n.R,n),Vd(g,h,d,j,b.Q,b.n.Q,r)):b.X?(Ud(g,d,h,o,b.X,b.R,q,n),Ud(g,h,d,o,b.X,b.Q,q,r)):(Vd(g,d,h,j,b.R,q,n),Vd(g,h,d,j,b.Q,q,r)):l?b.X?Wd(g,d,h,j,b.X,b.Q,b.n.Q,b.R,b.n.R):Yd(g,d,h,j,b.Q,b.n.Q,b.R,b.n.R):b.X?Wd(g,d,h,o,b.X,b.Q,q,b.R,q):Yd(g,
d,h,j,b.Q,q,b.R,q);H.Ba(a.c+".reslice");return o}function Vd(a,b,c,d,e,f,g){for(var h=4*a*b,l=0,l=0;l<c;l++){for(var k=new Uint8Array(h),j=0,o=0,j=0;j<a;j++)for(var v=0,p=d[j],v=0;v<b;v++){var w,u=w=g?p[l][v]:p[v][l],z=w,C=4*o;k[C]=w;k[++C]=u;k[++C]=z;k[++C]=255;o++}j=new od;j.sa=k;j.Bb=b;j.Ab=a;k=e.d[l];k.A=j;f&&(k.n=f.d[l].A)}}
function Ud(a,b,c,d,e,f,g,h){for(var e=e.tb,l=4*a*b,k=0,k=0;k<c;k++){for(var j=new Uint8Array(l),o=0,v=0,o=0;o<a;o++)for(var p=d[o],w=0,w=0;w<b;w++){var u=e.get(Math.floor(h?p[k][w]:p[w][k]));u||(u=e.Oa(),u=u[u.length-1]);var z=255*u[2],C=255*u[3],x=255*u[4],A=4*v;j[A]=255*u[1];j[++A]=z;j[++A]=C;j[++A]=x;v++}o=new od;o.sa=j;o.Bb=b;o.Ab=a;j=f.d[k];j.A=o;g&&(j.n=g.d[k].A)}}
function Yd(a,b,c,d,e,f,g,h){for(var l=4*a*b,k=0,k=0;k<c;k++){for(var j=new Uint8Array(l),o=new Uint8Array(l),v=0,p=0,p=0;p<a;p++)for(var w=d[p],u=0,u=0;u<b;u++){var z=w[u][k],C=z,x=z,A=4*v;j[A]=z;j[++A]=C;j[++A]=x;j[++A]=255;x=C=z=A=w[k][u];A=4*v;o[A]=z;o[++A]=C;o[++A]=x;o[++A]=255;v++}v=new od;v.sa=j;v.Bb=b;v.Ab=a;j=e.d[k];j.A=v;f&&(j.n=f.d[k].A);j=new od;j.sa=o;j.Bb=b;j.Ab=a;o=g.d[k];o.A=j;h&&(o.n=h.d[k].A)}}
function Wd(a,b,c,d,e,f,g,h,l){for(var e=e.tb,k=4*a*b,j=0,j=0;j<c;j++){for(var o=new Uint8Array(k),v=new Uint8Array(k),p=0,w=0,w=0;w<a;w++)for(var u=d[w],z=0,z=0;z<b;z++){var C=e.get(Math.floor(u[z][j]));if(!C)var x=e.Oa(),C=x[x.length-1];var A=255*C[2],F=255*C[3],N=255*C[4],x=4*p;o[x]=255*C[1];o[++x]=A;o[++x]=F;o[++x]=N;x=e.get(Math.floor(u[j][z]));x||(x=e.Oa(),x=x[x.length-1]);C=255*x[1];A=255*x[2];F=255*x[3];N=255*x[4];x=4*p;v[x]=C;v[++x]=A;v[++x]=F;v[++x]=N;p++}p=new od;p.sa=o;p.Bb=b;p.Ab=a;o=
f.d[j];o.A=p;g&&(o.n=g.d[j].A);o=new od;o.sa=v;o.Bb=b;o.Ab=a;v=h.d[j];v.A=o;l&&(v.n=l.d[j].A)}};function Zd(){Y.call(this);this.c="parserLBL"}G(Zd,Y);
Zd.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");var d=b.oc,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.aa=c;for(var f=[],g=Z(this,"uchar",c.byteLength),h=g.length,l=r,k=0,c=1;c<h;c++)10==g[c-1]?(k=c,l=n):l&&32==g[c]&&(l=parseInt(String.fromCharCode.apply(q,g.subarray(k,c)),10),f.push(l),l=r);g=b.t.u?b.t.u:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)k=d[c],k>e&&i(Error("Could not find scalar for vertex.")),
k=g[k],f[h++]=k,f[h++]=k,f[h++]=k;b.t.u=g;b.t.Dc=f;b.t.e=n;H.Ba(this.c+".parse");d=new td;d.Z=b;d.s=a;this.dispatchEvent(d)};E("X.parserLBL",Zd);E("X.parserLBL.prototype.parse",Zd.prototype.parse);function $d(a){this.q=a;this.lg=L(this.q,Ta?"DOMMouseScroll":"mousewheel",this)}G($d,Cc);
$d.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Da;if("mousewheel"==a.type){c=1;if(K||Ua&&(Ma||jb("532.0")))c=40;d=Ua&&La&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ga(a.wheelDeltaX)?(b=Ua&&La&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ua&&La&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ga(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;D(this.ng)&&Math.min(Math.max(b,-this.ng),this.ng);D(this.og)&&(c=Math.min(Math.max(c,
-this.og),this.og));b=new ae(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Na()}};$d.prototype.O=function(){$d.i.O.call(this);tc(this.lg);delete this.lg};function ae(a,b,c,d){b&&this.ha(b,m);this.type="mousewheel";this.detail=a;this.sc=d}G(ae,kc);K||Ua&&jb("525");var be;function ce(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Cb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=ub(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var de=!K||lb(9);!Ta&&!K||K&&lb(9)||Ta&&jb("1.9.1");K&&jb("9");function ee(a){return a?new fe(ge(a)):be||(be=new fe)}function he(a){return ia(a)?document.getElementById(a):a}function ie(a,b){mb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in je?a.setAttribute(je[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var je={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function ke(a,b,c){return le(document,arguments)}
function le(a,b){var c=b[0],d=b[1];if(!de&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',wa(d.name),'"');if(d.type){c.push(' type="',wa(d.type),'"');var e={};sb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(ia(d)?c.className=d:B(d)?ce.apply(q,[c].concat(d)):ie(c,d));2<b.length&&me(a,c,b);return c}
function me(a,b,c){function d(c){c&&b.appendChild(ia(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ha(f)&&!(ka(f)&&0<f.nodeType)?vb(oe(f)?Bb(f):f,d):d(f)}}function pe(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function qe(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function re(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ge(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function oe(a){if(a&&"number"==typeof a.length){if(ka(a))return"function"==typeof a.item||"string"==typeof a.item;if(ja(a))return"function"==typeof a.item}return r}function fe(a){this.P=a||ca.document||document}t=fe.prototype;
t.Pd=ee;t.j=function(a){return ia(a)?this.P.getElementById(a):a};t.qc=function(a,b,c){return le(this.P,arguments)};t.createElement=function(a){return this.P.createElement(a)};t.createTextNode=function(a){return this.P.createTextNode(a)};function se(a){return"CSS1Compat"==a.P.compatMode}function te(a){var b=a.P,a=!Ua&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Uc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}t.appendChild=function(a,b){a.appendChild(b)};
t.contains=re;function ue(a){(!y(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));M.call(this);this.c="interactor";this.Ia=a;this.se=this.Ef=this.Df=this.Ff=this.Cf=this.Gf=q;this.re=n;this.Cb=this.vb=this.bb=r;this.yd=[0,0];this.me=new Wc(0,0);this.K={MOUSEWHEEL_ENABLED:n,MOUSECLICKS_ENABLED:n,KEYBOARD_ENABLED:n,HOVERING_ENABLED:n,CONTEXTMENU_ENABLED:r,TOUCH_ENABLED:n,TOUCH_BOUNCING_ENABLED:r}}G(ue,M);ue.prototype.__defineGetter__("config",s("K"));
ue.prototype.__defineGetter__("leftButtonDown",s("bb"));ue.prototype.__defineGetter__("middleButtonDown",s("vb"));ue.prototype.__defineGetter__("rightButtonDown",s("Cb"));
ue.prototype.ha=function(){this.K.MOUSEWHEEL_ENABLED?(this.se=new $d(this.Ia),this.Gf=L(this.se,"mousewheel",this.gd.bind(this))):(tc(this.Gf),this.se=q);this.K.MOUSECLICKS_ENABLED?(this.Cf=L(this.Ia,"mousedown",this.Yh.bind(this)),this.Ff=L(this.Ia,"mouseup",this.ci.bind(this))):(tc(this.Cf),tc(this.Ff));this.Ia.oncontextmenu=this.K.CONTEXTMENU_ENABLED?q:function(){return r};window.onkeydown=this.K.KEYBOARD_ENABLED?this.tg.bind(this):q;this.K.TOUCH_ENABLED?(this.K.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},r),this.bh=L(this.Ia,"touchstart",this.ki.bind(this)),this.ah=L(this.Ia,"touchmove",this.hd.bind(this)),this.$g=L(this.Ia,"touchend",this.ji.bind(this))):(tc(this.bh),tc(this.ah),tc(this.$g));tc(this.Df);tc(this.Ef);this.Df=L(this.Ia,"mousemove",this.$h.bind(this));this.Ef=L(this.Ia,"mouseout",this.ai.bind(this))};
ue.prototype.Yh=function(a){0==a.button?this.bb=n:1==a.button?this.vb=n:2==a.button&&(this.Cb=n);eval("this.onMouseDown("+this.bb+","+this.vb+","+this.Cb+")");ve(this);a.preventDefault()};ue.prototype.Xh=aa();ue.prototype.ci=function(a){0==a.button?this.bb=r:1==a.button?this.vb=r:2==a.button&&(this.Cb=r);eval("this.onMouseUp("+this.bb+","+this.vb+","+this.Cb+")");ve(this);a.preventDefault()};ue.prototype.__defineGetter__("mousePosition",s("yd"));t=ue.prototype;t.bi=aa();
t.ai=function(a){this.re=r;this.K.KEYBOARD_ENABLED&&(window.onkeydown=q);this.Cb=this.vb=this.bb=r;ve(this);this.me=new Wc(0,0);a.preventDefault()};t.Zh=aa();t.ki=function(a){a.preventDefault();a.ha(a.Da.targetTouches[0],a.currentTarget);this.sb=new Wc(a.clientX,a.clientY);this.z=0};t.ji=function(a){a.preventDefault()};t.hd=function(a){a.preventDefault();return a.Da.targetTouches};
t.$h=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.re=n;this.K.KEYBOARD_ENABLED&&window.onkeydown==q&&(window.onkeydown=this.tg.bind(this));a.preventDefault();var b=a.shiftKey;this.yd=[a.offsetX,a.offsetY];var c=new Wc(this.yd[0],this.yd[1]),a=this.me.xa(c);this.me=c.f();this.K.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.vb||this.bb||this.Cb)&&ve(this),this.Re=setTimeout(function(){ve(this);var a=new Od;a.Gd=c.x;a.Hd=c.y;this.dispatchEvent(a);
this.Re=q}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.Fb()&&(this.bb&&!b?(b=new Ld,b.z=a,this.dispatchEvent(b)):this.vb||this.bb&&b?(b=new Jd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.z=a,this.dispatchEvent(b)):this.Cb&&(b=new Md,b.ab=0<a.y,b.Ua=r,this.dispatchEvent(b)))};function ve(a){a.Re&&clearTimeout(a.Re);a.dispatchEvent(new Pd)}t.di=aa();t.gd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");ve(this);a.preventDefault()};
t.Vh=aa();
t.tg=function(a){if(this.re){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");ve(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Qd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Jd:b?a=new Md:(a=new Ld,this instanceof we&&(a=new Nd)),a&&(c=new Wc(0,0),37==f?(c.x=5,a.J=r,b&&(a.J=n,a.ab=n,a.Ua=r)):39==f?(c.x=-5,a.J=n,b&&(a.ab=r,a.Ua=r)):38==f?(c.y=5,a.J=n,b&&(a.ab=n,a.Ua=n)):40==f&&(c.y=-5,a.J=r,b&&(a.ab=r,
a.Ua=n)),a.z=c,this.dispatchEvent(a)))}};E("X.interactor",ue);E("X.interactor.prototype.init",ue.prototype.ha);E("X.interactor.prototype.onMouseDown",ue.prototype.Xh);E("X.interactor.prototype.onMouseUp",ue.prototype.bi);E("X.interactor.prototype.onMouseMove",ue.prototype.Zh);E("X.interactor.prototype.onMouseWheel",ue.prototype.di);E("X.interactor.prototype.onKey",ue.prototype.Vh);function we(a){ue.call(this,a);this.c="interactor2D"}G(we,ue);we.prototype.gd=function(a){we.i.gd.call(this,a);var b=new Nd;y(a.sc)||(a.sc=0);b.J=0>a.sc;this.dispatchEvent(b)};
we.prototype.hd=function(a){var b=we.i.hd.call(this,a);if(1==b.length){a=b[0];this.$b=[a.clientX,a.clientY];var b=new Wc(this.$b[0],this.$b[1]),c=this.$b[0]>3*this.Ia.clientWidth/4,d=this.$b[0]<this.Ia.clientWidth/4,a=this.sb.xa(b);this.sb=b.f();if(c||d)c=new Nd,c.J=0>a.y,this.dispatchEvent(c)}else 2==b.length&&(a=b[0],b=b[1],this.Qc=[a.clientX,a.clientY],this.Rc=[b.clientX,b.clientY],c=new Wc(this.Qc[0],this.Qc[1]),a=Xc(c,new Wc(this.Rc[0],this.Rc[1])),b=a-this.le,this.le=a,a=this.sb.xa(c),this.sb=
c.f(),10>b?(c=new Jd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),c.z=a):(c=new Md,c.ab=0<b,c.Ua=r),this.dispatchEvent(c))};function xe(a){T.call(this);this.c="slice";this.l=[0,0,0];this.lc=[0,0,1];this.J=[0,1,0];this.H=this.M=10;this.Zb=[0,1,0,0,1,1,1,1,1,0,0,0];this.n=this.gb=q;this.Ta=n;this.ic=[1,1,1];y(a)&&this.bc(a)}G(xe,T);xe.prototype.bc=function(a){this.l=a.l.slice();this.lc=a.lc.slice();this.J=a.J.slice();this.M=a.M;this.H=a.H;this.gb=a.gb;this.n=a.n;this.Ta=a.Ta;this.ic=a.ic;this.Xg=a.Xg;xe.i.bc.call(this,a)};
xe.prototype.rc=function(){var a=new P(this.lc[0],this.lc[1],this.lc[2]),b=new P(this.J[0],this.J[1],this.J[2]),c=Tc(b,a),d=new P(this.l[0],this.l[1],this.l[2]),e=new P(1,1,1);1==a.x?(e=new P(this.l[0],this.H/2,this.M/2),this.Zb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new P(this.M/2,this.l[1],this.H/2),this.Zb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new P(this.M/2,this.H/2,this.l[2]));var f=Sc(c.f().W(),b.f().W()),f=new P(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Sc(c.f().W(),b),g=new P(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Sc(c,b.f().W()),h=new P(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var l=h,b=Sc(c,b),b=new P(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.g=new R(18);this.h=new R(18);this.g.add(f.x,f.y,f.b);this.g.add(g.x,g.y,g.b);this.g.add(h.x,h.y,h.b);this.g.add(l.x,l.y,l.b);this.g.add(b.x,b.y,b.b);this.g.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.Ta&&(a=new T,a.g=new R(24),a.h=
new R(24),a.g.add(f.x,f.y,f.b),a.g.add(g.x,g.y,g.b),a.g.add(g.x,g.y,g.b),a.g.add(b.x,b.y,b.b),a.g.add(b.x,b.y,b.b),a.g.add(h.x,h.y,h.b),a.g.add(h.x,h.y,h.b),a.g.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.Jb=[this.ic[0],this.ic[1],this.ic[2]],a.ka="LINES",a.nc=2,this.d.push(a))};E("X.slice",xe);function O(a){T.call(this);this.c="volume";this.l=[0,0,0];this.Y=[10,10,10];this.I=[1,1,1];this.mb=[];this.Gc=this.pb=this.Fc=this.ob=this.Ec=this.nb=0;this.Q=new T;this.R=new T;this.eb=new T;this.Fd=this.La=r;this.Db=0;this.n=q;this.Ta=n;this.ea=Infinity;this.da=-Infinity;va(this,new Oc);va(this,new rd);y(a)&&this.bc(a)}G(O,T);
O.prototype.bc=function(a){window.console.log(a);this.l=a.l.slice();this.Y=a.Y.slice();this.I=a.I.slice();this.nb=a.nb;this.Ec=a.Ec;this.ob=a.ob;this.Fc=a.Fc;this.pb=a.pb;this.Gc=a.Gc;this.Q=new T(a.Q);this.R=new T(a.R);this.eb=new T(a.eb);this.La=a.La;this.Fd=a.Fd;this.Db=a.Db;this.n=a.n;this.Ta=a.Ta;O.i.bc.call(this,a)};
O.prototype.rc=function(){this.d.length=0;this.Q.d.length=0;this.R.d.length=0;this.eb.d.length=0;this.d.push(this.Q);this.d.push(this.R);this.d.push(this.eb);for(var a=0,a=0;3>a;a++){for(var b=(this.Y[a]-1)/2,c=b,d=0,d=0;d<this.Y[a];d++){var e=-b*this.I[a]+d*this.I[a],f=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],e=this.d[a].d,g=0,h=0,l=[1,1,1],k=this.Ta;0==a?(g=this.Y[2]*this.I[2]-this.I[2],h=this.Y[1]*this.I[1]-this.I[1],l=[1,1,0]):1==
a?(g=this.Y[0]*this.I[0]-this.I[0],h=this.Y[2]*this.I[2]-this.I[2],l=[1,0,0]):2==a&&(g=this.Y[0]*this.I[0]-this.I[0],h=this.Y[1]*this.I[1]-this.I[1],l=[0,1,0]);y(this.gb)&&(k=r);var j=new xe,o=j,f=f[a],v=[[1,0,0],[0,1,0],[0,0,1]][a],p=[[0,1,0],[0,0,-1],[0,1,0]][a];(!y(f)||!B(f)||3!=f.length)&&i(Error("Invalid center."));(!y(v)||!B(v)||3!=v.length)&&i(Error("Invalid front direction."));(!y(p)||!B(p)||3!=p.length)&&i(Error("Invalid up direction."));D(g)||i(Error("Invalid width."));D(h)||i(Error("Invalid height."));
var w=r;y(k)&&(w=k);k=[1,1,1];y(l)&&(k=l);o.l=f;o.lc=v;o.J=p;o.M=g;o.H=h;o.Ta=w;o.ic=k;o.rc();j.gb=this;j.visible=d==Math.floor(c);e.push(j)}0==a?this.Ec=this.nb=c:1==a?this.Fc=this.ob=c:2==a&&(this.Gc=this.pb=c)}this.e=n};
O.prototype.o=function(a){a="undefined"!==typeof a?a:n;if(0<this.d.length)if(this.La!=this.Fd&&(this.La?(this.d[0].d[parseInt(this.nb,10)].visible=r,this.d[1].d[parseInt(this.ob,10)].visible=r,this.d[2].d[parseInt(this.pb,10)].visible=r):this.d[this.Db].visible=r,this.e=n,this.Fd=this.La),this.La)ye(this,this.Db);else for(var b=0,b=0;3>b;b++){var c=this.d[b],d=0,e=0;0==b?(d=this.nb,e=this.Ec,this.Ec=this.nb):1==b?(d=this.ob,e=this.Fc,this.Fc=this.ob):2==b&&(d=this.pb,e=this.Gc,this.Gc=this.pb);c.d[parseInt(e,
10)].visible=r;c=c.d[parseInt(d,10)];c.visible=n;c.V=1}a&&O.i.o.call(this)};O.prototype.__defineGetter__("dimensions",s("Y"));O.prototype.__defineGetter__("volumeRendering",s("La"));O.prototype.__defineSetter__("volumeRendering",function(a){this.La=a;this.o(r)});O.prototype.__defineSetter__("visible",ba("Ka"));O.prototype.__defineGetter__("center",s("l"));O.prototype.__defineSetter__("center",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid center."));this.l=a});
O.prototype.__defineGetter__("image",s("mb"));O.prototype.__defineGetter__("labelmap",function(){this.n||(this.n=new ze(this));return this.n});O.prototype.__defineGetter__("indexX",s("nb"));O.prototype.__defineSetter__("indexX",function(a){D(a)&&0<=a&&a<this.Q.d.length&&(this.nb=a,this.o(r))});O.prototype.__defineGetter__("indexY",s("ob"));O.prototype.__defineSetter__("indexY",function(a){D(a)&&0<=a&&a<this.R.d.length&&(this.ob=a,this.o(r))});O.prototype.__defineGetter__("indexZ",s("pb"));
O.prototype.__defineSetter__("indexZ",function(a){D(a)&&0<=a&&a<this.eb.d.length&&(this.pb=a,this.o(r))});O.prototype.__defineGetter__("windowLow",s("ea"));O.prototype.__defineSetter__("windowLow",ba("ea"));O.prototype.__defineGetter__("windowHigh",s("da"));O.prototype.__defineSetter__("windowHigh",ba("da"));O.prototype.__defineGetter__("borders",s("Ta"));O.prototype.__defineSetter__("borders",ba("Ta"));
function ye(a,b){if(a.La&&(a.e||b!=a.Db)){var c=a.d[a.Db];c.visible=r;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].Ka=n;a.Db=b;a.e=r}}E("X.volume",O);E("X.volume.prototype.modified",O.prototype.o);function Ae(){Y.call(this);this.c="parserSTL"}G(Ae,Y);
Ae.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");this.aa=c;var d=b.g,e=b.h;if("solid"==String.fromCharCode.apply(q,Z(this,"uchar",5))){b.g=d=new R(c.byteLength);b.h=e=new R(c.byteLength);var f=d,d=e,e=Z(this,"uchar",c.byteLength-5),c=e.length,g=r,h=r,l=0,k;for(k=0;k<c;k++)if(10==e[k]){if(g||h){var j=String.fromCharCode.apply(q,e.subarray(l,k)).split(" "),h=parseFloat(j[0]),o=parseFloat(j[1]),j=parseFloat(j[2]);g?(d.add(h,o,j),d.add(h,o,j),d.add(h,o,j)):f.add(h,o,j);h=g=r}}else 32==e[k-1]&&
(102==e[k]?(l=k+=13,g=n):118==e[k]&&(l=k+=7,h=n))}else{this.w=80;f=Z(this,"uint");b.g=d=new R(9*f);b.h=e=new R(9*f);for(c=c=0;c<f;c++)g=Z(this,"float",12),l=g[0],k=g[1],h=g[2],e.add(l,k,h),e.add(l,k,h),e.add(l,k,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.w+=2}H.Ba(this.c+".parse");f=new td;f.Z=b;f.s=a;this.dispatchEvent(f)};E("X.parserSTL",Ae);E("X.parserSTL.prototype.parse",Ae.prototype.parse);function Be(a){function b(){Dc+=8;return gb<xa.length?xa[gb++]:-1}function c(){var a;Dc++;a=Aa&1;Aa>>=1;0==Aa&&(Aa=b(),a=Aa&1,Aa=Aa>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=U[b]>>8-a);return b}function e(a){x[A++]=a;if(N==w-1){var b=new Uint8Array(2*w);b.set(p);p=b;w*=2}p[N++]=a;32768==A&&(A=0)}function f(){this.Jd=this.Id=0;this.Ve=q}function g(){for(;;){if(pb[Ba]>=id)return-1;if(Ec[pb[Ba]]==Ba)return pb[Ba]++;pb[Ba]++}}function h(){var a=Fc[Ib],b;if(17==Ba)return-1;Ib++;
Ba++;b=g();if(0<=b)a.Id=b;else if(a.Id=32768,h())return-1;b=g();if(0<=b)a.Jd=b,a.Ve=q;else if(a.Jd=32768,a.Ve=Fc[Ib],a.Rj=Ib,h())return-1;Ba--;return 0}function l(a,b,c){Fc=a;Ib=0;Ec=c;id=b;for(a=0;17>a;a++)pb[a]=0;Ba=0;return h()?-1:0}function k(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.Jd&32768))return f.Jd;f=f.Ve;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Id&32768))return f.Id;e++;f=a[e]}}function j(){var a,g,h,j,o;do if(a=c(),h=d(2),0==h){Aa=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=U[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var p;h-=257;o=d(J[h])+I[h];h=U[d(5)]>>3;8<da[h]?(p=d(8),p|=d(da[h]-8)<<8):p=d(da[h]);p+=V[h];for(h=0;h<o;h++)g=x[A-p&32767],e(g)}else if(2==h){var u=Array(320);g=257+d(5);p=1+d(5);j=4+d(4);for(h=0;19>h;h++)u[h]=0;for(h=0;h<j;h++)u[Q[h]]=d(3);o=hb.length;for(j=0;j<o;j++)hb[j]=new f;if(l(hb,19,u)){A=0;return}o=g+p;j=0;for(var v=-1;j<o;)if(v++,
h=k(hb),16>h)u[j++]=h;else if(16==h){var w;h=3+d(2);if(j+h>o){A=0;return}for(w=j?u[j-1]:0;h--;)u[j++]=w}else{h=17==h?3+d(3):11+d(7);if(j+h>o){A=0;return}for(;h--;)u[j++]=0}o=Kb.length;for(j=0;j<o;j++)Kb[j]=new f;if(l(Kb,g,u)){A=0;return}o=Kb.length;for(j=0;j<o;j++)hb[j]=new f;h=[];for(j=g;j<u.length;j++)h[j-g]=u[j];if(l(hb,p,h)){A=0;return}for(;;)if(h=k(Kb),256<=h){h-=256;if(0==h)break;h--;o=d(J[h])+I[h];h=k(hb);8<da[h]?(p=d(8),p|=d(da[h]-8)<<8):p=d(da[h]);for(p+=V[h];o--;)g=x[A-p&32767],e(g)}else e(h)}while(!a);
A=0;Aa=1}function o(){var a=[],c;u&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());F&&v(xa.byteLength);a[0]=b();if(8==a[0]){u=b();b();b();b();b();b();b();if(u&4){a[0]=b();a[2]=b();Ba=a[0]+256*a[1];for(a=0;a<Ba;a++)b()}if(u&8){a=0;for(qb=[];c=b();){if("7"==c||":"==c)a=0;a<jd-1&&(qb[a++]=c)}}if(u&16)for(;b(););u&2&&(b(),b());j();b();b();b();b();b();b();b();b();F&&v(xa.byteLength)}}function v(a){w=a;p=new Uint8Array(a);
a=[];F=r;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(j(),C[z]=Array(2),C[z][0]=p,C[z][1]="geonext.gxt",z++);31==a[0]&&139==a[1]&&(o(),C[z]=Array(2),C[z][0]=p,C[z][1]="file",z++);if(80==a[0]&&75==a[1]&&(F=n,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u=b();u|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(qb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<jd-1&&(qb[e++]=String.fromCharCode(f))}ld||(ld=qb);for(e=0;e<
d;)b(),e++;N=0;8==a&&(j(),C[z]=Array(2),C[z][0]=p,C[z][1]=qb.join(""),z++);o()}}var p=q,w=0,u,z=0,C=[],x=Array(32768),A=0,F=r,N=0,U=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],I=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],J=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],V=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],da=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xa=a,gb=0,Aa=1,Dc=0,jd=256,qb=[],ld,Kb=Array(288),hb=Array(32),
Ib=0,Fc=q,Ba=0,pb=Array(17);pb[0]=0;var Ec,id;Be.prototype.sf=function(){v(xa.byteLength);return p}};function Ce(){Y.call(this);this.c="parserDCM"}G(Ce,Y);Ce.prototype.parse=function(a,b,c){c=this.jd(c,b);if(c.Wd==c.Ya){var d=c.nf.length,e,f=0;for(e=0;e<d;e++){var g=c.nf[e];g!==m&&(g*=c.kb,g=c.Xc.subarray(g,g+c.kb),c.data.set(g,f*c.kb),f++)}b.Y=[c.ta[0],c.ta[1],c.ta[2]];b.I=[c.hb[0],c.hb[1],c.hb[2]];e=Sd(c.data);d=e[0];e=e[1];c.min=b.Ja=b.ea=d;c.max=b.Ca=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.rc();b.mb=Td(this,b,c)}c=new td;c.Z=b;c.s=a;this.dispatchEvent(c)};
Ce.prototype.jd=function(a,b){this.aa=a;if(y(b.hc)){d=b.hc;f=d.hg;h=d.gg;this.w=2*f;var c=Z(this,"uchar",h),c=parseInt(String.fromCharCode.apply(q,c),10);d.ta[2]++}else{var d={rows:0,cols:0,hb:q,Ee:0,gh:0,Ya:1,Th:1,hg:0,gg:0,Wd:0,kb:0,Xc:q,hf:0,nf:[],data:q,min:Infinity,max:-Infinity};d.Ya=b.p.length;y(d.Ya)||(d.Ya=1);for(var e=Z(this,"ushort",this.aa.byteLength),f=66,g=h=q,h=q,c="",l=7;0<l;)if(h=e[f++],40==h)switch(g=e[f++],f++,h=e[f++],g){case 16:d.rows=e[f++];l--;break;case 17:d.cols=e[f++];l--;
break;case 256:d.Ee=e[f++];l--;break;case 257:d.gh=e[f++];l--;break;case 2:d.Th=e[f++];l--;break;case 48:for(var g="",k=0,k=0;k<h/2;k++)var j=e[f++],o=j&255,j=(j&65280)>>8,g=g+String.fromCharCode(o),g=g+String.fromCharCode(j);g=g.split("\\");d.hb=[+g[0],+g[1],1];l--}else if(32==h&&(g=e[f++],19==g)){f++;h=e[f++];d.hg=f;d.gg=h;for(k=0;k<h/2;k++)j=e[f++],o=j&255,j=(j&65280)>>8,c+=String.fromCharCode(o),c+=String.fromCharCode(j),c=parseInt(c,10);l--}b.hc=d;d.ta=[d.cols,d.rows,1];d.kb=d.rows*d.cols;switch(d.Ee){case 8:d.Xc=
new Uint8Array(d.cols*d.rows*d.Ya);d.data=new Uint8Array(d.cols*d.rows*d.Ya);break;case 16:d.Xc=new Uint16Array(d.cols*d.rows*d.Ya);d.data=new Uint16Array(d.cols*d.rows*d.Ya);break;case 32:d.Xc=new Uint32Array(d.cols*d.rows*d.Ya),d.data=new Uint32Array(d.cols*d.rows*d.Ya)}}this.w=this.aa.byteLength-2*d.kb;e=q;switch(d.Ee){case 8:e=Z(this,"uchar",d.kb);break;case 16:e=Z(this,"ushort",d.kb);break;case 32:e=Z(this,"uint",d.kb)}d.nf[c]=d.hf;d.Xc.set(e,d.hf*d.kb);d.hf++;++d.Wd;return d};
E("X.parserDCM",Ce);E("X.parserDCM.prototype.parse",Ce.prototype.parse);function De(){Y.call(this);this.c="parserVTK"}G(De,Y);
De.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new R(c.byteLength);b.h=e=new R(c.byteLength);for(var c=0,h=f.length;c<h;c+=32768)g+=String.fromCharCode.apply(q,f.subarray(c,Math.min(c+32768,h)));f=g.split("\n");g=f.length;this.Tc=this.Uc=q;this.Mb=[];this.qa=qd;this.ue=this.yb=this.lb=this.zb=r;c=0;for(h=g%8;h--;)Ee(this,f[c]),c++;for(h=0.125*g^0;h--;)Ee(this,f[c]),c++,Ee(this,f[c]),c++,Ee(this,f[c]),c++,Ee(this,f[c]),c++,Ee(this,f[c]),c++,
Ee(this,f[c]),c++,Ee(this,f[c]),c++,Ee(this,f[c]),c++;var c=this.Uc,f=this.Tc,g=f.length,l=h=this.Mb.length;do{var k=this.Mb[h-l],j=k.length,o;for(o=0;o<j&&!("LINES"==this.qa&&o+1>=j);o++){var v=parseInt(k[o],10),p=c.get(v);d.add(p[0],p[1],p[2]);var w=v,u=p;"LINES"==this.qa?(w=parseInt(k[o+1],10),u=c.get(w),d.add(u[0],u[1],u[2])):"TRIANGLE_STRIPS"==this.qa&&(0==o||o==j-1)&&d.add(p[0],p[1],p[2]);v<g?(u=f.get(v),e.add(u[0],u[1],u[2]),"LINES"==this.qa?(w=f.get(w),e.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==
this.qa&&(0==o||o==j-1)&&e.add(u[0],u[1],u[2])):(w=new P(p[0],p[1],p[2]),w.normalize(),e.add(w.x,w.y,w.b),"LINES"==this.qa?(w=new P(u[0],u[1],u[2]),w.normalize(),e.add(w.x,w.y,w.b)):"TRIANGLE_STRIPS"==this.qa&&(0==o||o==j-1)&&e.add(w.x,w.y,w.b))}l--}while(0<l);b.ka=this.qa;H.Ba(this.c+".parse");d=new td;d.Z=b;d.s=a;this.dispatchEvent(d)};
function Ee(a,b){var b=b.replace(/^\s+|\s+$/g,""),c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.zb=n;a.lb=r;a.yb=r;c=parseInt(c[1],10);a.Uc=new R(3*c);a.Tc=new R(3*c);return;case "VERTICES":a.lb=n;a.zb=r;a.yb=r;c=parseInt(c[1],10);3<=c?a.qa=qd:1==c?a.qa="POINTS":i(Error("This VTK file is not supported!"));a.Mb=[];return;case "TRIANGLE_STRIPS":a.lb=n;a.zb=r;a.yb=r;a.qa="TRIANGLE_STRIPS";a.Mb=[];return;case "LINES":a.lb=n;a.zb=r;a.yb=r;a.qa="LINES";a.Mb=[];return;case "POLYGONS":a.lb=n;
a.zb=r;a.yb=r;a.qa="POLYGONS";a.Mb=[];return;case "POINT_DATA":a.yb=n;a.zb=r;a.lb=r;return}if(a.zb)if(1==d||isNaN(parseFloat(e)))a.zb=r;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Uc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Uc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Uc.add(d,e,c))}else a.lb?1==d||isNaN(parseFloat(e))?a.lb=r:a.Mb.push(c.slice(1)):a.yb&&("NORMALS"==e?a.ue=n:1==d||isNaN(parseFloat(e))?
(a.yb=r,a.ue=r):a.ue&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Tc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Tc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Tc.add(d,e,c))))}E("X.parserVTK",De);E("X.parserVTK.prototype.parse",De.prototype.parse);function Fe(){Y.call(this);this.c="parserFSM";this.vd=r}G(Fe,Y);
Fe.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");this.aa=c;var d=b.g,e=b.h;b.oc=[];var f=b.oc,c=0,g;do g=Z(this,"uchar"),c++;while(200>c&&10!=g);Z(this,"uchar");var e=Z(this,"uint"),c=Z(this,"uint"),h=Z(this,"float",3*e);g=Z(this,"uint",3*c);var l=new Uint32Array(e),k=new Float32Array(9*c);b.g=d=new R(9*c);b.h=e=new R(9*c);var j;for(j=0;j<c;j++){var o=3*j,v=g[o],p=g[o+1],w=g[o+2];f.push(v);f.push(p);f.push(w);l[v]+=1;l[p]+=1;l[w]+=1;var o=3*v,u=3*p,z=3*w,C=h[o],x=h[o+1],A=h[o+2],p=h[u],w=
h[u+1],v=h[u+2],F=h[z],N=h[z+1],U=h[z+2];d.add(C,x,A);d.add(p,w,v);d.add(F,N,U);C=new P(C,x,A);F=new P(F,N,U);p=(new P(p,w,v)).f().xa(C);w=F.f().xa(C);p=Tc(p,w).normalize();k[o]+=p.x;k[o+1]+=p.y;k[o+2]+=p.b;k[u]+=p.x;k[u+1]+=p.y;k[u+2]+=p.b;k[z]+=p.x;k[z+1]+=p.y;k[z+2]+=p.b}for(j=0;j<c;j++)o=3*j,v=g[o],p=g[o+1],w=g[o+2],o=3*v,u=3*p,z=3*w,f=new P(k[u],k[u+1],k[u+2]),h=new P(k[z],k[z+1],k[z+2]),o=(new P(k[o],k[o+1],k[o+2])).scale(1/l[v]).normalize(),f=f.scale(1/l[p]).normalize(),h=h.scale(1/l[w]).normalize(),
e.add(o.x,o.y,o.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.ka=qd;H.Ba(this.c+".parse");c=new td;c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserFSM",Fe);E("X.parserFSM.prototype.parse",Fe.prototype.parse);function Ge(){Y.call(this);this.c="parserMGZ";this.vd=r}G(Ge,Y);Ge.prototype.parse=function(a,b,c,d){H.Ha(this.c+".parse");var e=c;d&&(e=(new Be(new Uint8Array(c))).sf(),e=e.buffer);c=this.jd(e);b.Y=[c.Ye,c.Ze,c.$e];b.I=c.Lg;d=c.min;e=c.max;b.Ja=b.ea=d;b.Ca=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.rc();H.Ba(this.c+".parse");b.mb=Td(this,b,c);c=new td;c.Z=b;c.s=a;this.dispatchEvent(c)};
Ge.prototype.jd=function(a){this.aa=a;a={version:0,Sg:0,Qg:0,xh:0,Rg:0,Ye:0,Ze:0,$e:0,Sh:0,type:0,qh:0,Cg:0,gj:q,Pg:q,Lg:q,data:q,min:Infinity,max:-Infinity};a.version=Z(this,"uint");a.Ye=Z(this,"uint");a.Ze=Z(this,"uint");a.$e=Z(this,"uint");a.Sh=Z(this,"uint");a.type=Z(this,"uint");a.qh=Z(this,"uint");a.Cg=Z(this,"ushort");if(0<a.Cg){a.Lg=Z(this,"float",3);var b=[];b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));a.Pg=b}this.w=284;b=a.Ye*a.Ze*
a.$e;switch(a.type){case 0:a.data=Z(this,"uchar",b);break;case 1:a.data=Z(this,"uint",b);break;case 3:a.data=Z(this,"float",b);break;case 4:a.data=Z(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Sd(a.data);a.min=b[0];a.max=b[1];this.w+16<this.aa.byteLength&&(a.Sg=Z(this,"float"),a.xh=Z(this,"float"),a.Qg=Z(this,"float"),a.Rg=Z(this,"float"));return a};E("X.parserMGZ",Ge);E("X.parserMGZ.prototype.parse",Ge.prototype.parse);function He(){Y.call(this);this.c="parserCRV";this.vd=r}G(He,Y);
He.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");var d=b.oc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.aa=c;this.w=3;var e=Z(this,"uint");Z(this,"uint");Z(this,"uint");var f=0,g=0,h=0,l=0,k=0,j=0,o=0,v=0,p=0,w=0,u=0,c=Array(2),z=Array(2),C=Z(this,"float",e),x;for(x=0;x<e;x++){var A=C[x];0==x&&(c[0]=z[0]=A);0<=A?(f++,l+=A):(g++,h+=A);p+=A;u++;z[0]=Math.max(A,z[0]);c[0]=Math.min(A,c[0]);C[x]=A}0!=f&&(k=l/f);0!=g&&(j=h/g);0!=u&&(w=p/u);for(u=p=h=l=0;u<e;u++)A=C[u],
x=0,0<=A?(x=Math.pow(A-k,2),l+=x):(x=Math.pow(A-j,2),h+=x),x=Math.pow(A-w,2),p+=x;1<f&&(o=Math.sqrt(l/(f-1)));1<g&&(v=Math.sqrt(h/(g-1)));c[1]=j-2.5*v;z[1]=k+2.5*o;e=d.length;f=new Float32Array(3*e);for(u=0;u<e;u++)g=C[d[u]],h=3*u,f[h]=g,f[h+1]=g,f[h+2]=g;b.t.Ja=c[1];b.t.Ca=z[1];-Infinity==b.t.ba&&(b.t.ba=c[1]);Infinity==b.t.ca&&(b.t.ca=z[1]);b.t.u=C;b.t.Dc=f;b.t.e=n;H.Ba(this.c+".parse");d=new td;d.Z=b;d.s=a;this.dispatchEvent(d)};E("X.parserCRV",He);E("X.parserCRV.prototype.parse",He.prototype.parse);function Ie(){Y.call(this);this.c="parserTRK"}G(Ie,Y);
Ie.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");var d=b.g,e=b.h,f=b.U;this.aa=c;Z(this,"uchar",6);Z(this,"ushort",3);var g=Z(this,"float",3);Z(this,"float",3);var h=Z(this,"ushort");Z(this,"uchar",200);Z(this,"ushort");Z(this,"uchar",200);Z(this,"float",16);Z(this,"uchar",444);Z(this,"uchar",4);Z(this,"uchar",4);Z(this,"float",6);Z(this,"uchar",2);Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");var l=Z(this,"uint");Z(this,"uint");var k=Z(this,
"uint"),j=[],o=[],c=Infinity,v=-Infinity,p=q,w=q,u=q,z=q,e=d=q,C=Z(this,"uint",(this.aa.byteLength-1E3)/4);this.w=k;for(var x=Z(this,"float",(this.aa.byteLength-1E3)/4),A=0,k=f=0;k<l;k++){for(var F=C[A],N=new R(3*F),U=0,I=0;I<F;I++){var J=x[A+3*I+I*h+1],V=x[A+3*I+I*h+2],da=x[A+3*I+I*h+3],J=J/g[0],V=V/g[1],da=da/g[2];N.add(J,V,da);if(0<I)var Q=N.get(I-1),U=U+Math.sqrt(Math.pow(J-Q[0],2)+Math.pow(V-Q[1],2)+Math.pow(da-Q[2],2));I<F-1&&(f+=6)}A+=3*F+F*h+1;I=N.Sb;F=N.Pb;J=N.Tb;V=N.Qb;da=N.Ub;Q=N.Rb;if(!p||
I<p)p=I;if(!w||F>w)w=F;if(!u||J<u)u=J;if(!z||V>z)z=V;if(!d||da<d)d=da;if(!e||Q>e)e=Q;j.push(N);o.push(U)}g=(p+w)/2;u=(u+z)/2;h=(d+e)/2;z=new Float32Array(f);b.g=d=new R(f);b.h=e=new R(f);b.U=f=new R(f);for(k=p=0;k<l;k++){w=j[k];C=w.count;U=o[k];c=Math.min(c,U);v=Math.max(v,U);for(I=0;I<C-1;I++){A=w.get(I);x=w.get(I+1);d.add(A[0],A[1],A[2]);d.add(x[0],x[1],x[2]);var N=A[0]-g,F=A[1]-u,J=A[2]-h,V=Math.sqrt(N*N+F*F+J*J),da=x[0]-g,Q=x[1]-u,xa=x[2]-h,gb=Math.sqrt(da*da+Q*Q+xa*xa);e.add(N/V,F/V,J/V);e.add(da/
gb,Q/gb,xa/gb);x=[Math.abs(x[0]-A[0]),Math.abs(x[1]-A[1]),Math.abs(x[2]-A[2])];A=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]);x[0]/=A;x[1]/=A;x[2]/=A;f.add(x[0],x[1],x[2]);f.add(x[0],x[1],x[2]);z[p++]=U;z[p++]=U;z[p++]=U;z[p++]=U;z[p++]=U;z[p++]=U}}b.ka="LINES";l=new sd;l.Ja=c;l.Ca=v;l.ba=c;l.ca=v;l.Dc=z;l.Lf=r;l.e=n;b.t=l;H.Ba(this.c+".parse");c=new td;c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserTRK",Ie);E("X.parserTRK.prototype.parse",Ie.prototype.parse);function Je(){Y.call(this);this.c="parserIMAGE"}G(Je,Y);Je.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;rc(f,"load",this.oi.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Je.prototype.oi=function(a,b,c){b.mb=a;b.sa=q;a=new td;a.Z=c;a.s=b;this.dispatchEvent(a)};E("X.parserIMAGE",Je);E("X.parserIMAGE.prototype.parse",Je.prototype.parse);function Ke(){Y.call(this);this.c="parserLUT"}G(Ke,Y);
Ke.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");this.aa=c;var c=Z(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=String.fromCharCode.apply(q,c.subarray(e,f)),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}H.Ba(this.c+".parse");c=new td;
c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserLUT",Ke);E("X.parserLUT.prototype.parse",Ke.prototype.parse);function Le(){Y.call(this);this.c="parserNRRD"}G(Le,Y);
Le.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");this.aa=c;var c=Z(this,"uchar",c.byteLength),d=c.length,e=q,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=String.fromCharCode.apply(q,c.subarray(0,g-2));f=g+1;break}var h,l,k,j,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Oh=n;else if(!h.match(/^#/)&&(j=h.match(/(.*):(.*)/)))l=j[1].trim(),h=j[2].trim(),(k=this.th[l])?k.call(this,h):this[l]=h;this.Oh||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==
this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Ga&&(this.Ga=[new P(1,0,0),new P(0,1,0),new P(0,0,1)],this.of)){d=[];for(j=0;2>=j;j++)d.push(!isNaN(this.of[j])?this.Ga[j].scale(this.of[j]):m)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new Be(f)).sf();f=f.buffer;c={data:q,min:Infinity,max:-Infinity};c.data=new this.Ib(f);j=Sd(c.data);f=c.min=j[0];j=c.max=j[1];b.Y=[this.lf[0],this.lf[1],this.lf[2]];b.I=[(new P(this.Ga[0][0],this.Ga[0][1],
this.Ga[0][2])).Fb(),(new P(this.Ga[1][0],this.Ga[1][1],this.Ga[1][2])).Fb(),(new P(this.Ga[2][0],this.Ga[2][1],this.Ga[2][2])).Fb()];b.Ja=b.ea=f;b.Ca=b.da=j;-Infinity==b.ba&&(b.ba=f);Infinity==b.ca&&(b.ca=j);b.rc();H.Ba(this.c+".parse");b.mb=Td(this,b,c);c=new td;c.Z=b;c.s=a;this.dispatchEvent(c)};
Le.prototype.th={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Ib=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Ib=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Ib=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Ib=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Ib=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Ib=Uint32Array;break;case "float":this.Ib=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.ta=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.lf=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.Ga=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.of=e}};E("X.parserNRRD",Le);E("X.parserNRRD.prototype.parse",Le.prototype.parse);function Me(){Y.call(this);this.c="parserNII"}G(Me,Y);Me.prototype.parse=function(a,b,c){H.Ha(this.c+".parse");var d=c;348!=(new DataView(c,0)).getInt32(0,n)&&(d=(new Be(new Uint8Array(c))).sf(),d=d.buffer);c=this.jd(d);b.Y=[c.ta[1],c.ta[2],c.ta[3]];b.I=[c.hb[1],c.hb[2],c.hb[3]];var d=c.min,e=c.max;b.Ja=b.ea=d;b.Ca=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.rc();H.Ba(this.c+".parse");b.mb=Td(this,b,c);c=new td;c.Z=b;c.s=a;this.dispatchEvent(c)};
Me.prototype.jd=function(a){this.aa=a;a={Li:0,kh:q,lh:q,sh:0,Fi:0,xi:0,oh:q,ta:q,Jh:0,Kh:0,Lh:0,Hh:0,Me:0,fh:0,Pi:0,hb:q,Mg:0,Ei:0,Di:0,Oi:0,Mi:q,cj:q,hh:0,ih:0,Ni:0,Wi:0,zh:0,Ah:0,nh:q,eh:q,qi:0,Ji:0,ui:0,vi:0,wi:0,ri:0,si:0,ti:0,Qi:q,Ri:q,Si:q,Ih:q,Ph:q,data:q,min:Infinity,max:-Infinity};a.Li=Z(this,"uint");a.kh=Z(this,"uchar",10);a.lh=Z(this,"uchar",18);a.sh=Z(this,"uint");a.Fi=Z(this,"ushort");a.xi=Z(this,"uchar");a.oh=Z(this,"uchar");a.ta=Z(this,"ushort",8);a.Jh=Z(this,"float");a.Kh=Z(this,"float");
a.Lh=Z(this,"float");a.Hh=Z(this,"ushort");a.Me=Z(this,"ushort");a.fh=Z(this,"ushort");a.Pi=Z(this,"ushort");a.hb=Z(this,"float",8);a.Mg=Z(this,"float");a.Ei=Z(this,"float");a.Di=Z(this,"float");a.Oi=Z(this,"ushort");a.Mi=Z(this,"uchar");a.cj=Z(this,"uchar");a.hh=Z(this,"float");a.ih=Z(this,"float");a.Ni=Z(this,"float");a.Wi=Z(this,"float");a.zh=Z(this,"uint",1);a.Ah=Z(this,"uint",1);a.nh=Z(this,"uchar",80);a.eh=Z(this,"uchar",24);a.qi=Z(this,"ushort");a.Ji=Z(this,"ushort");a.ui=Z(this,"float");a.vi=
Z(this,"float");a.wi=Z(this,"float");a.ri=Z(this,"float");a.si=Z(this,"float");a.ti=Z(this,"float");a.Qi=Z(this,"float",4);a.Ri=Z(this,"float",4);a.Si=Z(this,"float",4);a.Ih=Z(this,"uchar",16);a.Ph=Z(this,"uchar",4);this.w=parseInt(a.Mg,10);var b=a.ta[1]*a.ta[2]*a.ta[3];switch(a.Me){case 2:a.data=Z(this,"uchar",b);break;case 4:a.data=Z(this,"sshort",b);break;case 8:a.data=Z(this,"sint",b);break;case 16:a.data=Z(this,"float",b);break;case 256:a.data=Z(this,"schar",b);break;case 512:a.data=Z(this,"ushort",
b);break;case 768:a.data=Z(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.Me))}b=Sd(a.data);a.min=b[0];a.max=b[1];return a};E("X.parserNII",Me);E("X.parserNII.prototype.parse",Me.prototype.parse);function Ne(){M.call(this);this.c="loader";this.mc=new Nb;this.Pc=0}G(Ne,M);function Oe(a,b){a.Pc+=b/a.mc.Xa()/3;a.Pc=Math.min(1,a.Pc);var c=new Rd;c.Mf=a.Pc;a.dispatchEvent(c)}function Pe(a){var a=a.p.zd,b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Qe||i(Error("The "+b+" file format is not supported."));return[a,b,Qe[b][0],Qe[b][1],Qe[b][2]]}
Ne.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Pb(this.mc.F,a.pa)||this.mc.get(a.pa)){this.mc.set(a.pa,r);var c=Pe(a)[0];if(a.Lb!=q)this.parse(q,a,b);else{var d=new XMLHttpRequest;L(d,"abort",this.Yf.bind(this,d,a,b));L(d,"error",this.Yf.bind(this,d,a,b));L(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,n);d.responseType="arraybuffer";d.send(q)}}};
Ne.prototype.parse=function(a,b,c){Oe(this,1);setTimeout(function(){var d=Pe(b),e=d[3],d=new d[2];rc(d,xc,this.complete.bind(this));var f=b.Lb;f==q&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Ne.prototype.complete=function(a){Oe(this,1);setTimeout(function(){var b=a.s,c=a.Z;b.p.e=r;b.e=n;c.o();this.mc.set(b.pa,n)}.bind(this),100)};Ne.prototype.Yf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var Qe={STL:[Ae,q],VTK:[De,q],TRK:[Ie,q],FSM:[Fe,q],INFLATED:[Fe,q],SMOOTHWM:[Fe,q],SPHERE:[Fe,q],PIAL:[Fe,q],ORIG:[Fe,q],NRRD:[Le,q],NII:[Me,q],GZ:[Me,q],DCM:[Ce,q],DICOM:[Ce,q],"":[Ce,q],CRV:[He,q],LABEL:[Zd,q],MGH:[Ge,r],MGZ:[Ge,n],TXT:[Ke,q],LUT:[Ke,q],PNG:[Je,"png"],JPG:[Je,"jpeg"],JPEG:[Je,"jpeg"],GIF:[Je,"gif"]};function Re(a,b){(!D(a)||!D(b))&&i(Error("A camera needs valid width and height values."));M.call(this);this.c="camera";this.ra=new P(0,0,100);this.kc=new P(0,0,0);this.J=new P(0,1,0);this.m=this.Yd(this.ra,this.kc);this.Nb=new Float32Array(this.m.Ea())}G(Re,M);Re.prototype.hi=function(a){a instanceof Ld||i(Error("Received no valid rotate event."));this.rotate(a.z)};Re.prototype.ni=function(a){a instanceof Md||i(Error("Received no valid zoom event."));a.ab?this.Ng(a.Ua):this.Og(a.Ua)};
Re.prototype.ei=function(a){a instanceof Jd||i(Error("Received no valid pan event."));this.yg(a.z)};Re.prototype.__defineGetter__("view",s("m"));Re.prototype.__defineSetter__("view",function(a){(!y(a)||!(a instanceof gd))&&i(Error("Invalid view matrix."));this.m=a;this.Nb=new Float32Array(this.m.Ea())});Re.prototype.__defineGetter__("position",function(){return[this.ra.x,this.ra.y,this.ra.b]});
Re.prototype.__defineSetter__("position",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid position."));this.ra=new P(a[0],a[1],a[2]);this.reset()});Re.prototype.__defineGetter__("focus",function(){return[this.kc.x,this.kc.y,this.kc.b]});Re.prototype.__defineSetter__("focus",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid focus"));this.kc=new P(a[0],a[1],a[2]);this.reset()});Re.prototype.__defineGetter__("up",function(){return[this.J.x,this.J.y,this.J.b]});
Re.prototype.__defineSetter__("up",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid up vector."));this.J=new P(a[0],a[1],a[2]);this.reset()});t=Re.prototype;t.reset=function(){this.m=this.Yd(this.ra,this.kc);this.Nb=new Float32Array(this.m.Ea())};t.rotate=function(a){B(a)&&2==a.length?a=new Wc(a[0],a[1]):a instanceof Wc||i(Error("Invalid distance vector for rotate operation."));return a};
t.yg=function(a){B(a)&&2==a.length?a=new Wc(a[0],a[1]):a instanceof Wc||i(Error("Invalid distance vector for pan operation."));a=new P(-a.x,a.y,0);a=hd(4).translate(a);this.m=new gd(a.multiply(this.m));this.Nb=new Float32Array(this.m.Ea())};t.Ng=function(a){var b=20;y(a)&&!a&&(b=1);a=new P(0,0,b);a=hd(4).translate(a);this.m=new gd(a.multiply(this.m));this.Nb=new Float32Array(this.m.Ea())};
t.Og=function(a){var b=30;y(a)&&!a&&(b=1);a=new P(0,0,-b);a=hd(4).translate(a);this.m=new gd(a.multiply(this.m));this.Nb=new Float32Array(this.m.Ea())};t.Yd=function(a,b){(!(a instanceof P)||!(b instanceof P))&&i(Error("3D vectors required for calculating the view."));return hd(4)};E("X.camera",Re);E("X.camera.prototype.pan",Re.prototype.yg);E("X.camera.prototype.rotate",Re.prototype.rotate);E("X.camera.prototype.zoomIn",Re.prototype.Ng);E("X.camera.prototype.zoomOut",Re.prototype.Og);function Se(a){function b(a,b,d){b=2*b*Math.PI;b=l.Hb(Math.cos(b)).wc(k.Hb(Math.sin(b)));a=c.wc(e.Hb(a)).wc(b.Hb(f));d=b.Hb(1-Math.abs(d)).wc(g.Hb(d));return new Gc(a,d)}this.B=[];for(var a=a||{},c=new ua(a.start||[0,-1,0]),d=new ua(a.end||[0,1,0]),e=d.fd(c),f=a.Za||1,a=a.mf||16,g=e.od(),h=0.5<Math.abs(g.y()),l=(new ua(h,!h,0)).Ke(g).od(),k=l.Ke(g).od(),h=new Gc(c,g.af()),d=new Gc(d,g.od()),j=[],o=0;o<a;o++){var v=o/a,p=(o+1)/a;j.push(new Ic([h,b(0,v,-1),b(0,p,-1)]));j.push(new Ic([b(0,p,0),b(0,v,
0),b(1,v,0),b(1,p,0)]));j.push(new Ic([d,b(1,p,1),b(1,v,1)]))}return Lc(j)}G(Se,Kc);function Te(){T.call(this);this.c="cylinder";this.Ae=[-10,-10,-10];this.he=[10,10,10];this.Vb=10;this.Yb=32;va(this,new vd)}G(Te,T);Te.prototype.__defineGetter__("start",s("Ae"));Te.prototype.__defineSetter__("start",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid start"));this.Ae=a});Te.prototype.__defineGetter__("end",s("he"));Te.prototype.__defineSetter__("end",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid end"));this.he=a});Te.prototype.__defineGetter__("radius",s("Vb"));
Te.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Vb=a});Te.prototype.o=function(){xd(this,new Se({start:this.Ae,end:this.he,Za:this.Vb,mf:this.Yb}));Te.i.o.call(this)};E("X.cylinder",Te);E("X.cylinder.prototype.modified",Te.prototype.o);function Ue(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new ua(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Gc(c.wc(e.Hb(d)),e))}this.B=[];for(var a=a||{},c=new ua(a.Ge||[0,0,0]),d=a.Za||1,e=a.mf||16,a=a.Ti||8,f=[],g=[],h=0;h<e;h++)for(var l=0;l<a;l++)g=[],b(h/e,l/a),0<l&&b((h+1)/e,l/a),l<a-1&&b((h+1)/e,(l+1)/a),b(h/e,(l+1)/a),f.push(new Ic(g));return Lc(f)}G(Ue,Kc);function Ve(){T.call(this);this.c="sphere";this.l=[0,0,0];this.Vb=5;this.Yb=32;this.Zg=16;va(this,new vd)}G(Ve,T);Ve.prototype.__defineGetter__("center",s("l"));Ve.prototype.__defineSetter__("center",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Ve.prototype.__defineGetter__("radius",s("Vb"));Ve.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Vb=a});
Ve.prototype.o=function(){xd(this,new Ue({Ge:this.l,Za:this.Vb,mf:this.Yb,Ti:this.Zg}));Ve.i.o.call(this)};E("X.sphere",Ve);E("X.sphere.prototype.modified",Ve.prototype.o);function ze(a){O.call(this);this.c="labelmap";this.gb=a}G(ze,O);ze.prototype.o=function(){var a=new td;a.Z=this;this.dispatchEvent(a);this.gb.o()};E("X.labelmap",ze);function We(a){this.B=[];var a=a||{},b=new ua(a.Ge||[0,0,0]),c=!a.Za?[1,1,1]:a.Za.length?a.Za:[a.Za,a.Za,a.Za];return Lc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Ic(a[0].map(function(e){e=new ua(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Gc(e,new ua(a[1]))}))}))}G(We,Kc);function Xe(){T.call(this);this.c="cube";this.l=[0,0,0];this.pe=this.oe=this.ne=20;this.Zb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];va(this,new vd)}G(Xe,T);Xe.prototype.__defineGetter__("center",s("l"));Xe.prototype.__defineSetter__("center",function(a){(!y(a)||!B(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Xe.prototype.__defineGetter__("lengthX",s("ne"));
Xe.prototype.__defineSetter__("lengthX",function(a){D(a)||i(Error("Invalid lengthX."));this.ne=a});Xe.prototype.__defineGetter__("lengthY",s("oe"));Xe.prototype.__defineSetter__("lengthY",function(a){D(a)||i(Error("Invalid lengthY."));this.oe=a});Xe.prototype.__defineGetter__("lengthZ",s("pe"));Xe.prototype.__defineSetter__("lengthZ",function(a){D(a)||i(Error("Invalid lengthZ."));this.pe=a});Xe.prototype.o=function(){xd(this,new We({Ge:this.l,Za:[this.ne/2,this.oe/2,this.pe/2]}));Xe.i.o.call(this)};
E("X.cube",Xe);E("X.cube.prototype.modified",Xe.prototype.o);function Ye(a){ue.call(this,a);this.c="interactor3D"}G(Ye,ue);Ye.prototype.gd=function(a){Ye.i.gd.call(this,a);var b=new Md;y(a.sc)||(a.sc=0);b.ab=0>a.sc;b.Ua=n;this.dispatchEvent(b)};
Ye.prototype.hd=function(a){var b=Ye.i.hd.call(this,a);if(1==b.length){a=b[0];this.$b=[a.clientX,a.clientY];var a=new Wc(this.$b[0],this.$b[1]),c=this.sb.xa(a);5>Math.abs(c.x)&&(c.x=0);5>Math.abs(c.y)&&(c.y=0);c.scale(3);this.sb=a.f();b=new Ld;b.z=c;this.dispatchEvent(b);var d=setInterval(function(){if(1>c.Fb())clearInterval(d);else{c.scale(0.7);var a=new Ld;a.z=c;this.dispatchEvent(a)}}.bind(this),100)}else 2==b.length&&(a=b[0],b=b[1],this.Qc=[a.clientX,a.clientY],this.Rc=[b.clientX,b.clientY],b=
new Wc(this.Qc[0],this.Qc[1]),c=Xc(b,new Wc(this.Rc[0],this.Rc[1])),a=c-this.le,this.le=c,c=this.sb.xa(b),this.sb=b.f(),10>a?(b=new Jd,5<c.x?c.x=5:-5>c.x&&(c.x=-5),5<c.y?c.y=5:-5>c.y&&(c.y=-5),b.z=c):(b=new Md,b.ab=0<a,b.Ua=n),this.dispatchEvent(b))};function Ze(a){M.call(this);this.c="array";this.u=[];this.xf=a}G(Ze,M);Ze.prototype.add=function(a){this.u.push(a);return n};Ze.prototype.clear=function(){this.u.length=0};function $e(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);$e(a,b,d);for($e(a,d,c);b<d;++b)if(0<a.xf(a.u[b],a.u[d])){var e=a.u[b];a.u[b]=a.u[d];for(var f=a,g=d,h=c;g+1<h&&0>f.xf(f.u[g+1],e);){var l=f,k=g+1,j=l.u[g];l.u[g]=l.u[k];l.u[k]=j;++g}f.u[g]=e}}}Ze.prototype.sort=function(){$e(this,0,this.u.length)};function af(a,b){Re.call(this,a,b);this.c="camera2D"}G(af,Re);af.prototype.rotate=function(a){var a=af.i.rotate.call(this,a),b=new Id;0<a.x?b.Ce--:0>a.x&&b.Ce++;0<a.y?b.qe++:0>a.y&&b.qe--;this.dispatchEvent(b)};function bf(a,b){Re.call(this,a,b);this.c="camera3D";this.yf=45;this.If=new Float32Array(cf(this.yf,a/b).Ea())}G(bf,Re);function cf(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new gd([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
bf.prototype.rotate=function(a){var a=bf.i.rotate.call(this,a),b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=hd(4),d=new P(parseFloat(this.m.T(0,0)),parseFloat(this.m.T(0,1)),parseFloat(this.m.T(0,2))),b=c.rotate(b,new P(parseFloat(this.m.T(1,0)),parseFloat(this.m.T(1,1)),parseFloat(this.m.T(1,2)))),a=c.rotate(a,d);this.m=new gd(this.m.multiply(a.multiply(b)));this.Nb=new Float32Array(this.m.Ea())};
bf.prototype.Yd=function(a,b){bf.i.Yd.call(this,a,b);var c=hd(4),d=new P(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.J.f();e.Yc(d)&&(e.b+=1.0E-6);var f=Tc(e,d),e=Tc(d,f),f=f.normalize(),e=e.normalize();c.k(0,0,f.x);c.k(0,1,f.y);c.k(0,2,f.b);c.k(0,3,0);c.k(1,0,e.x);c.k(1,1,e.y);c.k(1,2,e.b);c.k(1,3,0);c.k(2,0,d.x);c.k(2,1,d.y);c.k(2,2,d.b);c.k(2,3,0);c.k(3,0,0);c.k(3,1,0);c.k(3,2,0);c.k(3,3,1);d=a.f();return c.translate(d.W())};E("X.camera3D",bf);function df(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}df.prototype.f=function(){return new df(this.top,this.right,this.bottom,this.left)};df.prototype.contains=function(a){return!this||!a?r:a instanceof df?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function ef(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}ef.prototype.f=function(){return new ef(this.left,this.top,this.width,this.height)};ef.prototype.ig=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,n}return r};
ef.prototype.contains=function(a){return a instanceof ef?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};ef.prototype.ua=function(){return new Yc(this.width,this.height)};function ff(a,b){var c=ge(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,q))?c[b]||c.getPropertyValue(b):""}function gf(a,b){return a.currentStyle?a.currentStyle[b]:q}function hf(a,b){return ff(a,b)||gf(a,b)||a.style&&a.style[b]}function jf(a){a=a?9==a.nodeType?a:ge(a):document;return K&&!lb(9)&&!se(ee(a))?a.body:a.documentElement}
function kf(a){var b=a.getBoundingClientRect();K&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function lf(a){if(K&&!lb(8))return a.offsetParent;for(var b=ge(a),c=hf(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=hf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return q}
function mf(a){for(var b=new df(0,Infinity,Infinity,0),c=ee(a),d=c.P.body,e=c.P.documentElement,f=!Ua&&"CSS1Compat"==c.P.compatMode?c.P.documentElement:c.P.body;a=lf(a);)if((!K||0!=a.clientWidth)&&(!Ua||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=hf(a,"overflow")){var g=nf(a),h;h=a;if(Ta&&!jb("1.9")){var l=parseFloat(ff(h,"borderLeftWidth"));if(of(h))var k=h.offsetWidth-h.clientWidth-l-parseFloat(ff(h,"borderRightWidth")),l=l+k;h=new Uc(l,parseFloat(ff(h,"borderTopWidth")))}else h=new Uc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.P.parentWindow||c.P.defaultView||window;e=c.document;Ua&&!jb("500")&&!Va?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Yc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Yc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:q}
function nf(a){var b,c=ge(a),d=hf(a,"position"),e=Ta&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Uc(0,0),g=jf(c);if(a==g)return f;if(a.getBoundingClientRect)b=kf(a),a=te(ee(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Ua&&"fixed"==hf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Sa||Ua&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=lf(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Sa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function pf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function qf(a){if("none"!=hf(a,"display"))return rf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=rf(a);b.display=c;b.position=e;b.visibility=d;return a}function rf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Ua&&!b&&!c;return(!ga(b)||d)&&a.getBoundingClientRect?(a=kf(a),new Yc(a.right-a.left,a.bottom-a.top)):new Yc(b,c)}function sf(a,b){a.style.display=b?"":"none"}function of(a){return"rtl"==hf(a,"direction")}
function tf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var uf={thin:2,medium:4,thick:6};function vf(a,b){if("none"==gf(a,b+"Style"))return 0;var c=gf(a,b+"Width");return c in uf?uf[c]:tf(a,c)};function wf(a){this.Pa=a;this.v=[]}G(wf,Ub);var xf=[];function yf(a,b,c,d,e){B(c)||(xf[0]=c,c=xf);for(var f=0;f<c.length;f++)a.v.push(L(b,c[f],d||a,e||r,a.Pa||a))}wf.prototype.ae=function(){vb(this.v,tc);this.v.length=0};wf.prototype.O=function(){wf.i.O.call(this);this.ae()};wf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function zf(){}(function(a){a.Zf=function(){return a.Gh||(a.Gh=new a)}})(zf);zf.prototype.bf=0;zf.Zf();function Af(a){this.Wa=a||ee()}G(Af,Cc);t=Af.prototype;t.Eh=zf.Zf();t.fg=q;t.ec=r;t.q=q;t.vc=q;t.Ld=q;t.Wc=q;t.bj=r;t.j=s("q");t.kf=function(a){this.vc&&this.vc!=a&&i(Error("Method not supported"));Af.i.kf.call(this,a)};t.Pd=s("Wa");t.qc=function(){this.q=this.Wa.createElement("div")};t.gc=function(a){this.Gb(a)};t.Gb=function(a,b){this.ec&&i(Error("Component already rendered"));this.q||this.qc();a?a.insertBefore(this.q,b||q):this.Wa.P.body.appendChild(this.q);(!this.vc||this.vc.ec)&&this.Od()};
t.Od=function(){this.ec=n;Bf(this,function(a){!a.ec&&a.j()&&a.Od()})};t.$c=function(){Bf(this,function(a){a.ec&&a.$c()});this.Td&&this.Td.ae();this.ec=r};t.O=function(){Af.i.O.call(this);this.ec&&this.$c();this.Td&&(this.Td.Na(),delete this.Td);Bf(this,function(a){a.Na()});!this.bj&&this.q&&pe(this.q);this.vc=this.q=this.Wc=this.Ld=q};function Bf(a,b){a.Ld&&vb(a.Ld,b,m)}
t.removeChild=function(a,b){if(a){var c=ia(a)?a:a.fg||(a.fg=":"+(a.Eh.bf++).toString(36)),a=this.Wc&&c?(c in this.Wc?this.Wc[c]:m)||q:q;if(c&&a){var d=this.Wc;c in d&&delete d[c];zb(this.Ld,a);b&&(a.$c(),a.q&&pe(a.q));c=a;c==q&&i(Error("Unable to set parent component"));c.vc=q;Af.i.kf.call(c,q)}}a||i(Error("Child is not in parent component"));return a};function Cf(){}G(Cf,Cc);t=Cf.prototype;t.tf=0;t.ed=0;t.Xe=100;t.Xf=0;t.pf=1;t.Nh=r;t.Rh=r;t.de=function(a){a=Df(this,a);this.tf!=a&&(this.tf=a+this.Xf>this.Xe?this.Xe-this.Xf:a<this.ed?this.ed:a,!this.Nh&&!this.Rh&&this.dispatchEvent("change"))};t.Sd=function(){return Df(this,this.tf)};t.Rd=function(){return Df(this,this.ed)};t.Qd=function(){return Df(this,this.Xe)};function Df(a,b){return a.pf==q?b:a.ed+Math.round((b-a.ed)/a.pf)*a.pf};function Ef(a){this.Wa=a||ee();this.xc=new Cf;L(this.xc,"change",this.Bh,r,this)}G(Ef,Af);var Ff={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};t=Ef.prototype;t.qc=function(){this.Sa=this.Pd().qc("div","progress-bar-thumb");var a=Ff[this.xg];this.q=this.Pd().qc("div",a,this.Sa);Gf(this);this.j().setAttribute("aria-valuemin",this.Rd());this.j().setAttribute("aria-valuemax",this.Qd())};
t.Od=function(){Ef.i.Od.call(this);K&&7>Za&&L(this.j(),"resize",this.fe,r,this);this.fe();var a=this.j();a.setAttribute("role","progressbar");a.Uj="progressbar";this.j().setAttribute("aria-live","polite")};t.$c=function(){Ef.i.$c.call(this);Hf(this)};function Hf(a){K&&7>Za&&sc(a.j(),"resize",a.fe,r,a)}t.Sd=function(){return this.xc.Sd()};t.de=function(a){this.xc.de(a);this.j()&&Gf(this)};function Gf(a){var b=a.Sd();a.j().setAttribute("aria-valuenow",b)}t.Rd=function(){return this.xc.Rd()};t.Qd=function(){return this.xc.Qd()};
t.xg="horizontal";t.Bh=function(){this.fe();this.dispatchEvent("change")};t.fe=function(){if(this.Sa){var a=this.Rd(),b=this.Qd(),a=(this.Sd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.xg?K&&7>Za?(this.Sa.style.top=0,this.Sa.style.height="100%",b=this.Sa.offsetHeight,a=Math.round(a*b),this.Sa.style.top=b-a+"px",this.Sa.style.height=a+"px"):(this.Sa.style.top=100-b+"%",this.Sa.style.height=b+"%"):this.Sa.style.width=b+"%"}};t.O=function(){Hf(this);Ef.i.O.call(this);this.Sa=q;this.xc.Na()};function If(a,b){y(a)||i(Error("No valid parent element."));y(b)||i(Error("Invalid initial value."));Ef.call(this);this.c="progressbar";this.la=a;this.Hf="";this.td=this.fb=q;this.Kb=[];this.Kb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.de(b);this.Te()}G(If,Ef);
If.prototype.Te=function(){if("static"==this.la.style.position||""==this.la.style.position)this.Hf=this.la.style.position,this.la.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ke("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Kb[0]),d=document.createTextNode(this.Kb[1]),e=document.createTextNode(this.Kb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.fb=b;this.gc(this.la);a=this.j();a.style.position="absolute";
a.style.top=(this.la.clientHeight-5)/2+"px";a.style.left=(this.la.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Jf(a){var b=a.j().style.top,c=a.j().style.left;pe(a.j());var d=new If(a.la,100),e=d.j();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=m?e.firstElementChild:qe(e.firstChild)).classList.add("progress-bar-thumb-done");a.td=d}
If.prototype.Vd=function(){this.fb&&pe(this.fb);this.j()&&pe(this.j());this.td&&pe(this.td.j());this.td=this.fb=q;this.la.style.position=this.Hf};var Kf=ca.window;function Lf(a,b,c){ja(a)?c&&(a=qa(a,c)):a&&"function"==typeof a.handleEvent?a=qa(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Kf.setTimeout(a,b||0)};function Mf(){M.call(this);this.c="renderer";this.s=window.document.body;this.M=this.s.clientWidth;this.H=this.s.clientHeight;this.Ob=this.r=this.ia=q;this.cb=new Ze(ud);this.Va=[];this.C=q;this.ve=this.wd=this.xd=r;this.a=this.ma=q;this.K={PROGRESSBAR_ENABLED:n};this.vf=-1;window.console.log("XTK release 9 -- 2012-10-04 10:10:41 -- http://www.goXTK.com -- @goXTK")}G(Mf,M);t=Mf.prototype;t.fi=function(a){this.ma&&this.ma.de(100*a.Mf)};t.Wh=function(a){y(a)&&a instanceof td&&a.Z&&this.$a(a.Z)};
t.ef=function(a){(!y(a)||!(a instanceof Od))&&i(Error("Invalid hover event."))};t.gi=function(){var a=he(this.s);this.M=a.clientWidth;this.H=a.clientHeight;a=he(this.ia);a.width=this.M;a.height=this.H;this instanceof Nf&&(this.a.viewport(0,0,this.M,this.H),this.r.If=new Float32Array(cf(this.r.yf,this.ia.width/this.ia.height).Ea()));this.zc()};t.ff=function(a){(!y(a)||!(a instanceof Nd))&&i(Error("Invalid scroll event."))};Mf.prototype.__defineGetter__("config",s("K"));
Mf.prototype.__defineGetter__("interactor",s("Ob"));Mf.prototype.__defineGetter__("camera",s("r"));Mf.prototype.__defineGetter__("loadingCompleted",s("wd"));Mf.prototype.__defineGetter__("container",s("s"));Mf.prototype.__defineSetter__("container",function(a){y(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;ia(b)&&(b=he(a));ka(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.s=b});t=Mf.prototype;t.zc=function(){this.r.reset()};
function Of(a){a.K.PROGRESSBAR_ENABLED&&a.ma&&!a.wf&&(Jf(a.ma),a.wf=Lf(function(){this.wf=q;this.ma&&(this.ma.Vd(),this.ma=q);this.gc()}.bind(a),700))}
t.ha=function(a){var b=ke("canvas");this.s.appendChild(b);this.M=this.s.clientWidth;this.H=this.s.clientHeight;b.width=this.M;b.height=this.H;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.s.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.C=new Ne;L(this.C,Fd,this.fi.bind(this));this.ia=b;this.a=c;b=new Ye(this.ia);"2d"==a&&(b=new we(this.ia));b.ha();L(b,Dd,this.zc.bind(this));L(b,Gd,this.ef.bind(this));L(b,Cd,this.ff.bind(this));this.Ob=b;b=new bf(this.M,this.H);"2d"==a&&(b=new af(this.M,this.H));a=b;c=this.Ob;(!y(c)||!(c instanceof ue))&&i(Error("Could not observe the interactor."));L(c,Ad,a.hi.bind(a));L(c,zd,a.ei.bind(a));L(c,Bd,a.ni.bind(a));this.r=b;L(window,"resize",this.gi,r,this)};
t.add=function(a){(a instanceof Xe||a instanceof Ve||a instanceof Te)&&a.o();this.Va.push(a);this.$a(a)};t.$a=function(a){(!this.ia||!this.a)&&i(Error("The renderer was not initialized properly."));y(a)||(window.console.log(a),i(Error("Illegal object.")));wc(a)||L(a,xc,this.Wh.bind(this))};t.get=function(a){y(a)||i(Error("Invalid object id."));for(var b=this.cb.u,c=b.length,d=0,d=0;d<c;d++)if(b[d].pa==a)return b[d];return q};
t.gc=function(){(!this.ia||!this.a)&&i(Error("The renderer was not initialized properly."));y(this.Kf)||(this.C.mc.Ie(r)?(this.K.PROGRESSBAR_ENABLED&&!this.ma&&(this.ma=new If(this.s,3)),this.ve=this.wd=r,this.Kf=Lf(function(){this.Kf=q;this.gc()}.bind(this),100)):(!this.wd&&!this.ve&&(this.ve=n,eval("this.onShowtime()"),this.wd=n),this.ma?Of(this):(this.vf=window.kd(this.gc.bind(this),this.ia),eval("this.onRender()"),this.Gb(r,n))))};t.wg=aa();t.ug=aa();t.Gb=aa();
t.Nd=function(){window.Kd(this.vf);this.C&&(delete this.C,this.C=q);this.ma&&(this.ma.Vd(),delete this.ma,this.ma=q);this.cb.clear();delete this.cb;this.Va.length=0;delete this.Va;delete this.C;this.C=q;delete this.r;this.r=q;delete this.Ob;this.Ob=q;delete this.a;this.a=q;pe(this.ia);delete this.ia;this.ia=q};function Pf(){M.call(this);this.c="shaders";this.Ed="";this.Ed="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform int scalarsInterpolation;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        if (scalarsInterpolation == 1) {\n            vec3 zeroMaxColor;\n            vec3 zeroMinColor;\n            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n        } else {\n            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n          }\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.ud="";this.ud="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
G(Pf,M);
var Qf={Ej:"vertexPosition",Dj:"vertexNormal",Cj:"vertexColor",Gj:"vertexTexturePos",Fj:"vertexScalar"},Rf={Hj:"view",lj:"perspective",dj:"center",kj:"objectTransform",yj:"useObjectColor",ij:"objectColor",Aj:"useScalars",uj:"scalarsReplaceMode",rj:"scalarsMin",oj:"scalarsMax",sj:"scalarsMinColor",pj:"scalarsMaxColor",tj:"scalarsMinThreshold",qj:"scalarsMaxThreshold",nj:"scalarsInterpolation",mj:"pointSize",jj:"objectOpacity",hj:"normal",zj:"usePicking",Bj:"useTexture",xj:"useLabelMapTexture",fj:"labelmapOpacity",
vj:"textureSampler",wj:"textureSampler2",Ij:"volumeLowerThreshold",Oj:"volumeUpperThreshold",Lj:"volumeScalarMin",Jj:"volumeScalarMax",Mj:"volumeScalarMinColor",Kj:"volumeScalarMaxColor",Qj:"volumeWindowLow",Pj:"volumeWindowHigh",Nj:"volumeTexture"};
function Sf(a){var b=Object.keys(Rf);Object.keys(Qf).every(function(a){a=Qf[a];return-1!=this.Ed.search(a)||-1!=this.ud.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Rf[a];return-1!=this.Ed.search(a)||-1!=this.ud.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Tf(a,b,c){y(a)||i(Error("Invalid GL Buffer."));y(b)||i(Error("Invalid number of items."));y(c)||i(Error("Invalid item size."));M.call(this);this.c="buffer";this.ja=a;this.qb=b;this.rb=c}G(Tf,M);function Uf(a,b,c,d,e,f,g,h){var l,k=c.offsetParent;if(k){var j="HTML"==k.tagName||"BODY"==k.tagName;if(!j||"static"!=hf(k,"position"))l=nf(k),j||(l=Vc(l,new Uc(k.scrollLeft,k.scrollTop)))}k=nf(a);j=qf(a);k=new ef(k.x,k.y,j.width,j.height);(j=mf(a))&&k.ig(new ef(j.left,j.top,j.right-j.left,j.bottom-j.top));var j=ee(a),o=ee(c);if(j.P!=o.P){var v=j.P.body,o=o.P.parentWindow||o.P.defaultView,p=new Uc(0,0),w=ge(v)?ge(v).parentWindow||ge(v).defaultView:window,u=v;do{var z;if(w==o)z=nf(u);else{var C=u;
z=new Uc;if(1==C.nodeType)if(C.getBoundingClientRect)C=kf(C),z.x=C.left,z.y=C.top;else{var x=te(ee(C)),C=nf(C);z.x=C.x-x.x;z.y=C.y-x.y}else{var x=ja(C.yh),A=C;C.targetTouches?A=C.targetTouches[0]:x&&C.Da.targetTouches&&(A=C.Da.targetTouches[0]);z.x=A.clientX;z.y=A.clientY}}p.x+=z.x;p.y+=z.y}while(w&&w!=o&&(u=w.frameElement)&&(w=w.parent));v=Vc(p,nf(v));K&&!se(j)&&(v=Vc(v,te(j)));k.left+=v.x;k.top+=v.y}a=(b&4&&of(a)?b^2:b)&-5;b=new Uc(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);l&&(b=Vc(b,
l));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var F;if(g&&(F=mf(c))&&l)F.top-=l.y,F.right-=l.x,F.bottom-=l.y,F.left-=l.x;return Vf(b,c,d,f,F,g,h)}
function Vf(a,b,c,d,e,f,g){var a=a.f(),h=0,l=(c&4&&of(b)?c^2:c)&-5,c=qf(b),g=g?g.f():c.f();if(d||0!=l)l&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),l&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Ta&&(La||Ya)&&jb("1.9");f instanceof Uc?(a=f.x,f=f.y):(a=f,f=m);b.style.left=pf(a,e);b.style.top=pf(f,e);Zc(c,g)||(a=se(ee(ge(b))),
K&&(!a||!jb("8"))?(c=b.style,a?(K?(a=tf(b,gf(b,"paddingLeft")),e=tf(b,gf(b,"paddingRight")),f=tf(b,gf(b,"paddingTop")),d=tf(b,gf(b,"paddingBottom")),a=new df(f,e,d,a)):(a=ff(b,"paddingLeft"),e=ff(b,"paddingRight"),f=ff(b,"paddingTop"),d=ff(b,"paddingBottom"),a=new df(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),K?(e=vf(b,"borderLeft"),f=vf(b,"borderRight"),d=vf(b,"borderTop"),b=vf(b,"borderBottom"),b=new df(d,f,b,e)):(e=ff(b,"borderLeftWidth"),f=ff(b,"borderRightWidth"),d=ff(b,"borderTopWidth"),
b=ff(b,"borderBottomWidth"),b=new df(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Ta?b.MozBoxSizing="border-box":Ua?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Wf(){}Wf.prototype.Ra=aa();function Xf(a,b){this.element=a;this.Rf=b}G(Xf,Wf);Xf.prototype.Ra=function(a,b,c){Uf(this.element,this.Rf,a,b,m,c)};function Yf(a,b){this.Pa=new wf(this);this.jf(a||q);b&&(this.Bc=b)}G(Yf,Cc);t=Yf.prototype;t.q=q;t.dh=n;t.Nf=q;t.oa=r;t.Ki=r;t.We=-1;t.Dh=r;t.rh=n;t.Bc="toggle_display";t.j=s("q");t.jf=function(a){this.oa&&i(Error("Can not change this state of the popup while showing."));this.q=a};
function Zf(a,b){a.md&&a.md.stop();a.cd&&a.cd.stop();if(b){if(!a.oa&&a.cf()){a.q||i(Error("Caller must call setElement before trying to show the popup"));a.Ra();var c=ge(a.q);a.Dh&&yf(a.Pa,c,"keydown",a.Uh,n);if(a.dh)if(yf(a.Pa,c,"mousedown",a.sg,n),K){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}yf(a.Pa,c,"mousedown",a.sg,n);yf(a.Pa,c,"deactivate",a.rg)}else yf(a.Pa,c,"blur",a.rg);"toggle_display"==
a.Bc?(a.q.style.visibility="visible",sf(a.q,n)):"move_offscreen"==a.Bc&&a.Ra();a.oa=n;a.md?(rc(a.md,"end",a.vg,r,a),a.md.play()):a.vg()}}else $f(a)}t.Ra=ea;function $f(a,b){if(!a.oa||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.Pa&&a.Pa.ae();a.cd?(rc(a.cd,"end",ra(a.Qf,b),r,a),a.cd.play()):a.Qf(b);return n}t.Qf=function(a){"toggle_display"==this.Bc?this.Ki?Lf(this.eg,0,this):this.eg():"move_offscreen"==this.Bc&&(this.q.style.left="-200px",this.q.style.top="-200px");this.oa=r;this.df(a)};
t.eg=function(){this.q.style.visibility="hidden";sf(this.q,r)};t.cf=function(){return this.dispatchEvent("beforeshow")};t.vg=function(){this.We=ta();this.dispatchEvent("show")};t.df=function(a){ta();this.dispatchEvent({type:"hide",target:a})};t.sg=function(a){a=a.target;!re(this.q,a)&&(!this.Nf||re(this.Nf,a))&&!(150>ta()-this.We)&&$f(this,a)};t.Uh=function(a){27==a.keyCode&&$f(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
t.rg=function(a){if(this.rh){var b=ge(this.q);if(K||Sa){if(a=b.activeElement,!a||re(this.q,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>ta()-this.We||$f(this)}};t.O=function(){Yf.i.O.call(this);this.Pa.Na();Wb(this.md);Wb(this.cd);delete this.q;delete this.Pa};function ag(a,b){this.Je=a instanceof Uc?a:new Uc(a,b)}G(ag,Wf);ag.prototype.Ra=function(a,b,c,d){Uf(jf(a),0,a,b,this.Je,c,q,d)};function bg(a,b){this.pi=4;this.$d=b||m;Yf.call(this,a)}G(bg,Yf);bg.prototype.Ra=function(){if(this.$d){var a=!this.oa&&"move_offscreen"!=this.Bc,b=this.j();a&&(b.style.visibility="hidden",sf(b,n));this.$d.Ra(b,this.pi,this.Sj);a&&sf(b,r)}};function cg(a,b,c){this.Wa=c||(a?ee(he(a)):ee());bg.call(this,this.Wa.qc("div",{style:"position:absolute;display:none;"}));this.Le=new Uc(1,1);this.cc=new Rb;a&&dg(this,a);if(b!=q)if(a=this.j(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ge(a).createTextNode(b))}}G(cg,bg);var eg=[];t=cg.prototype;t.na=q;t.className="goog-tooltip";
t.Dg=500;t.Ch=0;t.Pd=s("Wa");function dg(a,b){b=he(b);a.cc.add(b);L(b,"mouseover",a.bg,r,a);L(b,"mouseout",a.Ud,r,a);L(b,"mousemove",a.ag,r,a);L(b,"focus",a.$f,r,a);L(b,"blur",a.Ud,r,a)}t.detach=function(a){if(a)a=he(a),fg(this,a),this.cc.remove(a);else{for(var b=this.cc.Oa(),c=0;a=b[c];c++)fg(this,a);this.cc.clear()}};function fg(a,b){sc(b,"mouseover",a.bg,r,a);sc(b,"mouseout",a.Ud,r,a);sc(b,"mousemove",a.ag,r,a);sc(b,"focus",a.$f,r,a);sc(b,"blur",a.Ud,r,a)}
t.jf=function(a){var b=this.j();b&&pe(b);cg.i.jf.call(this,a);a&&(b=this.Wa.P.body,b.insertBefore(a,b.lastChild))};t.cf=function(){if(!Yf.prototype.cf.call(this))return r;if(this.anchor)for(var a,b=0;a=eg[b];b++)re(a.j(),this.anchor)||Zf(a,r);0<=ub(eg,this)||eg.push(this);a=this.j();a.className=this.className;gg(this);L(a,"mouseover",this.dg,r,this);L(a,"mouseout",this.cg,r,this);hg(this);return n};
t.df=function(){zb(eg,this);for(var a=this.j(),b,c=0;b=eg[c];c++)b.anchor&&re(a,b.anchor)&&Zf(b,r);this.zg&&ig(this.zg);sc(a,"mouseover",this.dg,r,this);sc(a,"mouseout",this.cg,r,this);this.anchor=m;if(0==(this.ib?this.oa?4:1:this.uc?3:this.oa?2:0))this.be=r;Yf.prototype.df.call(this)};t.pg=function(a,b){this.anchor==a&&this.cc.contains(this.anchor)&&(this.be||!this.Tj?(Zf(this,r),this.oa||(this.anchor=a,this.$d=b||jg(this,0)||m,this.oa&&this.Ra(),Zf(this,n))):this.anchor=m);this.ib=m};
t.Qh=function(a){this.uc=m;a==this.anchor&&(this.na==q||this.na!=this.j()&&!this.cc.contains(this.na))&&(!this.Of||!this.Of.na)&&Zf(this,r)};function kg(a,b){var c=te(a.Wa);a.Le.x=b.clientX+c.x;a.Le.y=b.clientY+c.y}t.bg=function(a){var b=lg(this,a.target);this.na=b;gg(this);b!=this.anchor&&(this.anchor=b,this.ib||(this.ib=Lf(qa(this.pg,this,b,m),this.Dg)),mg(this),kg(this,a))};function lg(a,b){try{for(;b&&!a.cc.contains(b);)b=b.parentNode;return b}catch(c){return q}}
t.ag=function(a){kg(this,a);this.be=n};t.$f=function(a){this.na=a=lg(this,a.target);this.be=n;if(this.anchor!=a){this.anchor=a;var b=jg(this,1);gg(this);this.ib||(this.ib=Lf(qa(this.pg,this,a,b),this.Dg));mg(this)}};function jg(a,b){if(0==b){var c=a.Le.f();return new ng(c)}return new og(a.na)}function mg(a){if(a.anchor)for(var b,c=0;b=eg[c];c++)re(b.j(),a.anchor)&&(b.Of=a,a.zg=b)}
t.Ud=function(a){var b=lg(this,a.target),c=lg(this,a.relatedTarget);b!=c&&(b==this.na&&(this.na=q),hg(this),this.be=r,this.oa&&(!a.relatedTarget||!re(this.j(),a.relatedTarget))?ig(this):this.anchor=m)};t.dg=function(){var a=this.j();this.na!=a&&(gg(this),this.na=a)};t.cg=function(a){var b=this.j();if(this.na==b&&(!a.relatedTarget||!re(b,a.relatedTarget)))this.na=q,ig(this)};function hg(a){a.ib&&(Kf.clearTimeout(a.ib),a.ib=m)}
function ig(a){if(2==(a.ib?a.oa?4:1:a.uc?3:a.oa?2:0))a.uc=Lf(qa(a.Qh,a,a.anchor),a.Ch)}function gg(a){a.uc&&(Kf.clearTimeout(a.uc),a.uc=m)}t.O=function(){Zf(this,r);hg(this);this.detach();this.j()&&pe(this.j());this.na=q;delete this.Wa;cg.i.O.call(this)};function ng(a,b){ag.call(this,a,b)}G(ng,ag);ng.prototype.Ra=function(a,b,c){b=jf(a);b=mf(b);c=c?new df(c.top+10,c.right,c.bottom,c.left+10):new df(10,0,0,10);Vf(this.Je,a,4,c,b,9)&496&&Vf(this.Je,a,4,c,b,5)};function og(a){Xf.call(this,a,3)}
G(og,Xf);og.prototype.Ra=function(a,b,c){var d=new Uc(10,0);Uf(this.element,this.Rf,a,b,d,c,9)&496&&Uf(this.element,2,a,1,d,c,5)};function pg(a,b,c,d){y(a)||i(Error("No valid parent element."));(!D(b)||!D(c))&&i(Error("Invalid coordinates."));(!y(d)||!(d instanceof ue))&&i(Error("Invalid interactor."));cg.call(this);this.c="caption";this.la=a;this.Gd=b;this.Hd=c;this.Ob=d;this.fb=q;this.Kb=[];this.Kb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];rc(d,Hd,this.Vd.bind(this));this.Te()}G(pg,cg);
pg.prototype.Te=function(){if("static"==this.la.style.position||""==this.la.style.position)this.la.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ke("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Kb[0]);a.appendChild(b);b.appendChild(c);this.fb=b;this.$d=new ag(this.Gd,this.Hd)||m;this.oa&&this.Ra();Zf(this,n);dg(this,this.la);this.j().classList.add("x-tooltip")};
pg.prototype.Vd=function(){Zf(this,r);this.fb&&pe(this.fb);this.j()&&pe(this.j());this.fb=q};function Nf(){Mf.call(this);this.c="renderer3D";this.Kc=this.Nc=this.Jc=this.Mc=this.Ic=this.Lc=this.we=this.xe=q;this.l=[0,0,0];this.Jf=q;this.ge=new Nb;this.Sc=new Nb;this.Vc=new Nb;this.te=new Nb;this.sd=new Nb;this.Bd=new Nb;this.Cd=new Nb;this.Dd=new Nb;this.K={PROGRESSBAR_ENABLED:n,PICKING_ENABLED:n,ORDERING_ENABLED:n,STATISTICS_ENABLED:r}}G(Nf,Mf);Nf.prototype.__defineGetter__("config",s("K"));t=Nf.prototype;t.yi=function(){this.Kc=this.Nc=this.Jc=this.Mc=this.Ic=this.Lc=q;this.l=[0,0,0]};
t.ef=function(a){Nf.i.ef.call(this,a);var b=a.Gd,a=a.Hd,c=this.get(this.Ag(b,a));if(c&&(c=c.jc))(new pg(this.s,this.s.offsetLeft+b+10,this.s.offsetTop+a+10,this.Ob)).j().innerHTML=c};
t.ha=function(){Nf.i.ha.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.M,this.H),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.K.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.M,this.H,0,this.a.RGB,this.a.UNSIGNED_BYTE,q);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.M,this.H);this.a.bindRenderbuffer(this.a.RENDERBUFFER,q);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.Jf=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}rg(this)};
function rg(a){var b=new Pf;(!y(a.ia)||!y(a.a)||!y(a.r))&&i(Error("Renderer was not initialized properly."));(!y(b)||!(b instanceof Pf))&&i(Error("Could not add shaders."));Sf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.ud);a.a.shaderSource(d,b.Ed);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.we=e;Object.keys(Qf).forEach(function(a){a=Qf[a];this.ge.set(a,this.a.getAttribLocation(this.we,a));this.a.enableVertexAttribArray(this.ge.get(a))}.bind(a));
Object.keys(Rf).forEach(function(a){a=Rf[a];this.Sc.set(a,this.a.getUniformLocation(this.we,a))}.bind(a));a.xe=b}
t.$a=function(a){Nf.i.$a.call(this,a);var b=r;this.get(a.pa)&&(b=n);var c=a.pa,d=a.g,e=a.h,f=a.U,g=a.A,h=a.p,l=a.ac,k=a.X,j=a.n,o=a.t;if(y(j)&&y(j.p)&&j.p.e)this.$a(j);else if(y(j)&&j.e&&this.$a(j),y(k)&&y(k.p)&&k.p.e)this.C.load(k,a);else if(y(g)&&y(g.p)&&g.p.e)this.C.load(g,a);else{if(y(h)&&B(h))if(y(a.hc)){if(a.hc.Wd!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.C.load(h[b],a);return}else{if(y(h)&&h.e){this.C.load(a,a);return}if(y(o)&&y(o.p)&&o.p.e){this.C.load(o,a);return}}if(0<
a.d.length){h=a.d;k=h.length;for(j=j=0;j<k;j++)this.$a(h[j])}if(d){for(h=0;this.xd;)h++,window.console.log("Possible thread lock avoided: "+h);this.xd=n;k=a instanceof xe&&a.gb instanceof ze;b&&y(g)&&g.e&&(h=this.Cd.get(c),y(h)&&this.a.isBuffer(h.ja)&&this.a.deleteBuffer(h.ja));h=q;y(g)&&(!b||g.e?(h=a.Zb,y(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),j=r,g.sa&&(j=n),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,j),j=this.a.createTexture(),
j.Fh=g.mb,this.Dd.set(g.pa,j),this.a.bindTexture(this.a.TEXTURE_2D,j),g.sa?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.Bb,g.Ab,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.sa):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,j.Fh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,q),j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Tf(j,h.length,2),g.e=r):h=this.Cd.get(c));Oe(this.C,0.1);if(k)this.xd=
r,H.Ba(this.c+".update"),Oe(this.C,0.9);else{if(!b||d.e||l.e){k=l.D;g=k.Qa(new P(d.Sb,d.Tb,d.Ub));k=k.Qa(new P(d.Pb,d.Qb,d.Rb));if(this.Lc===q||g.x<this.Lc)this.Lc=g.x;if(this.Ic===q||k.x>this.Ic)this.Ic=k.x;if(this.Mc===q||g.y<this.Mc)this.Mc=g.y;if(this.Jc===q||k.y>this.Jc)this.Jc=k.y;if(this.Nc===q||g.b<this.Nc)this.Nc=g.b;if(this.Kc===q||k.b>this.Kc)this.Kc=k.b;this.l=[(this.Lc+this.Ic)/2,(this.Mc+this.Jc)/2,(this.Nc+this.Kc)/2];l.e=r}b&&d.e&&(l=this.Vc.get(c),y(l)&&this.a.isBuffer(l.ja)&&this.a.deleteBuffer(l.ja));
l=q;!b||d.e?(l=this.a.createBuffer(),d.Ac(),this.a.bindBuffer(this.a.ARRAY_BUFFER,l),this.a.bufferData(this.a.ARRAY_BUFFER,d.L,this.a.STATIC_DRAW),l=new Tf(l,d.count,3),d.e=r):l=this.Vc.get(c);Oe(this.C,0.3);b&&e.e&&(g=this.Vc.get(c),y(g)&&this.a.isBuffer(g.ja)&&this.a.deleteBuffer(g.ja));g=q;!b||e.e?(g=this.a.createBuffer(),e.Ac(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.L,this.a.STATIC_DRAW),g=new Tf(g,e.count,3),e.e=r):g=this.te.get(c);Oe(this.C,0.3);b&&
f&&f.e&&(e=this.sd.get(c),y(e)&&this.a.isBuffer(e.ja)&&this.a.deleteBuffer(e.ja));e=q;f&&(!b||f.e?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.Ac(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.L,this.a.STATIC_DRAW),e=new Tf(e,f.count,3),f.e=r):e=this.sd.get(c));Oe(this.C,0.2);b&&o&&o.e&&(f=this.Bd.get(c),y(f)&&this.a.isBuffer(f.ja)&&this.a.deleteBuffer(f.ja));f=q;o&&(f=o.Dc,!b||o.e?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),
d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Tf(d,f.length,3),o.e=r):f=this.Bd.get(c));Oe(this.C,0.1);b||this.cb.add(a);this.Vc.set(c,l);this.te.set(c,g);this.sd.set(c,e);this.Cd.set(c,h);this.Bd.set(c,f);this.xd=a.e=r}}else a.e=r}};function sg(a,b){var c=b.g.rd,c=a.r.m.Qa(b.ac.D.Qa(new P(c[0],c[1],c[2]))),c=Rc(a.r.ra,c);return Math.round(1E3*c)/1E3}
t.Ag=function(a,b){if(this.K.PICKING_ENABLED){this.Gb(n,r);var c=new Uint8Array(4);this.a.readPixels(a,this.H-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
t.Gb=function(a,b){Nf.i.Gb.call(this,a,b);var c=this.cb.u,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Jf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.a.viewport(0,0,this.M,this.H);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.r.If,f=this.r.Nb;this.a.uniformMatrix4fv(this.Sc.get("perspective"),r,e);this.a.uniformMatrix4fv(this.Sc.get("view"),r,f);e=this.l;this.a.uniform3f(this.Sc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.Va.length;for(e=0;e<f;++e){var g=this.Va[e];if(g instanceof O){var h=new P(1,0,0),h=this.r.m.Qa(h),l=Rc(this.r.ra,h),h=new P(-1,0,0),h=this.r.m.Qa(h),k=Rc(this.r.ra,h),h=new P(0,1,0),h=this.r.m.Qa(h),j=Rc(this.r.ra,h),h=new P(0,-1,0),h=this.r.m.Qa(h),o=Rc(this.r.ra,h),h=new P(0,0,1),h=this.r.m.Qa(h),v=Rc(this.r.ra,h),h=new P(0,0,-1),h=this.r.m.Qa(h),h=Rc(this.r.ra,h),p=Math.max(l,j,v,k,o,h);p==l||p==k?ye(g,0):p==j||p==o?ye(g,1):(p==v||p==h)&&ye(g,2)}}if(this.K.ORDERING_ENABLED){l=r;f=this.Va;
g=f.length-1;do if(e=f[g],e instanceof O&&e.La){k=e.Db;l=e.Q.d;1==k?l=e.R.d:2==k&&(l=e.eb.d);k=l.length;j=l[0];j.z=sg(this,j);j.V=e.V;o=l[k-1];o.z=sg(this,o);o.V=e.V;o=Math.round(1E3*((o.z-j.z)/k))/1E3;for(v=v=1;v<k-1;v++)h=Math.round(1E3*(j.z+v*o))/1E3,l[v].z=h,l[v].V=e.V;l=n}while(g--);f=this.cb.u;g=f.length-1;do if(e=f[g],e.Ka&&!(1==e.V||e instanceof xe))e.z=sg(this,e),l=n;while(g--);l&&this.cb.sort()}if(f=!a&&y(b)&&b&&this.K.STATISTICS_ENABLED)var w=0,u=0,z=0,C=0;var e=this.ge,g=e.get("vertexPosition"),
l=e.get("vertexNormal"),k=e.get("vertexColor"),j=e.get("vertexTexturePos"),o=e.get("vertexScalar"),e=this.Sc,v=e.get("usePicking"),h=e.get("useObjectColor"),p=e.get("objectColor"),x=e.get("useScalars"),A=e.get("scalarsReplaceMode"),F=e.get("scalarsMin"),N=e.get("scalarsMax"),U=e.get("scalarsMinColor"),I=e.get("scalarsMaxColor"),J=e.get("scalarsInterpolation"),V=e.get("scalarsMinThreshold"),da=e.get("scalarsMaxThreshold"),Q=e.get("objectOpacity"),xa=e.get("labelmapOpacity"),gb=e.get("useTexture"),
Aa=e.get("useLabelMapTexture"),Dc=e.get("textureSampler"),jd=e.get("textureSampler2"),qb=e.get("volumeLowerThreshold"),ld=e.get("volumeUpperThreshold"),Kb=e.get("volumeScalarMin"),hb=e.get("volumeScalarMax"),Ib=e.get("volumeWindowLow"),Fc=e.get("volumeWindowHigh"),Ba=e.get("volumeScalarMinColor"),pb=e.get("volumeScalarMaxColor"),Ec=e.get("volumeTexture"),id=e.get("objectTransform"),qg=e.get("pointSize"),e=d;do{var S=c[d-e];if(S){var W=q;S instanceof xe&&S.gb&&(W=S.gb);if(S.Ka&&(!W||W.Ka)){var sa=
S.pa,Ra=S.Hc,Ca=this.Vc.get(sa),$a=this.te.get(sa),Xd=this.sd.get(sa),Jb=this.Bd.get(sa),ne=this.Cd.get(sa);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ca.ja);this.a.vertexAttribPointer(g,Ca.rb,this.a.FLOAT,r,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,$a.ja);this.a.vertexAttribPointer(l,$a.rb,this.a.FLOAT,r,0,0);a?this.a.uniform1i(v,n):this.a.uniform1i(v,r);Xd&&!a&&!Ra?(this.a.uniform1i(h,r),this.a.bindBuffer(this.a.ARRAY_BUFFER,Xd.ja),this.a.vertexAttribPointer(k,Xd.rb,this.a.FLOAT,r,0,0)):($a=1,Ra&&!a&&
($a=0),this.a.uniform1i(h,$a),$a=S.Jb,a&&($a=[Math.floor(sa%65025%255)/255,Math.floor(sa%65025/255)/255,Math.floor(sa/65025)/255]),this.a.uniform3f(p,parseFloat($a[0]),parseFloat($a[1]),parseFloat($a[2])),this.a.vertexAttribPointer(k,Ca.rb,this.a.FLOAT,r,0,0));Jb&&!a&&!Ra?(this.a.uniform1i(x,n),this.a.uniform1i(A,S.t.Lf),sa=S.t.wb,Ra=S.t.ub,this.a.uniform3f(U,parseFloat(sa[0]),parseFloat(sa[1]),parseFloat(sa[2])),this.a.uniform3f(I,parseFloat(Ra[0]),parseFloat(Ra[1]),parseFloat(Ra[2])),this.a.uniform1f(V,
parseFloat(S.t.ba)),this.a.uniform1f(da,parseFloat(S.t.ca)),this.a.uniform1f(F,parseFloat(S.t.Ja)),this.a.uniform1f(N,parseFloat(S.t.Ca)),this.a.uniform1i(J,parseInt(S.t.je,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Jb.ja),this.a.vertexAttribPointer(o,Jb.rb,this.a.FLOAT,r,0,0)):(this.a.uniform1i(x,r),this.a.vertexAttribPointer(o,Ca.rb,this.a.FLOAT,r,0,0));this.a.uniform1f(Q,parseFloat(S.V));S.A&&ne&&!a?(this.a.uniform1i(gb,n),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,
this.Dd.get(S.A.pa)),this.a.uniform1i(Dc,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,ne.ja),this.a.vertexAttribPointer(j,ne.rb,this.a.FLOAT,r,0,0),this.a.uniform1i(Ec,r)):(this.a.uniform1i(gb,r),this.a.vertexAttribPointer(j,Ca.rb,this.a.FLOAT,r,0,0));W&&(this.a.uniform1i(Ec,n),this.a.uniform1f(qb,W.ba),this.a.uniform1f(ld,W.ca),this.a.uniform1f(Kb,W.Ja),this.a.uniform1f(hb,W.Ca),sa=W.wb,Ra=W.ub,this.a.uniform3f(Ba,parseFloat(sa[0]),parseFloat(sa[1]),parseFloat(sa[2])),this.a.uniform3f(pb,parseFloat(Ra[0]),
parseFloat(Ra[1]),parseFloat(Ra[2])),this.a.uniform1f(Ib,W.ea),this.a.uniform1f(Fc,W.da),Jb=W.n,this.a.uniform1i(Aa,r),W.La?this.a.uniform1f(Q,parseFloat(W.V)):Jb&&Jb.Ka&&(W=S.n.pa,this.a.uniform1i(Aa,n),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Dd.get(W)),this.a.uniform1i(jd,1),this.a.uniform1f(xa,Jb.V)));this.a.uniformMatrix4fv(id,r,S.ac.Af);W=1;"POINTS"==S.ka&&(W=S.Oc);this.a.uniform1f(qg,W);W=-1;S.ka==qd?(W=this.a.TRIANGLES,f&&(u+=Ca.qb/3)):"LINES"==S.ka?
(this.a.lineWidth(S.nc),W=this.a.LINES,f&&(z+=Ca.qb/2)):"POINTS"==S.ka?(W=this.a.POINTS,f&&(C+=Ca.qb)):"TRIANGLE_STRIPS"==S.ka?(W=this.a.TRIANGLE_STRIP,f&&(u+=Ca.qb/3)):"POLYGONS"==S.ka&&(W=0==Ca.qb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(u+=Ca.qb/3));f&&(w+=Ca.qb);this.a.drawArrays(W,0,Ca.qb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+w+" | ")+("Triangles: "+Math.round(u)+" | "),c=c+("Lines: "+z+" | ")+("Points: "+C+" | ")+("Textures: "+this.Dd.Xa()),window.console.log(c))}};
t.Nd=function(){this.xe=q;delete this.xe;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);Nf.i.Nd.call(this)};E("X.renderer3D",Nf);E("X.renderer3D.prototype.init",Nf.prototype.ha);E("X.renderer3D.prototype.add",Nf.prototype.add);E("X.renderer3D.prototype.onShowtime",Nf.prototype.wg);E("X.renderer3D.prototype.onRender",Nf.prototype.ug);E("X.renderer3D.prototype.get",Nf.prototype.get);E("X.renderer3D.prototype.render",Nf.prototype.gc);E("X.renderer3D.prototype.destroy",Nf.prototype.Nd);
E("X.renderer3D.prototype.resetBoundingBox",Nf.prototype.yi);E("X.renderer3D.prototype.resetViewAndRender",Nf.prototype.zc);E("X.renderer3D.prototype.pick",Nf.prototype.Ag);function $(){Mf.call(this);this.c="renderer2D";this.Bf=this.ke=this.zf=this.ie=this.xb=q;this.Ad=this.Wb=this.Xb=this.ye=this.ze=0}G($,Mf);$.prototype.ii=aa();$.prototype.li=aa();$.prototype.ff=function(a){$.i.ff.call(this,a);var b=this.Va[0];if(b){var c=this.xb;b["index"+c]=a.J?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
$.prototype.mi=function(a){var b=this.Va[0];if(b){var c=b.da-b.ea,d=c/2,e=parseInt(c+c/15*-a.Ce,10),a=parseInt(d+d/15*a.qe,10);c==e&&e++;d==a&&a++;b.ea-=parseInt(d-a,10);b.ea-=parseInt(c-e,10);b.ea=Math.max(b.ea,b.Ja);b.da-=parseInt(d-a,10);b.da+=parseInt(c-e,10);b.da=Math.min(b.da,b.Ca);eval("this.onWindowLevel();")}};$.prototype.__defineGetter__("orientation",s("xb"));
$.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.xb=a});t=$.prototype;t.ha=function(){this.xb||i(Error("No 2D orientation set."));$.i.ha.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ia.width,this.ia.height);this.ie=ke("canvas");this.ke=ke("canvas");L(this.r,Ed,this.mi.bind(this))};t.rotate=function(){this.Ad++};t.zi=function(){this.Ad--};
t.zc=function(){$.i.zc.call(this);tg(this);var a=this.Va[0];a&&(a.da=a.Ca,a.ea=a.Ja)};
t.$a=function(a){$.i.$a.call(this,a);var b=r;this.get(a.pa)&&(b=n);if(a instanceof O){var c=a.p,d=a.n,e=a.X;if(y(d)&&y(d.p)&&d.p.e)this.$a(d);else if(y(e)&&y(e.p)&&e.p.e)this.C.load(e,a);else{if(y(c)&&B(c))if(y(a.hc)){if(a.hc.Wd!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.C.load(c[b],a);return}else if(y(c)&&c.e){this.C.load(a,a);return}var d=c=0,e=a.Y,f=a.I;"X"==this.xb?(this.Yb=a.Q.d,c=e[1],d=e[2],this.Xb=f[1],this.Wb=f[2]):"Y"==this.xb?(this.Yb=a.R.d,c=e[0],d=e[2],this.Xb=
f[0],this.Wb=f[2]):"Z"==this.xb&&(this.Yb=a.eb.d,c=e[0],d=e[1],this.Xb=f[0],this.Wb=f[1]);this.ze=c;this.ye=d;e=this.ie;e.width=c;e.height=d;f=this.ke;f.width=c;f.height=d;this.zf=e.getContext("2d");this.Bf=f.getContext("2d");b||(this.cb.add(a),tg(this))}}};function tg(a){a.r.m.k(2,3,Math.min(a.M/(a.ze*a.Xb),a.H/(a.ye*a.Wb)))}
t.Gb=function(a,b){$.i.Gb.call(this,a,b);if(0!=this.cb.u.length){var c=this.M,d=this.H,e=this.r.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.T(0,3),g=-1*e.T(1,3),h=Math.max(e.T(2,3),0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.Va[0],l=this.Yb[parseInt(e["index"+this.xb],10)],k=l.A.sa,l=l.n,j=q;l&&(j=l.sa);var o=this.ze,v=this.ye,p=this.zf,w=this.Bf,u=p.getImageData(0,0,o,v),z=w.getImageData(0,0,o,v),C=u.data,x=z.data,A=C.length,F=e.Ca,N=e.ba,U=e.ca,I=0;do{var J=[0,
0,0,0],V=[0,0,0,0],da=k[I]/255*F,Q=k[I],xa=e.ea/F,Q=(Q/255-xa)/(e.da/F-xa),Q=255*Q;da>=N&&da<=U&&(J=new P(e.wb[0],e.wb[1],e.wb[2]),J=(new P(e.ub[0],e.ub[1],e.ub[2])).scale(Q).add(J.scale(255-Q)),J=[Math.floor(J.x),Math.floor(J.y),Math.floor(J.b),255],l&&(V=[j[I],j[I+1],j[I+2],j[I+3]]));Q=A-1-I;C[Q-3]=J[0];C[Q-2]=J[1];C[Q-1]=J[2];C[Q]=J[3];x[Q-3]=V[0];x[Q-2]=V[1];x[Q-1]=V[2];x[Q]=V[3];I+=4}while(I<A);p.putImageData(u,0,0);w.putImageData(z,0,0);this.a.globalAlpha=1;this.a.translate(c/2/h,d/2/h);this.a.rotate(0.5*
Math.PI*this.Ad);switch(this.Ad%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-o*this.Xb/2+f;g=-v*this.Wb/2+g;this.a.drawImage(this.ie,f,g,o*this.Xb,v*this.Wb);l&&e.n.Ka&&(this.a.globalAlpha=e.n.V,this.a.drawImage(this.ke,f,g,o*this.Xb,v*this.Wb))}};E("X.renderer2D",$);E("X.renderer2D.prototype.init",$.prototype.ha);E("X.renderer2D.prototype.add",$.prototype.add);E("X.renderer2D.prototype.onShowtime",$.prototype.wg);E("X.renderer2D.prototype.onRender",$.prototype.ug);
E("X.renderer2D.prototype.onScroll",$.prototype.ii);E("X.renderer2D.prototype.onWindowLevel",$.prototype.li);E("X.renderer2D.prototype.get",$.prototype.get);E("X.renderer2D.prototype.rotate",$.prototype.rotate);E("X.renderer2D.prototype.rotateCounter",$.prototype.zi);E("X.renderer2D.prototype.resetViewAndRender",$.prototype.zc);E("X.renderer2D.prototype.render",$.prototype.gc);E("X.renderer2D.prototype.destroy",$.prototype.Nd);function ug(){T.call(this);this.c="fibers";va(this,new Oc)}G(ug,T);E("X.fibers",ug);function vg(){T.call(this);this.c="mesh";va(this,new Oc)}G(vg,T);E("X.mesh",vg);
